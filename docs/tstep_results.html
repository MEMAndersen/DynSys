Version: 1.7.4
<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>tstep_results API documentation</title>
    <meta name="description" content="Classes and methods used to flexibly handle results from 
time-stepping analysis methods as implemen..." />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
  
  <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
  
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">
    <li class="set"><h3><a href="#header-variables">Module variables</a></h3>
      
  <ul>
    <li class="mono"><a href="#tstep_results.currentVersion">currentVersion</a></li>
  </ul>

    </li>


    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#tstep_results.SysPlot">SysPlot</a></span>
        
          
  <ul>
    <li class="mono"><a href="#tstep_results.SysPlot.__init__">__init__</a></li>
    <li class="mono"><a href="#tstep_results.SysPlot.update">update</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#tstep_results.TStep_Results">TStep_Results</a></span>
        
          
  <ul>
    <li class="mono"><a href="#tstep_results.TStep_Results.__init__">__init__</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.AnimateResults">AnimateResults</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.CalcExternalWorkDone">CalcExternalWorkDone</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.CalcExternalWorkPower">CalcExternalWorkPower</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.CalcKineticEnergy">CalcKineticEnergy</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.CalcPotentialEnergy">CalcPotentialEnergy</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.ClearResults">ClearResults</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.PlotDeformed">PlotDeformed</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.PlotEnergyResults">PlotEnergyResults</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.PlotResponsePSDs">PlotResponsePSDs</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.PlotResponseResults">PlotResponseResults</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.PlotResults">PlotResults</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.PlotStateResults">PlotStateResults</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.PrintResponseStats">PrintResponseStats</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.RecordResults">RecordResults</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.WriteResults2File">WriteResults2File</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.calc_dof_stats">calc_dof_stats</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.calc_response_stats">calc_response_stats</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.calc_responses">calc_responses</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.get_dof_stats_df">get_dof_stats_df</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.get_response_stats_df">get_response_stats_df</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.get_results">get_results</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.plot_response_results">plot_response_results</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.plot_results">plot_results</a></li>
    <li class="mono"><a href="#tstep_results.TStep_Results.plot_state_results">plot_state_results</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#tstep_results.TimeSeries_Results">TimeSeries_Results</a></span>
        
          
  <ul>
    <li class="mono"><a href="#tstep_results.TimeSeries_Results.__init__">__init__</a></li>
    <li class="mono"><a href="#tstep_results.TimeSeries_Results.calc_stats">calc_stats</a></li>
    <li class="mono"><a href="#tstep_results.TimeSeries_Results.plot">plot</a></li>
    <li class="mono"><a href="#tstep_results.TimeSeries_Results.plot_psd">plot_psd</a></li>
  </ul>

        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">tstep_results</span> module</h1>
  <p>Classes and methods used to flexibly handle results from 
time-stepping analysis methods as implemented in <code>tstep</code> module</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results" class="source">
    <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Classes and methods used to flexibly handle results from </span>
<span class="sd">time-stepping analysis methods as implemented in `tstep` module</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__init__</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">currentVersion</span>

<span class="c1"># ********************* IMPORTS **********************************************</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">npy</span>
<span class="kn">import</span> <span class="nn">scipy.signal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.animation</span> <span class="kn">import</span> <span class="n">FuncAnimation</span>
<span class="kn">import</span> <span class="nn">timeit</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="kn">from</span> <span class="nn">common</span> <span class="kn">import</span> <span class="n">check_is_class</span><span class="p">,</span> <span class="n">deprecation_warning</span>



<span class="k">class</span> <span class="nc">TStep_Results</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class used to store, manipulate and plot results from time-stepping </span>
<span class="sd">    analysis as carried out by `TStep`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># ********** CONSTRUCTOR / DESTRUCTOR ******************</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">tstep_obj</span><span class="p">,</span>
                 <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;calc_dof_stats&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                          <span class="s1">&#39;calc_response_stats&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                          <span class="s1">&#39;retain_dof_values&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                          <span class="s1">&#39;retain_response_values&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
                 <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialisation function</span>
<span class="sd">        ***</span>
<span class="sd">        </span>
<span class="sd">        Required:</span>
<span class="sd">        </span>
<span class="sd">        * `tstep_obj`, `TStep()` class instance to which results relate</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Optional</span>
<span class="sd">        </span>
<span class="sd">        * `options` _dict_, with the following as boolean entries:</span>
<span class="sd">        </span>
<span class="sd">            * `calc_DOF_stats`, if True statistics will be calculated, to </span>
<span class="sd">              summarise time series results for DOF variables</span>
<span class="sd">            </span>
<span class="sd">            * `calc_response_stats`, if True statistics will be calculated, to </span>
<span class="sd">              summarise time series results for response variables</span>
<span class="sd">              </span>
<span class="sd">            * `retain_DOF_values`, if False DOF time series results will be </span>
<span class="sd">              deleted once summary statistics have been computed</span>
<span class="sd">                         </span>
<span class="sd">            * `retain_response_values`, if False response time series results </span>
<span class="sd">              will be deleted once summary statistics have been computed</span>
<span class="sd">          </span>
<span class="sd">            Choosing _False_ for the above can be done to be more economical </span>
<span class="sd">            with memory usage, for example when carrying out multiple analyses. </span>
<span class="sd">            Note that providing DOF time series are retained, responses can </span>
<span class="sd">            always be re-calculated using `calc_responses()` method</span>
<span class="sd">        &quot;&quot;&quot;</span>
                
        <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span><span class="o">=</span><span class="mi">0</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">=</span><span class="n">tstep_obj</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance of `tstep` class, to which results relate</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">DynSys_list</span> <span class="o">=</span> <span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">DynSys_list</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of DynSys objects to which results held by this object relate</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">response_results</span><span class="o">=</span><span class="p">[]</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of matrices to which computed responses are recorded </span>
<span class="sd">        for each time step</span>
<span class="sd">        &quot;&quot;&quot;</span>
                
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">options</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dict containing options - refer __init__() docstring for details</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">dof_stats</span><span class="o">=</span><span class="bp">None</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dict of statistics, evaluated over all time steps, for each DOF</span>
<span class="sd">        </span>
<span class="sd">        _Set using `CalcDOFStats()`_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
    <span class="c1"># -----------------GETTER / SETTER FUNCTIONS FOR PROPERTIES ---------------    </span>
                
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nDOF</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of degrees of freedom for system being analysed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nDOF</span>
    
    <span class="nd">@nDOF.setter</span>
    <span class="k">def</span> <span class="nf">nDOF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nDOF</span> <span class="o">=</span> <span class="n">value</span>
        
    <span class="c1"># ---------------</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">t</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Time values for each results time step</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_t</span>
        
    <span class="nd">@t.setter</span>
    <span class="k">def</span> <span class="nf">t</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">values</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_t</span> <span class="o">=</span> <span class="n">values</span>
        
    <span class="c1"># ---------------</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        External applied forces</span>
<span class="sd">        </span>
<span class="sd">        Returns matrix of shape [nSteps,nDOF]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_obj</span>
        
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">values</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">f_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns `TimeSeries_Results()` instance used to internally implement</span>
<span class="sd">        `f`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_force_results</span>
    
    <span class="nd">@f.setter</span>
    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">values</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_force_results</span> <span class="o">=</span> <span class="bp">None</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nDOF</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">nDOF</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">nDOF</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Inconsistent nDOF!&quot;</span><span class="p">)</span>
            
            <span class="n">obj</span> <span class="o">=</span> <span class="n">TimeSeries_Results</span><span class="p">(</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;f</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">n</span> 
                                              <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nDOF</span><span class="p">)],</span>
                                     <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="p">,</span>
                                     <span class="n">tstep_results_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="p">,</span>
                                     <span class="n">plot_options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;use_common_plot&#39;</span> <span class="p">:</span><span class="bp">True</span><span class="p">})</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_force_results</span> <span class="o">=</span> <span class="n">obj</span>
        
    <span class="c1"># ---------------</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">v</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Displacements of analysis DOFs</span>
<span class="sd">        </span>
<span class="sd">        Returns matrix of shape [nSteps,nDOF]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_obj</span>
        
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">values</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">v_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns `TimeSeries_Results()` instance used to internally implement</span>
<span class="sd">        `v`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_disp_results</span>
    
    <span class="nd">@v.setter</span>
    <span class="k">def</span> <span class="nf">v</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">values</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_disp_results</span> <span class="o">=</span> <span class="bp">None</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nDOF</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">nDOF</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">nDOF</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Inconsistent nDOF!&quot;</span><span class="p">)</span>
            
            <span class="n">obj</span> <span class="o">=</span> <span class="n">TimeSeries_Results</span><span class="p">(</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$y_{</span><span class="si">%d</span><span class="s2">}$&quot;</span> <span class="o">%</span> <span class="n">n</span> 
                                              <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nDOF</span><span class="p">)],</span>
                                     <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="p">,</span>
                                     <span class="n">tstep_results_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="p">,</span>
                                     <span class="n">plot_options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;use_common_plot&#39;</span> <span class="p">:</span><span class="bp">True</span><span class="p">})</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_disp_results</span> <span class="o">=</span> <span class="n">obj</span>
        
    <span class="c1"># ---------------</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vdot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Velocities of analysis DOFs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vdot_obj</span>
        
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">values</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vdot_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns `TimeSeries_Results()` instance used to internally implement</span>
<span class="sd">        `vdot`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_velocity_results</span>
    
    <span class="nd">@vdot.setter</span>
    <span class="k">def</span> <span class="nf">vdot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">values</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_velocity_results</span> <span class="o">=</span> <span class="bp">None</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nDOF</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">nDOF</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">nDOF</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Inconsistent nDOF!&quot;</span><span class="p">)</span>
            
            <span class="n">obj</span> <span class="o">=</span> <span class="n">TimeSeries_Results</span><span class="p">(</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$\dot{v}_{</span><span class="si">%d</span><span class="s2">}$&quot;</span> <span class="o">%</span> <span class="n">n</span>
                                              <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nDOF</span><span class="p">)],</span>
                                     <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="p">,</span>
                                     <span class="n">tstep_results_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="p">,</span>
                                     <span class="n">plot_options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;use_common_plot&#39;</span> <span class="p">:</span><span class="bp">True</span><span class="p">})</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_velocity_results</span> <span class="o">=</span> <span class="n">obj</span>
        
    <span class="c1"># ---------------</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">v2dot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Accelerations of analysis DOFs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v2dot_obj</span>
        
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">values</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">v2dot_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns `TimeSeries_Results()` instance used to internally implement</span>
<span class="sd">        `v2dot`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accn_results</span>
    
    <span class="nd">@v2dot.setter</span>
    <span class="k">def</span> <span class="nf">v2dot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">values</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_accn_results</span> <span class="o">=</span> <span class="bp">None</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nDOF</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">nDOF</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">nDOF</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Inconsistent nDOF!&quot;</span><span class="p">)</span>
            
            <span class="n">obj</span> <span class="o">=</span> <span class="n">TimeSeries_Results</span><span class="p">(</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$\ddot{v}_{</span><span class="si">%d</span><span class="s2">}$&quot;</span> <span class="o">%</span> <span class="n">n</span>
                                              <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nDOF</span><span class="p">)],</span>
                                     <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="p">,</span>
                                     <span class="n">tstep_results_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="p">,</span>
                                     <span class="n">plot_options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;use_common_plot&#39;</span> <span class="p">:</span><span class="bp">True</span><span class="p">})</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_accn_results</span> <span class="o">=</span> <span class="n">obj</span>
        
    <span class="c1"># ---------------</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">f_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal constraint forces</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_constraint_obj</span>
        
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">values</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">f_constraint_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns `TimeSeries_Results()` instance used to internally implement</span>
<span class="sd">        `f_constraint`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constraint_forces</span>
    
    <span class="nd">@f_constraint.setter</span>
    <span class="k">def</span> <span class="nf">f_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">values</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_constraint_forces</span> <span class="o">=</span> <span class="bp">None</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nDOF</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">nDOF</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">nDOF</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Inconsistent nDOF!&quot;</span><span class="p">)</span>
            
            <span class="n">obj</span> <span class="o">=</span> <span class="n">TimeSeries_Results</span><span class="p">(</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$f_{constraint,</span><span class="si">%d</span><span class="s2">}$&quot;</span> <span class="o">%</span> <span class="n">n</span>
                                              <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nDOF</span><span class="p">)],</span>
                                     <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="p">,</span>
                                     <span class="n">tstep_results_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="p">,</span>
                                     <span class="n">plot_options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;use_common_plot&#39;</span> <span class="p">:</span><span class="bp">True</span><span class="p">})</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_constraint_forces</span> <span class="o">=</span> <span class="n">obj</span>
    
    <span class="c1"># ---------------     </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nResults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of time-steps at which results are recorded</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nResults</span>
    
    <span class="nd">@nResults.setter</span>
    <span class="k">def</span> <span class="nf">nResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nResults</span> <span class="o">=</span> <span class="n">value</span>
     
    <span class="c1"># -------------------------------------------------------------------------</span>
    
    
    
    
        
        
    <span class="k">def</span> <span class="nf">ClearResults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clear all results from previous time-stepping analysis</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vdot</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v2dot</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_constraint</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span> <span class="o">=</span> <span class="mi">0</span>
        
        
    <span class="k">def</span> <span class="nf">RecordResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">vdot</span><span class="p">,</span><span class="n">v2dot</span><span class="p">,</span><span class="n">f_constraint</span><span class="p">,</span>
                      <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">append</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Used to record results from time-stepping analysis as implemented </span>
<span class="sd">        by `TStep().run()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="s1">&#39;__len__&#39;</span><span class="p">):</span>
            <span class="n">nResults</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nResults</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">append</span><span class="o">=</span><span class="bp">False</span> <span class="c1"># no results currently save</span>
                       
        <span class="k">if</span> <span class="n">append</span><span class="p">:</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">t</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vdot</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vdot</span><span class="p">,</span><span class="n">vdot</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v2dot</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2dot</span><span class="p">,</span><span class="n">v2dot</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f_constraint</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f_constraint</span><span class="p">,</span><span class="n">f_constraint</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            
        <span class="k">else</span><span class="p">:</span>
                                   
            <span class="bp">self</span><span class="o">.</span><span class="n">nDOF</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="o">=</span><span class="n">t</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">=</span><span class="n">f</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="o">=</span><span class="n">v</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vdot</span><span class="o">=</span><span class="n">vdot</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v2dot</span><span class="o">=</span><span class="n">v2dot</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f_constraint</span><span class="o">=</span><span class="n">f_constraint</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span> <span class="o">+=</span> <span class="n">nResults</span>
        
        
    <span class="k">def</span> <span class="nf">get_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dynsys_obj</span><span class="p">,</span><span class="n">attr_list</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves results for a given DynSys object, which is assumed to be a </span>
<span class="sd">        subsystem of the parent system (this is checked)</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Required:</span>
<span class="sd">            </span>
<span class="sd">        * `dynsys_obj`, instance of DynSys class; must be a subsystem of the </span>
<span class="sd">          parent system</span>
<span class="sd">          </span>
<span class="sd">        * `attr_list`, list of strings, to denote the results attributes to be </span>
<span class="sd">          returned</span>
<span class="sd">         </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Convert to list if single argument provided</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attr_list</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="n">attr_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">attr_list</span><span class="p">)</span>
        
        <span class="c1"># Check that dynsys_obj is part of the system that has been analysed</span>
        <span class="n">parent_sys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span>
        <span class="n">DynSys_list</span> <span class="o">=</span> <span class="n">parent_sys</span><span class="o">.</span><span class="n">DynSys_list</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">dynsys_obj</span> <span class="ow">in</span> <span class="n">DynSys_list</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`dynsys_obj` is not a subsystem &quot;</span> <span class="o">+</span> 
                             <span class="s2">&quot;of the parent system that has been analysed!&quot;</span><span class="p">)</span>
        
        <span class="c1"># Determine splice indices to use to get results relating to requested system </span>
        <span class="n">sys_index</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">DynSys_list</span><span class="p">)</span> <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">dynsys_obj</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="n">nDOF_list_cum</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">cumsum</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">nDOF</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">DynSys_list</span><span class="p">])</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">sys_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">startIndex</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">startIndex</span> <span class="o">=</span> <span class="n">nDOF_list_cum</span><span class="p">[</span><span class="n">sys_index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="n">endIndex</span> <span class="o">=</span> <span class="n">nDOF_list_cum</span><span class="p">[</span><span class="n">sys_index</span><span class="p">]</span> 
        
        <span class="c1"># Loop through to return requested attributes</span>
        <span class="n">vals_list</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attr_list</span><span class="p">:</span>
            
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">attr</span><span class="p">):</span>
                
                <span class="n">vals</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>             <span class="c1"># for full system</span>
                
                <span class="k">if</span> <span class="n">attr</span> <span class="o">!=</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span>
                    <span class="n">vals</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">startIndex</span><span class="p">:</span><span class="n">endIndex</span><span class="p">,:]</span>    <span class="c1"># for subsystem requested</span>
                
                <span class="n">vals_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
                
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not retrieve requested attribute &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">attr</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">vals_list</span>
        
    
    <span class="k">def</span> <span class="nf">_TimePlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ax</span><span class="p">,</span><span class="n">t_vals</span><span class="p">,</span><span class="n">data_vals</span><span class="p">,</span>
                  <span class="n">titleStr</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                  <span class="n">xlabelStr</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                  <span class="n">ylabelStr</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                  <span class="n">xlim</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                  <span class="n">showxticks</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                  <span class="n">data_labels</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Produces a time series results plot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">lines</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_vals</span><span class="p">,</span><span class="n">data_vals</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">titleStr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">titleStr</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">xlabelStr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabelStr</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">ylabelStr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabelStr</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="ow">not</span> <span class="n">showxticks</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
            
        <span class="k">return</span> <span class="n">lines</span>
        
    
    <span class="k">def</span> <span class="nf">PlotStateResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">deprecation_warning</span><span class="p">(</span><span class="s1">&#39;PlotStateResults&#39;</span><span class="p">,</span><span class="s1">&#39;plot_state_results&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_state_results</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
    
    <span class="k">def</span> <span class="nf">plot_state_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                           <span class="n">dynsys_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                           <span class="n">verbose</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Produces time series plots of the following, as subplots in a single </span>
<span class="sd">        figure:</span>
<span class="sd">            </span>
<span class="sd">        * Applied external forces</span>
<span class="sd">        </span>
<span class="sd">        * Displacements</span>
<span class="sd">        </span>
<span class="sd">        * Velocities</span>
<span class="sd">        </span>
<span class="sd">        * Accelerations</span>
<span class="sd">        </span>
<span class="sd">        * Constraint forces (only if constraint equations defined)</span>
<span class="sd">        </span>
<span class="sd">        Note all results plotted relate to the _analysis freedoms_.</span>
<span class="sd">        </span>
<span class="sd">        For systems composed of multiple subsystems, one figure will be </span>
<span class="sd">        produced for each subsystem.</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        ***</span>
<span class="sd">        **Optional:**</span>
<span class="sd">            </span>
<span class="sd">        * `dynsys_obj`, can be used to specify the subsystem for which results </span>
<span class="sd">          which should be plotted. If _None_ then results for all freedoms </span>
<span class="sd">          (i.e. all subsystems) will be plotted.</span>
<span class="sd">          </span>
<span class="sd">        * `verbose`, _boolean_, if True text will be written to console</span>
<span class="sd">          </span>
<span class="sd">        ***</span>
<span class="sd">        **Returns:**</span>
<span class="sd">        </span>
<span class="sd">        _List_ of figure objects</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Preparing state results plot...&quot;</span><span class="p">)</span>
            <span class="n">tic</span><span class="o">=</span><span class="n">timeit</span><span class="o">.</span><span class="n">default_timer</span><span class="p">()</span>
            
        <span class="c1"># Get subsystems to iterate over</span>
        <span class="n">DynSys_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">DynSys_list</span>
        <span class="k">if</span> <span class="n">dynsys_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">dynsys_obj</span> <span class="ow">in</span> <span class="n">DynSys_list</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`dynsys_obj` not in DynSys_list!&quot;</span><span class="p">)</span>
                
            <span class="n">DynSys_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">dynsys_obj</span><span class="p">]</span>
        
        <span class="c1"># Iterate over all subsystems, producing figure for each</span>
        <span class="n">fig_list</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">DynSys_list</span><span class="p">:</span>
            
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;   Plotting state results for &#39;</span><span class="si">%s</span><span class="s2">&#39;...&quot;</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

            <span class="c1"># Determine number of subplots required</span>
            <span class="n">hasConstraints</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">hasConstraints</span><span class="p">()</span>
            
            <span class="k">if</span> <span class="n">hasConstraints</span><span class="p">:</span>
                <span class="n">nPltRows</span><span class="o">=</span><span class="mi">5</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nPltRows</span><span class="o">=</span><span class="mi">4</span>
                
            <span class="c1"># Create plot of results for analysis DOFs</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nPltRows</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
            <span class="n">fig_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        
            <span class="c1"># Set xlim</span>
            <span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">tStart</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">tEnd</span><span class="p">]</span>
            
            <span class="c1"># Get system description string</span>
            <span class="n">sysStr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">DynSys_list</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">DynSys_list</span>
            
            <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">isModal</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">DynSys_list</span><span class="p">]):</span>
                <span class="c1"># All systems and subsystems are modal</span>
                <span class="n">sysStr</span> <span class="o">=</span> <span class="s2">&quot;Modal &quot;</span>
                
             <span class="c1"># Get data to plot   </span>
            <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span>
            <span class="n">f</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">vdot</span><span class="p">,</span><span class="n">v2dot</span><span class="p">,</span><span class="n">f_constraint</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_results</span><span class="p">(</span><span class="n">obj</span><span class="p">,[</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;v&#39;</span><span class="p">,</span>
                                                               <span class="s1">&#39;vdot&#39;</span><span class="p">,</span><span class="s1">&#39;v2dot&#39;</span><span class="p">,</span>
                                                               <span class="s1">&#39;f_constraint&#39;</span><span class="p">])</span>

            
            <span class="c1"># Create time series plots</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_TimePlot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                           <span class="n">t_vals</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
                           <span class="n">data_vals</span><span class="o">=</span><span class="n">f</span><span class="p">,</span>
                           <span class="n">xlim</span><span class="o">=</span><span class="n">xlim</span><span class="p">,</span>
                           <span class="n">titleStr</span><span class="o">=</span><span class="s2">&quot;Applied </span><span class="si">%s</span><span class="s2">Forces (N)&quot;</span> <span class="o">%</span> <span class="n">sysStr</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_TimePlot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                           <span class="n">t_vals</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
                           <span class="n">data_vals</span><span class="o">=</span><span class="n">v</span><span class="p">,</span>
                           <span class="n">titleStr</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Displacements (m)&quot;</span> <span class="o">%</span> <span class="n">sysStr</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_TimePlot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                           <span class="n">t_vals</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
                           <span class="n">data_vals</span><span class="o">=</span><span class="n">vdot</span><span class="p">,</span>
                           <span class="n">titleStr</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Velocities (m/s)&quot;</span> <span class="o">%</span> <span class="n">sysStr</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_TimePlot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                           <span class="n">t_vals</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
                           <span class="n">data_vals</span><span class="o">=</span><span class="n">v2dot</span><span class="p">,</span>
                           <span class="n">titleStr</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Accelerations ($m/s^2$)&quot;</span> <span class="o">%</span> <span class="n">sysStr</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">hasConstraints</span><span class="p">:</span>
                
                <span class="bp">self</span><span class="o">.</span><span class="n">_TimePlot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
                           <span class="n">t_vals</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
                           <span class="n">data_vals</span><span class="o">=</span><span class="n">f_constraint</span><span class="p">,</span>
                           <span class="n">titleStr</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Constraint forces (N)&quot;</span> <span class="o">%</span> <span class="n">sysStr</span><span class="p">)</span>
                
            <span class="n">axarr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (secs)&quot;</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
            
            <span class="c1"># Overall title for plot</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;State variable results for &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="n">toc</span><span class="o">=</span><span class="n">timeit</span><span class="o">.</span><span class="n">default_timer</span><span class="p">()</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Plot prepared after </span><span class="si">%.3f</span><span class="s2"> seconds.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">toc</span><span class="o">-</span><span class="n">tic</span><span class="p">))</span>
            
        <span class="k">return</span> <span class="n">fig_list</span>
    
    
    <span class="k">def</span> <span class="nf">PlotResponseResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">deprecation_warning</span><span class="p">(</span><span class="s1">&#39;PlotResponseResults&#39;</span><span class="p">,</span><span class="s1">&#39;plot_response_results&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_response_results</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
    
    <span class="k">def</span> <span class="nf">plot_response_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                              <span class="n">dynsys_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                              <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Produces a new figure with linked time series subplots for </span>
<span class="sd">        all responses/outputs</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        **Optional:**</span>
<span class="sd">            </span>
<span class="sd">        * `dynsys_obj`, can be used to specify the subsystem for which results </span>
<span class="sd">          which should be plotted. If _None_ then results for all freedoms </span>
<span class="sd">          (i.e. all subsystems) will be plotted.</span>
<span class="sd">          </span>
<span class="sd">        ***</span>
<span class="sd">        **Returns:**</span>
<span class="sd">         </span>
<span class="sd">        Nested list of figure objects</span>
<span class="sd">          </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Preparing response results plots...&quot;</span><span class="p">)</span>
            <span class="n">tic</span><span class="o">=</span><span class="n">timeit</span><span class="o">.</span><span class="n">default_timer</span><span class="p">()</span>
            
        <span class="c1"># Get subsystems to iterate over</span>
        <span class="n">DynSys_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DynSys_list</span>
        <span class="k">if</span> <span class="n">dynsys_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">dynsys_obj</span> <span class="ow">in</span> <span class="n">DynSys_list</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`dynsys_obj` not in DynSys_list!&quot;</span><span class="p">)</span>
                
            <span class="n">DynSys_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">dynsys_obj</span><span class="p">]</span>
    
        <span class="c1"># Iterate over all responses for all specified subsystems</span>
        
        <span class="n">fig_list</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Loop over all specified subsystems</span>
        <span class="k">for</span> <span class="n">dynsys_obj</span><span class="p">,</span> <span class="n">response_obj_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">DynSys_list</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">response_results</span><span class="p">):</span>
            
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;   Plotting responses results for &#39;{0}&#39;...&quot;</span>
                  <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            
            <span class="n">fig_list_inner</span> <span class="o">=</span> <span class="p">[]</span>
            
            <span class="c1"># Iterate over all responses for this subsystem</span>
            <span class="k">for</span> <span class="n">response_results_obj</span> <span class="ow">in</span> <span class="n">response_obj_list</span><span class="p">:</span>
                
                <span class="n">fig_list_inner</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">response_results_obj</span><span class="o">.</span><span class="n">plot</span><span class="p">())</span>
                
            <span class="n">fig_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig_list_inner</span><span class="p">)</span>
                
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="n">toc</span><span class="o">=</span><span class="n">timeit</span><span class="o">.</span><span class="n">default_timer</span><span class="p">()</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Plots prepared after </span><span class="si">%.3f</span><span class="s2"> seconds.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">toc</span><span class="o">-</span><span class="n">tic</span><span class="p">))</span>
            
        <span class="k">return</span> <span class="n">fig_list</span>
        
    
    <span class="k">def</span> <span class="nf">PlotResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="n">deprecation_warning</span><span class="p">(</span><span class="s1">&#39;PlotResults&#39;</span><span class="p">,</span><span class="s1">&#39;plot_results&#39;</span><span class="p">)</span>
    
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_results</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
    
    <span class="k">def</span> <span class="nf">plot_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                     <span class="n">dynsys_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                     <span class="n">verbose</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Presents the results of time-stepping analysis by producing the </span>
<span class="sd">        following plots:</span>
<span class="sd">        </span>
<span class="sd">        * State results plot: refer `PlotStateResults()`</span>
<span class="sd">        </span>
<span class="sd">        * Response results plot: refer `PlotResponseResults()`</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        **Optional:**</span>
<span class="sd">            </span>
<span class="sd">        * `dynsys_obj`, object specifying system whose results are to be </span>
<span class="sd">          plotted. If _None_ plots will be produced for all systems. </span>
<span class="sd">        </span>
<span class="sd">        * `verbose`, _boolean_, if True progress will be written to console</span>
<span class="sd">        </span>
<span class="sd">        * `dof2Plot`, _list_ of integers to denote DOFs to plot. Can be used to </span>
<span class="sd">          produce a &#39;cleaner&#39; plot, in case of large numbers of DOFs. Note will </span>
<span class="sd">          only work in conjunction with `dynsys_obj`, i.e. subsystem must also </span>
<span class="sd">          be selected</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        **Returns:**</span>
<span class="sd">        </span>
<span class="sd">        _List_ of figure objects</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">state_fig_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_state_results</span><span class="p">(</span><span class="n">dynsys_obj</span><span class="o">=</span><span class="n">dynsys_obj</span><span class="p">,</span>
                                                 <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        
        <span class="n">response_fig_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_response_results</span><span class="p">(</span><span class="n">dynsys_obj</span><span class="o">=</span><span class="n">dynsys_obj</span><span class="p">,</span>
                                                       <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">state_fig_list</span><span class="p">,</span> <span class="n">response_fig_list</span>
    
    
    <span class="k">def</span> <span class="nf">PlotResponsePSDs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nperseg</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Produces power spectral density plots of response time series</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Optional:</span>
<span class="sd">        </span>
<span class="sd">        * `nperseg`, length of each segment used in PSD calculation</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Plotting PSD estimates of responses using periodograms...&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response_results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No response time series data avaliable!&quot;</span><span class="p">)</span>
        
        <span class="c1"># Get sampling frequency</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dt</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`dt` is None: cannot calculate PSDs from &quot;</span>
                             <span class="s2">&quot;variable timestep time series&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fs</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dt</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Sampling frequency: fs = </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">fs</span><span class="p">)</span>
        
        <span class="c1"># Loop through all responses</span>
        <span class="n">fig_list</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">responses_list</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_results</span><span class="p">:</span>
            
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">responses_list</span><span class="p">:</span>
                
                <span class="n">fig_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">plot_psd</span><span class="p">())</span>
        
        <span class="k">return</span> <span class="n">fig_list</span>
    

    <span class="k">def</span> <span class="nf">PlotDeformed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">timestep_index</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span><span class="n">dynsys_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Produce a plot of system in its deformed configuration, as per results </span>
<span class="sd">        at a given time step</span>
<span class="sd">        </span>
<span class="sd">        Additional keyword arguments are passed-down to `PlotSystem()` method </span>
<span class="sd">        of applicable system object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Get system to plot</span>
        <span class="k">if</span> <span class="n">dynsys_obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">dynsys_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span>
        
        <span class="c1"># Get results at applicable time step</span>
        <span class="n">t_val</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)[</span><span class="n">timestep_index</span><span class="p">]</span>
        <span class="k">print</span><span class="p">(</span><span class="n">t_val</span><span class="p">)</span>
        <span class="n">v_vals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetResults</span><span class="p">(</span><span class="n">dynsys_obj</span><span class="p">,[</span><span class="s1">&#39;v&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="n">timestep_index</span><span class="p">,:]</span>
        
        <span class="c1"># Create figure and axes onto which to draw system, if not provided</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
            
        <span class="c1"># Plot system onto axes</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">dynsys_obj</span><span class="o">.</span><span class="n">PlotSystem</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">v</span><span class="o">=</span><span class="n">v_vals</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
        <span class="c1"># Overlay caption to </span>
        <span class="n">time_text</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
        <span class="n">time_text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s1">&#39;Time = </span><span class="si">%.2f</span><span class="s1">s&#39;</span> <span class="o">%</span> <span class="n">t_val</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">time_text</span>
    
    
    <span class="k">def</span> <span class="nf">AnimateResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">dynsys_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">SysPlot_kwargs</span><span class="o">=</span><span class="p">{},</span>
                       <span class="n">FuncAnimation_kwargs</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Produce animation of results, plotting deformed configuration of system </span>
<span class="sd">        at each time step</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        **Required:**</span>
<span class="sd">        </span>
<span class="sd">        (No arguments required)</span>
<span class="sd">        </span>
<span class="sd">        **Optional:**</span>
<span class="sd">        </span>
<span class="sd">        * `dynsys_obj`, instance of `DynSys()` class (or derived classes), </span>
<span class="sd">          defining the system to be plotted. If None (per default argument) the </span>
<span class="sd">          parent system will be plotted</span>
<span class="sd">          </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Define axes to plot to</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
            
        <span class="k">else</span><span class="p">:</span>
            
            <span class="n">fig</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
        
        <span class="c1"># Create class to faciliate animation production</span>
        <span class="n">sys_plot_obj</span> <span class="o">=</span> <span class="n">SysPlot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">results_obj</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">SysPlot_kwargs</span><span class="p">)</span>
        
        <span class="c1"># Get tstep data</span>
        <span class="n">nResults</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span>
        
        <span class="c1"># Get time step between frames</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dt</span>
        
        <span class="k">if</span> <span class="n">dt</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># Compute average time step</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">nResults</span>
        
        <span class="c1"># Define default kwargs to pass to FuncAnimation</span>
        <span class="n">FuncAnimation_kwargs_0</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;frames&#39;</span><span class="p">:</span><span class="n">npy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nResults</span><span class="p">),</span>
                                  <span class="s1">&#39;interval&#39;</span><span class="p">:</span><span class="mi">1000</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span>
                                  <span class="s1">&#39;repeat&#39;</span><span class="p">:</span><span class="bp">False</span><span class="p">}</span>
        
        <span class="c1"># Merge with any passed kwargs: n.b passed kwargs override defaults</span>
        <span class="n">FuncAnimation_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">FuncAnimation_kwargs_0</span><span class="p">,</span>
                                <span class="o">**</span><span class="n">FuncAnimation_kwargs</span><span class="p">}</span>
        
        <span class="c1"># Create animation</span>
        <span class="n">anim</span> <span class="o">=</span> <span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">sys_plot_obj</span><span class="o">.</span><span class="n">update</span><span class="p">,</span>
                             <span class="o">**</span><span class="n">FuncAnimation_kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">anim</span>
        
        
        
        
    <span class="k">def</span> <span class="nf">calc_responses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">write_results_to_file</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                       <span class="n">results_fName</span><span class="o">=</span><span class="s2">&quot;ts_results.csv&quot;</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Responses are obtained by pre-multiplying results by output matrices</span>
<span class="sd">        </span>
<span class="sd">        Output matrices, together with their names, must be pre-defined via </span>
<span class="sd">        `DynSys` member function `AddOutputMtrx()` prior to running this </span>
<span class="sd">        function.</span>
<span class="sd">        </span>
<span class="sd">        Where a system consists of multiple subsystems, it should be note that </span>
<span class="sd">        output matrices relate to a given subsystem.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">dynsys_obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span>
        <span class="n">responses_list</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Calculate responses for all systems and subsystems</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dynsys_obj</span><span class="o">.</span><span class="n">DynSys_list</span><span class="p">:</span>
            
            <span class="n">responses_inner_list</span> <span class="o">=</span> <span class="p">[]</span>
            
            <span class="c1"># Retrieve state variables for subsystem</span>
            <span class="n">v</span><span class="p">,</span> <span class="n">vdot</span><span class="p">,</span> <span class="n">v2dot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_results</span><span class="p">(</span><span class="n">x</span><span class="p">,[</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;vdot&#39;</span><span class="p">,</span> <span class="s1">&#39;v2dot&#39;</span><span class="p">])</span>
            <span class="n">state_vector</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">v</span><span class="p">,</span><span class="n">vdot</span><span class="p">,</span><span class="n">v2dot</span><span class="p">))</span>
            
            <span class="c1"># Calculate responses for each set of outputs for this subsystem            </span>
            <span class="k">for</span> <span class="n">_om</span><span class="p">,</span> <span class="n">_names</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">output_mtrx</span><span class="p">,</span><span class="n">x</span><span class="o">.</span><span class="n">output_names</span><span class="p">):</span>
                
                <span class="n">values</span> <span class="o">=</span> <span class="n">_om</span> <span class="err">@</span> <span class="n">state_vector</span>
                                
                <span class="n">obj</span> <span class="o">=</span> <span class="n">TimeSeries_Results</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="n">_names</span><span class="p">,</span>
                                         <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span>
                                         <span class="n">tstep_results_obj</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
                
                <span class="n">responses_inner_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                
            <span class="n">responses_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">responses_inner_list</span><span class="p">)</span>
            
        <span class="c1"># Store as attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">response_results</span> <span class="o">=</span> <span class="n">responses_list</span>
                
        <span class="c1"># Calculate DOF statistics</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;calc_dof_stats&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calc_dof_stats</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
            
        <span class="c1"># Calculate response statistics</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;calc_response_stats&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calc_response_stats</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
            
        <span class="c1"># Write time series results to file</span>
        <span class="k">if</span> <span class="n">write_results_to_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">WriteResults2File</span><span class="p">(</span><span class="n">output_fName</span><span class="o">=</span><span class="n">results_fName</span><span class="p">)</span>
                
        <span class="c1"># Delete DOF time series data (to free-up memory)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;retain_dof_values&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Clearing DOF time series data to save memory...&quot;</span><span class="p">)</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">vdot</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">v2dot</span>
        
        <span class="c1"># Delete response time series data (to free up memory)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;retain_response_values&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Clearing response time series data to save memory...&quot;</span><span class="p">)</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">responses_results</span>
        
    
    <span class="k">def</span> <span class="nf">CalcKineticEnergy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates total kinetic energy of system at each time step:</span>
<span class="sd">        </span>
<span class="sd">        $$ T(t) = \dot{y}(t)^{T} M \dot{y}(t) $$</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">nResults</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span>
        
        <span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">GetSystemMatrices</span><span class="p">()[</span><span class="s2">&quot;M_mtrx&quot;</span><span class="p">]</span>
        <span class="n">vdot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vdot</span>
        
        <span class="n">KE</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">nResults</span><span class="p">,))</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nResults</span><span class="p">):</span>
        
            <span class="n">KE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">vdot</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="err">@</span> <span class="n">M</span> <span class="err">@</span> <span class="n">vdot</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">T</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">KE</span> <span class="o">=</span> <span class="n">KE</span>
        <span class="k">return</span> <span class="n">KE</span>
    
    
    <span class="k">def</span> <span class="nf">CalcPotentialEnergy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates total potential energy of system at each time step:</span>
<span class="sd">        </span>
<span class="sd">        $$ V(t) = y(t)^{T} K y(t) $$</span>

<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">nResults</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span>
        
        <span class="n">K</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">GetSystemMatrices</span><span class="p">()[</span><span class="s2">&quot;K_mtrx&quot;</span><span class="p">]</span>
        <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span>
        
        <span class="n">PE</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">nResults</span><span class="p">,))</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nResults</span><span class="p">):</span>
        
            <span class="n">PE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="err">@</span> <span class="n">K</span> <span class="err">@</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">T</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">PE</span> <span class="o">=</span> <span class="n">PE</span>
        <span class="k">return</span> <span class="n">PE</span>
   
    
    <span class="k">def</span> <span class="nf">CalcExternalWorkPower</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates power of work done by external forces at each time step:</span>
<span class="sd">            </span>
<span class="sd">        $$ P(t) = f(t)^{T} \dot{v}(t) $$</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">nResults</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span>
        
        <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span>
        <span class="n">vdot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vdot</span>
        
        <span class="n">ExtWork_Power</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">nResults</span><span class="p">,))</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nResults</span><span class="p">):</span>
        
            <span class="n">ExtWork_Power</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="err">@</span> <span class="n">vdot</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">T</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">ExtWork_Power</span> <span class="o">=</span> <span class="n">ExtWork_Power</span>
        <span class="k">return</span> <span class="n">ExtWork_Power</span>
    
    
    <span class="k">def</span> <span class="nf">CalcExternalWorkDone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates work done by external forces since t=0</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        _Practically this is done by integrating the power of work done by </span>
<span class="sd">        external forces as calculated by `CalcExternalWorkPower()` method. </span>
<span class="sd">        Note integration is approximate; trapezium rule is used_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">t</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
        <span class="n">ExtWork_power</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CalcExternalWorkPower</span><span class="p">()</span>
        
        <span class="c1"># Integrate power of external work to get total external work from t=0</span>
        <span class="n">ExtWork</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">cumtrapz</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">ExtWork_power</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">ExtWork</span> <span class="o">=</span> <span class="n">ExtWork</span>
        <span class="k">return</span> <span class="n">ExtWork</span>
    
    
    <span class="k">def</span> <span class="nf">PlotEnergyResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">recalculate</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Produce figure with subplots to show key energy results of analysis</span>
<span class="sd">        e.g. external work done, kinetic &amp; potential energies</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">recalculate</span><span class="p">:</span>
            <span class="n">KE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CalcKineticEnergy</span><span class="p">()</span>
            <span class="n">PE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CalcPotentialEnergy</span><span class="p">()</span>
            <span class="n">ExtWork</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CalcExternalWorkDone</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">KE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">KE</span>
            <span class="n">PE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PE</span>
            <span class="n">ExtWork</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExtWork</span>
            
        <span class="c1"># Back-calculate energy dissipated</span>
        <span class="n">E0</span> <span class="o">=</span> <span class="n">PE</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">KE</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>              <span class="c1"># energy of system at t=0</span>
        <span class="n">ED</span> <span class="o">=</span> <span class="n">ExtWork</span> <span class="o">-</span> <span class="p">(</span><span class="n">PE</span><span class="o">+</span><span class="n">KE</span><span class="p">)</span> <span class="o">+</span> <span class="n">E0</span>     <span class="c1"># energy dissipated since t=0</span>
                        
        <span class="c1"># Get time values for plots</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
        
        <span class="n">tstep_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span>

        <span class="c1"># Create new figure for plots</span>
        <span class="n">fig</span><span class="p">,</span><span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Energy results</span><span class="se">\n</span><span class="s2">Analysis: &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">tstep_obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">fontsize_titles</span> <span class="o">=</span> <span class="mi">10</span>
        
        <span class="c1"># Define individual subplots</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">ExtWork</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;External work done&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,(</span><span class="n">KE</span><span class="o">+</span><span class="n">PE</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Conserved energy, $E=T+V$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">ED</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Energy dissipated (from energy balance)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,(</span><span class="n">KE</span><span class="o">-</span><span class="n">PE</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lagrangian, $L=T-V$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;External/Internal work done&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize_titles</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">KE</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Kinetic energy: T(t) = $\dot{y}(t)^{T}M\dot{y}(t)$&quot;</span><span class="p">,</span>
                     <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize_titles</span><span class="p">)</span>
        
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">PE</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Potential energy: V(t) = $y(t)^{T}Ky(t)$&quot;</span><span class="p">,</span>
                     <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize_titles</span><span class="p">)</span>
        
        <span class="c1"># Set details for shared x-axis</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">tStart</span><span class="p">,</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">tEnd</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time $t$ (secs)&quot;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">fig</span>
        
    
        
    <span class="k">def</span> <span class="nf">calc_dof_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Obtain basic statistics to describe DOF time series</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        **Required:**</span>
<span class="sd">        </span>
<span class="sd">        No arguments are required</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        **Optional:**</span>
<span class="sd">        </span>
<span class="sd">        * `verbose`, _boolean_, controls the amount of console output</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        **Returns:**</span>
<span class="sd">        </span>
<span class="sd">        Stats are returned as a _list_ of _dicts_, with list indexs as follows:</span>
<span class="sd">            </span>
<span class="sd">        * 0 : DOF displacements</span>
<span class="sd">        </span>
<span class="sd">        * 1 : DOF velocities</span>
<span class="sd">        </span>
<span class="sd">        * 2 : DOF accelerations</span>
<span class="sd">        </span>
<span class="sd">        * 3 : Constraint forces (only if constraints defined)</span>
<span class="sd">        </span>
<span class="sd">        Dict entries will in general be _arrays_, giving stats results for each </span>
<span class="sd">        degree of freedom</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;calc_dof_stats&#39;</span><span class="p">]:</span>
            
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Calculating DOF statistics...&quot;</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">v_obj</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">vdot_obj</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">v2dot_obj</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">f_constraint_obj</span><span class="p">]:</span>
                
                <span class="n">obj</span><span class="o">.</span><span class="n">calc_stats</span><span class="p">()</span>
                        
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&#39;calc_dof_stats&#39; option set to False</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
                      <span class="s2">&quot;DOF statistics will not be computed&quot;</span><span class="p">)</span>

        
    
    <span class="k">def</span> <span class="nf">calc_response_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate basic statistics to describe response time series</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;calc_response_stats&#39;</span><span class="p">]:</span>
            
            <span class="c1"># Get paired lists to loop over</span>
            <span class="n">response_obj_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_results</span>
            <span class="n">dynsys_obj_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">DynSys_list</span>
            
            <span class="c1"># Loop over all systems and subsystems</span>
            <span class="k">for</span> <span class="n">dynsys_obj</span><span class="p">,</span> <span class="n">response_objs</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dynsys_obj_list</span><span class="p">,</span>
                                                 <span class="n">response_obj_list</span><span class="p">):</span>
                
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Calculating response statistics &quot;</span> <span class="o">+</span> 
                          <span class="s2">&quot;for &#39;{0}&#39;...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

                <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">response_objs</span><span class="p">:</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">calc_stats</span><span class="p">()</span>
                                
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&#39;calc_response_stats&#39; option set to False</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> 
                      <span class="s2">&quot;Response statistics will not be computed&quot;</span><span class="p">)</span>
            
            
    <span class="k">def</span> <span class="nf">get_dof_stats_df</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns dof stats as Pandas dataframe</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">def</span> <span class="nf">get_stats_df</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">prefix</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
            <span class="n">stats_dict</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">stats</span>
            <span class="n">names</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">names</span>
            <span class="k">print</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">stats_dict</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">df</span>
        
        <span class="n">df_list</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_stats_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f_obj</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">))</span>
        <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_stats_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v_obj</span><span class="p">,</span><span class="s1">&#39;disp&#39;</span><span class="p">))</span>
        <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_stats_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vdot_obj</span><span class="p">,</span><span class="s1">&#39;vel&#39;</span><span class="p">))</span>
        <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_stats_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2dot_obj</span><span class="p">,</span><span class="s1">&#39;acc&#39;</span><span class="p">))</span>
        <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_stats_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f_constraint_obj</span><span class="p">,</span><span class="s1">&#39;f_constraint&#39;</span><span class="p">))</span>
            
        <span class="k">return</span> <span class="n">df_list</span>
        
    
    <span class="k">def</span> <span class="nf">get_response_stats_df</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns response stats as list of Pandas dataframes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">df_list</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">dynsys_obj</span><span class="p">,</span> <span class="n">results_obj_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DynSys_list</span><span class="p">,</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">response_results</span><span class="p">):</span>
                    
            <span class="k">for</span> <span class="n">results_obj</span> <span class="ow">in</span> <span class="n">results_obj_list</span><span class="p">:</span>
            
                <span class="n">response_names</span> <span class="o">=</span> <span class="n">results_obj</span><span class="o">.</span><span class="n">names</span>
                <span class="n">stats_dict</span> <span class="o">=</span> <span class="n">results_obj</span><span class="o">.</span><span class="n">stats</span>

                <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">stats_dict</span><span class="p">,</span>
                                                <span class="n">index</span><span class="o">=</span><span class="n">response_names</span><span class="p">))</span>
            
        <span class="k">return</span> <span class="n">df_list</span>
    
    
    <span class="k">def</span> <span class="nf">PrintResponseStats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints response stats to text window</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">for</span> <span class="n">dynsys_obj</span><span class="p">,</span> <span class="n">stats_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_stats_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;System name: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Response names: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">output_names</span><span class="p">))</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Response statistics :&quot;</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">stats_str</span><span class="p">,</span> <span class="n">stats_vals</span> <span class="ow">in</span> <span class="n">stats_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39;:&quot;</span> <span class="o">%</span> <span class="n">stats_str</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="n">stats_vals</span><span class="p">)</span>
            
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    
    
    <span class="k">def</span> <span class="nf">WriteResults2File</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">output_fName</span><span class="o">=</span><span class="s2">&quot;timeseries_results.csv&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes time-series results to file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">header</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
        <span class="n">header</span><span class="o">+=</span><span class="s2">&quot;Time series results export</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">header</span><span class="o">+=</span><span class="s2">&quot;dynsys_obj:, {0}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
        <span class="n">header</span><span class="o">+=</span><span class="s2">&quot;nDOF:, {0}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nDOF</span><span class="p">)</span>
        <span class="n">header</span><span class="o">+=</span><span class="s2">&quot;nResults:, {0}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nResults</span><span class="p">)</span>
        <span class="n">header</span><span class="o">+=</span><span class="s2">&quot;DynSys version:, {0}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">currentVersion</span><span class="p">)</span>
        <span class="n">header</span><span class="o">+=</span><span class="s2">&quot;Export date/time:, {0}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">))</span>
        <span class="n">header</span><span class="o">+=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        
        <span class="n">array2write</span><span class="o">=</span><span class="bp">None</span>
        
        <span class="k">def</span> <span class="nf">writeArray</span><span class="p">(</span><span class="n">arrName</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Function to append array and create suitable headers</span>
<span class="sd">            &quot;&quot;&quot;</span>
            
            <span class="n">arr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">arrName</span><span class="p">)</span>

            <span class="n">nonlocal</span> <span class="n">header</span><span class="p">,</span> <span class="n">array2write</span>
            
            <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="n">header</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%s%d</span><span class="s2">,&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">arrName</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">header</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">,&quot;</span> <span class="o">%</span> <span class="n">arrName</span>
                
            <span class="k">if</span> <span class="n">array2write</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">array2write</span> <span class="o">=</span> <span class="n">arr</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">array2write</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">array2write</span><span class="p">,</span><span class="n">arr</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            
        <span class="c1"># Use the above function to prepare data to write to file</span>
        <span class="n">writeArray</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
        <span class="n">writeArray</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
        <span class="n">writeArray</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>
        <span class="n">writeArray</span><span class="p">(</span><span class="s1">&#39;vdot&#39;</span><span class="p">)</span>
        <span class="n">writeArray</span><span class="p">(</span><span class="s1">&#39;v2dot&#39;</span><span class="p">)</span>
        <span class="n">writeArray</span><span class="p">(</span><span class="s1">&#39;f_constraint&#39;</span><span class="p">)</span>
        
        <span class="c1"># Write to file</span>
        <span class="n">npy</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">output_fName</span><span class="p">,</span>
                    <span class="n">X</span><span class="o">=</span><span class="n">array2write</span><span class="p">,</span>
                    <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                    <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">)</span>
        
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Time-series results written to `{0}`&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output_fName</span><span class="p">))</span>
        
        

<span class="k">class</span> <span class="nc">SysPlot</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to faciliate animation of displacement results </span>
<span class="sd">    as held in `tstep_results`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">results_obj</span><span class="p">,</span>
                 <span class="n">y_lim</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">plot_loading</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                 <span class="n">load_scale</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">load_scale_relative</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                 <span class="n">time_template</span> <span class="o">=</span> <span class="s1">&#39;Time = </span><span class="si">%.2f</span><span class="s1">s&#39;</span><span class="p">,</span>
                 <span class="n">time_text_loc</span><span class="o">=</span><span class="p">(</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">),):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Animation plot initialisation method</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Required:</span>
<span class="sd">            </span>
<span class="sd">        * `ax`, axes to plot to</span>
<span class="sd">        </span>
<span class="sd">        * `results_obj`, instance of `tstep_results` class</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Optional:</span>
<span class="sd">        </span>
<span class="sd">        * `time_text_loc`, tuple, defines location of time caption</span>
<span class="sd">        </span>
<span class="sd">        * `time_template`, string, text for time caption</span>
<span class="sd">        </span>
<span class="sd">        * `load_scale`, factor used to convert loads (N) to distances (m). If </span>
<span class="sd">          _None_ (default) then `load_scale` will be set as proportion of </span>
<span class="sd">           vertical scale according to `load_scale_relative`</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Get objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_obj</span> <span class="o">=</span> <span class="n">results_obj</span>
        
        <span class="c1"># Get dynamic system object</span>
        <span class="n">tstep_obj</span> <span class="o">=</span> <span class="n">results_obj</span><span class="o">.</span><span class="n">tstep_obj</span>
        <span class="n">dynsys_obj</span> <span class="o">=</span> <span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dynsys_obj</span> <span class="o">=</span> <span class="n">dynsys_obj</span>
        
        <span class="c1"># Call plot initialisation method of dynsys object</span>
        <span class="n">dynsys_obj</span><span class="o">.</span><span class="n">PlotSystem_init_plot</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        
        <span class="c1"># Overlay plot of loading, if avaliable</span>
        <span class="k">if</span> <span class="n">plot_loading</span><span class="p">:</span>
            
            <span class="n">attr</span> <span class="o">=</span> <span class="s1">&#39;analysis_obj&#39;</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">results_obj</span><span class="p">,</span><span class="n">attr</span><span class="p">):</span>
                
                <span class="n">analysis_obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">results_obj</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>
                <span class="n">loading_obj</span> <span class="o">=</span> <span class="n">analysis_obj</span><span class="o">.</span><span class="n">loading_obj</span>
                <span class="n">loading_obj</span><span class="o">.</span><span class="n">plot_init</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
                
            <span class="k">else</span><span class="p">:</span>
                <span class="n">loading_obj</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="n">plot_loading</span> <span class="o">=</span> <span class="bp">False</span> <span class="c1"># cannot plot loading</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Warning: could not plot loading&quot;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_loading</span> <span class="o">=</span> <span class="n">plot_loading</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Boolean, denotes whether loading should be overlaid onto plots</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">loading_obj</span> <span class="o">=</span> <span class="n">loading_obj</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loading object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        
        <span class="c1"># Set y scale for plot</span>
        <span class="k">if</span>  <span class="n">y_lim</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            
            <span class="c1"># Attempt to determine appropriate y limits</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">results_obj</span><span class="o">.</span><span class="n">v</span>
            <span class="n">y_absmax</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
            <span class="n">y_lim</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.2</span><span class="o">*</span><span class="n">npy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">y_absmax</span><span class="p">,</span><span class="o">+</span><span class="n">y_absmax</span><span class="p">]))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y_lim</span><span class="p">)</span>
        
        <span class="c1"># Determine appropriate scale for loading in plot</span>
        <span class="k">if</span> <span class="n">plot_loading</span> <span class="ow">and</span> <span class="n">load_scale</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            
            <span class="n">loadVals</span> <span class="o">=</span> <span class="n">loading_obj</span><span class="o">.</span><span class="n">loadVals</span>
            
            <span class="n">max_load</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">loadVals</span><span class="p">))</span>
            <span class="n">load_scale</span> <span class="o">=</span> <span class="n">load_scale_relative</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">max_load</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">load_scale</span> <span class="o">=</span> <span class="n">load_scale</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scale factor used to convert load units (N) to distance (m)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># ----------------------------------------------------------</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Displacement results</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> 
                     <span class="s2">&quot;Analysis: &#39;</span><span class="si">%s</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">tstep_obj</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> 
                     <span class="s2">&quot;System: &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">dynsys_obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">time_template</span> <span class="o">=</span> <span class="n">time_template</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_text</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">*</span><span class="n">time_text_loc</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
        

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Animation plot update method, for results time step (frame) `i`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">results_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results_obj</span>
        
        
        <span class="c1"># Get results applicable to this time increment</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results_obj</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results_obj</span><span class="o">.</span><span class="n">v</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span>
        
        <span class="c1"># Call plot update method of dynsys object</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">PlotSystem_update_plot</span><span class="p">(</span><span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
        
        <span class="c1"># Overlay plot of loading, if avaliable</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_loading</span><span class="p">:</span>
            
            <span class="n">analysis_obj</span> <span class="o">=</span> <span class="n">results_obj</span><span class="o">.</span><span class="n">analysis_obj</span>
            <span class="n">loading_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loading_obj</span>
            <span class="n">load_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_scale</span>
            
            <span class="n">load_velocity</span> <span class="o">=</span> <span class="n">analysis_obj</span><span class="o">.</span><span class="n">loadVel</span>
            
            <span class="n">load_lines</span> <span class="o">=</span> <span class="n">loading_obj</span><span class="o">.</span><span class="n">plot_update</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span><span class="n">lead_x</span><span class="o">=</span><span class="n">load_velocity</span><span class="o">*</span><span class="n">t</span><span class="p">,</span>
                                                 <span class="n">load_scale</span><span class="o">=</span><span class="n">load_scale</span><span class="p">)</span>
            <span class="n">lines</span><span class="p">[</span><span class="s1">&#39;load_lines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">load_lines</span>
                        
        <span class="c1"># Update time caption</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_template</span> <span class="o">%</span> <span class="p">(</span><span class="n">t</span><span class="p">))</span>
        
        <span class="k">return</span> <span class="n">lines</span>
    
    
    
<span class="k">class</span> <span class="nc">TimeSeries_Results</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to act as container for time series results, with methods to compute </span>
<span class="sd">    statistics etc</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">names</span><span class="p">,</span><span class="n">values</span><span class="p">,</span><span class="n">tstep_results_obj</span><span class="p">,</span>
                 <span class="n">location_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">plot_options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;use_common_scale&#39;</span> <span class="p">:</span><span class="bp">True</span><span class="p">}</span>
                 <span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">names</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tstep_results_obj</span> <span class="o">=</span> <span class="n">tstep_results_obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">location_obj</span> <span class="o">=</span> <span class="n">location_obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_options</span> <span class="o">=</span> <span class="n">plot_options</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">dynsys_obj</span> <span class="o">=</span> <span class="n">tstep_results_obj</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_stats_dict</span> <span class="o">=</span> <span class="bp">None</span>
        
        
    <span class="c1"># ----------------</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of names of defined responses</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names</span>
    
    <span class="nd">@names.setter</span>
    <span class="k">def</span> <span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_names</span> <span class="o">=</span> <span class="n">value</span>
    
    <span class="c1"># ----------------</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Time series results</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span>
    
    <span class="nd">@values.setter</span>
    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">value</span>
        
    <span class="c1"># ----------------</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">location_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Location object to which results relate</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_location_obj</span>
    
    <span class="nd">@location_obj.setter</span>
    <span class="k">def</span> <span class="nf">location_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">check_is_class</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_location_obj</span> <span class="o">=</span> <span class="n">obj</span>
        
    <span class="c1"># ----------------</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dict containing statistics dervied from time series results</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stats_dict</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calc_stats</span><span class="p">()</span>
            
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stats_dict</span>
    
    <span class="c1"># Note no setter method - cannot set stats directly!</span>
    <span class="c1"># ----------------</span>
        
    <span class="k">def</span> <span class="nf">calc_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate basis statistics to summarise time series results</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">vals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span>
        
        <span class="c1"># Record stats within a dict</span>
        <span class="n">stats_dict</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">stats_dict</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">stats_dict</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">stats_dict</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">stats_dict</span><span class="p">[</span><span class="s2">&quot;std&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">stats_dict</span><span class="p">[</span><span class="s2">&quot;absmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">_stats_dict</span> <span class="o">=</span> <span class="n">stats_dict</span>
        
        <span class="k">return</span> <span class="n">stats_dict</span>
    
    
   
    
    
    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">axarr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots time series results along with related stats</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">tstep_results_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_results_obj</span>
        <span class="n">tstep_obj</span> <span class="o">=</span> <span class="n">tstep_results_obj</span><span class="o">.</span><span class="n">tstep_obj</span>
        
        <span class="n">nResponses</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">axarr</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nResponses</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="c1"># Get plot options</span>
        <span class="n">use_common_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_options</span><span class="p">[</span><span class="s1">&#39;use_common_scale&#39;</span><span class="p">]</span>
        
        <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;plot_stats&#39;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_options</span><span class="p">,</span><span class="n">attr</span><span class="p">):</span>
            <span class="n">plot_stats</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_options</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plot_stats</span> <span class="o">=</span> <span class="bp">False</span>
        
        <span class="c1"># Get time values and time interval</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">tstep_results_obj</span><span class="o">.</span><span class="n">t</span>
        <span class="n">tInterval</span><span class="o">=</span> <span class="p">[</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">tStart</span><span class="p">,</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">tEnd</span><span class="p">]</span>
        
        <span class="c1"># Determine common scale to use for plots</span>
        
        
        <span class="k">if</span> <span class="n">use_common_scale</span><span class="p">:</span>
            
            <span class="n">maxVal</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
            <span class="n">minVal</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
            <span class="n">absmaxVal</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">maxVal</span><span class="p">,</span><span class="n">minVal</span><span class="p">])</span>
            
        <span class="c1"># Loop through plotting all responses</span>
        
        <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)):</span>
            
            <span class="c1"># Get axis object</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">axarr</span><span class="p">,</span> <span class="s2">&quot;__len__&quot;</span><span class="p">):</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span>
                        
            <span class="c1"># Make time series plot</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">vals</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">plot_stats</span><span class="p">:</span>
                <span class="c1"># Overlay stats if avaliable</span>
                <span class="n">stats_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span>
                
                <span class="k">if</span> <span class="n">stats_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">stats_dict</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">][</span><span class="n">r</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">stats_dict</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">][</span><span class="n">r</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">stats_dict</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">][</span><span class="n">r</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
                                   
            <span class="c1"># Set axis limits and labels</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">tInterval</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="n">nResponses</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">use_common_scale</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="n">absmaxVal</span><span class="p">,</span><span class="o">+</span><span class="n">absmaxVal</span><span class="p">])</span>
            
            <span class="c1"># Create legend</span>
            <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
                
        <span class="k">return</span> <span class="n">fig</span>
        
    
    <span class="k">def</span> <span class="nf">plot_psd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="c1"># Create figure</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
        
        <span class="c1"># Time series plot</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_results_obj</span><span class="o">.</span><span class="n">t</span>
        <span class="n">responses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span>
        <span class="n">response_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span>
        
        <span class="n">handles</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">responses</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">npy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">t</span><span class="p">)])</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Response time series&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (secs)&quot;</span><span class="p">)</span>
        
        <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span><span class="n">response_names</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
        
        <span class="c1"># PSD plot</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">dt</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">periodogram</span><span class="p">(</span><span class="n">responses</span><span class="p">,</span><span class="n">fs</span><span class="p">)</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">Pxx</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">fs</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Periodograms of responses&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency (Hz)&quot;</span><span class="p">)</span>
        
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;System: &#39;{0}&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        
        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>        <span class="c1"># create space for suptitle</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>      <span class="c1"># create space for figlegend</span>
        
        <span class="k">return</span> <span class="n">fig</span>
        
        
</pre></div>

  </div>

  </header>

  <section id="section-items">
    <h2 class="section-title" id="header-variables">Module variables</h2>
      <div class="item">
      <p id="tstep_results.currentVersion" class="name">var <span class="ident">currentVersion</span></p>
      
  
  <div class="source_cont">
</div>

      </div>


    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="tstep_results.SysPlot" class="name">class <span class="ident">SysPlot</span></p>
      
  
    <div class="desc"><p>Class to faciliate animation of displacement results 
as held in <code>tstep_results</code></p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.SysPlot', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.SysPlot" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">SysPlot</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to faciliate animation of displacement results </span>
<span class="sd">    as held in `tstep_results`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">results_obj</span><span class="p">,</span>
                 <span class="n">y_lim</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">plot_loading</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                 <span class="n">load_scale</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">load_scale_relative</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                 <span class="n">time_template</span> <span class="o">=</span> <span class="s1">&#39;Time = </span><span class="si">%.2f</span><span class="s1">s&#39;</span><span class="p">,</span>
                 <span class="n">time_text_loc</span><span class="o">=</span><span class="p">(</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">),):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Animation plot initialisation method</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Required:</span>
<span class="sd">            </span>
<span class="sd">        * `ax`, axes to plot to</span>
<span class="sd">        </span>
<span class="sd">        * `results_obj`, instance of `tstep_results` class</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Optional:</span>
<span class="sd">        </span>
<span class="sd">        * `time_text_loc`, tuple, defines location of time caption</span>
<span class="sd">        </span>
<span class="sd">        * `time_template`, string, text for time caption</span>
<span class="sd">        </span>
<span class="sd">        * `load_scale`, factor used to convert loads (N) to distances (m). If </span>
<span class="sd">          _None_ (default) then `load_scale` will be set as proportion of </span>
<span class="sd">           vertical scale according to `load_scale_relative`</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Get objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_obj</span> <span class="o">=</span> <span class="n">results_obj</span>
        
        <span class="c1"># Get dynamic system object</span>
        <span class="n">tstep_obj</span> <span class="o">=</span> <span class="n">results_obj</span><span class="o">.</span><span class="n">tstep_obj</span>
        <span class="n">dynsys_obj</span> <span class="o">=</span> <span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dynsys_obj</span> <span class="o">=</span> <span class="n">dynsys_obj</span>
        
        <span class="c1"># Call plot initialisation method of dynsys object</span>
        <span class="n">dynsys_obj</span><span class="o">.</span><span class="n">PlotSystem_init_plot</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        
        <span class="c1"># Overlay plot of loading, if avaliable</span>
        <span class="k">if</span> <span class="n">plot_loading</span><span class="p">:</span>
            
            <span class="n">attr</span> <span class="o">=</span> <span class="s1">&#39;analysis_obj&#39;</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">results_obj</span><span class="p">,</span><span class="n">attr</span><span class="p">):</span>
                
                <span class="n">analysis_obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">results_obj</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>
                <span class="n">loading_obj</span> <span class="o">=</span> <span class="n">analysis_obj</span><span class="o">.</span><span class="n">loading_obj</span>
                <span class="n">loading_obj</span><span class="o">.</span><span class="n">plot_init</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
                
            <span class="k">else</span><span class="p">:</span>
                <span class="n">loading_obj</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="n">plot_loading</span> <span class="o">=</span> <span class="bp">False</span> <span class="c1"># cannot plot loading</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Warning: could not plot loading&quot;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_loading</span> <span class="o">=</span> <span class="n">plot_loading</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Boolean, denotes whether loading should be overlaid onto plots</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">loading_obj</span> <span class="o">=</span> <span class="n">loading_obj</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loading object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        
        <span class="c1"># Set y scale for plot</span>
        <span class="k">if</span>  <span class="n">y_lim</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            
            <span class="c1"># Attempt to determine appropriate y limits</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">results_obj</span><span class="o">.</span><span class="n">v</span>
            <span class="n">y_absmax</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
            <span class="n">y_lim</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.2</span><span class="o">*</span><span class="n">npy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">y_absmax</span><span class="p">,</span><span class="o">+</span><span class="n">y_absmax</span><span class="p">]))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y_lim</span><span class="p">)</span>
        
        <span class="c1"># Determine appropriate scale for loading in plot</span>
        <span class="k">if</span> <span class="n">plot_loading</span> <span class="ow">and</span> <span class="n">load_scale</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            
            <span class="n">loadVals</span> <span class="o">=</span> <span class="n">loading_obj</span><span class="o">.</span><span class="n">loadVals</span>
            
            <span class="n">max_load</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">loadVals</span><span class="p">))</span>
            <span class="n">load_scale</span> <span class="o">=</span> <span class="n">load_scale_relative</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">max_load</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">load_scale</span> <span class="o">=</span> <span class="n">load_scale</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scale factor used to convert load units (N) to distance (m)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># ----------------------------------------------------------</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Displacement results</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> 
                     <span class="s2">&quot;Analysis: &#39;</span><span class="si">%s</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">tstep_obj</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> 
                     <span class="s2">&quot;System: &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">dynsys_obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">time_template</span> <span class="o">=</span> <span class="n">time_template</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_text</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">*</span><span class="n">time_text_loc</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
        

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Animation plot update method, for results time step (frame) `i`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">results_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results_obj</span>
        
        
        <span class="c1"># Get results applicable to this time increment</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results_obj</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results_obj</span><span class="o">.</span><span class="n">v</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span>
        
        <span class="c1"># Call plot update method of dynsys object</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">PlotSystem_update_plot</span><span class="p">(</span><span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
        
        <span class="c1"># Overlay plot of loading, if avaliable</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_loading</span><span class="p">:</span>
            
            <span class="n">analysis_obj</span> <span class="o">=</span> <span class="n">results_obj</span><span class="o">.</span><span class="n">analysis_obj</span>
            <span class="n">loading_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loading_obj</span>
            <span class="n">load_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_scale</span>
            
            <span class="n">load_velocity</span> <span class="o">=</span> <span class="n">analysis_obj</span><span class="o">.</span><span class="n">loadVel</span>
            
            <span class="n">load_lines</span> <span class="o">=</span> <span class="n">loading_obj</span><span class="o">.</span><span class="n">plot_update</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span><span class="n">lead_x</span><span class="o">=</span><span class="n">load_velocity</span><span class="o">*</span><span class="n">t</span><span class="p">,</span>
                                                 <span class="n">load_scale</span><span class="o">=</span><span class="n">load_scale</span><span class="p">)</span>
            <span class="n">lines</span><span class="p">[</span><span class="s1">&#39;load_lines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">load_lines</span>
                        
        <span class="c1"># Update time caption</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_template</span> <span class="o">%</span> <span class="p">(</span><span class="n">t</span><span class="p">))</span>
        
        <span class="k">return</span> <span class="n">lines</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#tstep_results.SysPlot">SysPlot</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="tstep_results.SysPlot.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, ax, results_obj, y_lim=None, plot_loading=True, load_scale=None, load_scale_relative=0.3, time_template=&#39;Time = %.2fs&#39;, time_text_loc=(0.85, 0.95))</p>
    </div>
    

    
  
    <div class="desc"><p>Animation plot initialisation method</p>
<hr />
<p>Required:</p>
<ul>
<li>
<p><code>ax</code>, axes to plot to</p>
</li>
<li>
<p><code>results_obj</code>, instance of <code>tstep_results</code> class</p>
</li>
</ul>
<hr />
<p>Optional:</p>
<ul>
<li>
<p><code>time_text_loc</code>, tuple, defines location of time caption</p>
</li>
<li>
<p><code>time_template</code>, string, text for time caption</p>
</li>
<li>
<p><code>load_scale</code>, factor used to convert loads (N) to distances (m). If 
  <em>None</em> (default) then <code>load_scale</code> will be set as proportion of 
   vertical scale according to <code>load_scale_relative</code></p>
</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.SysPlot.__init__', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.SysPlot.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">results_obj</span><span class="p">,</span>
             <span class="n">y_lim</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">plot_loading</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
             <span class="n">load_scale</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">load_scale_relative</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
             <span class="n">time_template</span> <span class="o">=</span> <span class="s1">&#39;Time = </span><span class="si">%.2f</span><span class="s1">s&#39;</span><span class="p">,</span>
             <span class="n">time_text_loc</span><span class="o">=</span><span class="p">(</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">),):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Animation plot initialisation method</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    Required:</span>
<span class="sd">        </span>
<span class="sd">    * `ax`, axes to plot to</span>
<span class="sd">    </span>
<span class="sd">    * `results_obj`, instance of `tstep_results` class</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    Optional:</span>
<span class="sd">    </span>
<span class="sd">    * `time_text_loc`, tuple, defines location of time caption</span>
<span class="sd">    </span>
<span class="sd">    * `time_template`, string, text for time caption</span>
<span class="sd">    </span>
<span class="sd">    * `load_scale`, factor used to convert loads (N) to distances (m). If </span>
<span class="sd">      _None_ (default) then `load_scale` will be set as proportion of </span>
<span class="sd">       vertical scale according to `load_scale_relative`</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Get objects</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">results_obj</span> <span class="o">=</span> <span class="n">results_obj</span>
    
    <span class="c1"># Get dynamic system object</span>
    <span class="n">tstep_obj</span> <span class="o">=</span> <span class="n">results_obj</span><span class="o">.</span><span class="n">tstep_obj</span>
    <span class="n">dynsys_obj</span> <span class="o">=</span> <span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dynsys_obj</span> <span class="o">=</span> <span class="n">dynsys_obj</span>
    
    <span class="c1"># Call plot initialisation method of dynsys object</span>
    <span class="n">dynsys_obj</span><span class="o">.</span><span class="n">PlotSystem_init_plot</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    
    <span class="c1"># Overlay plot of loading, if avaliable</span>
    <span class="k">if</span> <span class="n">plot_loading</span><span class="p">:</span>
        
        <span class="n">attr</span> <span class="o">=</span> <span class="s1">&#39;analysis_obj&#39;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">results_obj</span><span class="p">,</span><span class="n">attr</span><span class="p">):</span>
            
            <span class="n">analysis_obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">results_obj</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>
            <span class="n">loading_obj</span> <span class="o">=</span> <span class="n">analysis_obj</span><span class="o">.</span><span class="n">loading_obj</span>
            <span class="n">loading_obj</span><span class="o">.</span><span class="n">plot_init</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">loading_obj</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">plot_loading</span> <span class="o">=</span> <span class="bp">False</span> <span class="c1"># cannot plot loading</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Warning: could not plot loading&quot;</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">plot_loading</span> <span class="o">=</span> <span class="n">plot_loading</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Boolean, denotes whether loading should be overlaid onto plots</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">loading_obj</span> <span class="o">=</span> <span class="n">loading_obj</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loading object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    
    <span class="c1"># Set y scale for plot</span>
    <span class="k">if</span>  <span class="n">y_lim</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        
        <span class="c1"># Attempt to determine appropriate y limits</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">results_obj</span><span class="o">.</span><span class="n">v</span>
        <span class="n">y_absmax</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
        <span class="n">y_lim</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.2</span><span class="o">*</span><span class="n">npy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">y_absmax</span><span class="p">,</span><span class="o">+</span><span class="n">y_absmax</span><span class="p">]))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y_lim</span><span class="p">)</span>
    
    <span class="c1"># Determine appropriate scale for loading in plot</span>
    <span class="k">if</span> <span class="n">plot_loading</span> <span class="ow">and</span> <span class="n">load_scale</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        
        <span class="n">loadVals</span> <span class="o">=</span> <span class="n">loading_obj</span><span class="o">.</span><span class="n">loadVals</span>
        
        <span class="n">max_load</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">loadVals</span><span class="p">))</span>
        <span class="n">load_scale</span> <span class="o">=</span> <span class="n">load_scale_relative</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">max_load</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">load_scale</span> <span class="o">=</span> <span class="n">load_scale</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Scale factor used to convert load units (N) to distance (m)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># ----------------------------------------------------------</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Displacement results</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> 
                 <span class="s2">&quot;Analysis: &#39;</span><span class="si">%s</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">tstep_obj</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> 
                 <span class="s2">&quot;System: &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">dynsys_obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">time_template</span> <span class="o">=</span> <span class="n">time_template</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">time_text</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">*</span><span class="n">time_text_loc</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                             <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.SysPlot.update">
    <p>def <span class="ident">update</span>(</p><p>self, i)</p>
    </div>
    

    
  
    <div class="desc"><p>Animation plot update method, for results time step (frame) <code>i</code></p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.SysPlot.update', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.SysPlot.update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Animation plot update method, for results time step (frame) `i`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">results_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results_obj</span>
    
    
    <span class="c1"># Get results applicable to this time increment</span>
    <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results_obj</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results_obj</span><span class="o">.</span><span class="n">v</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span>
    
    <span class="c1"># Call plot update method of dynsys object</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">PlotSystem_update_plot</span><span class="p">(</span><span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
    
    <span class="c1"># Overlay plot of loading, if avaliable</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_loading</span><span class="p">:</span>
        
        <span class="n">analysis_obj</span> <span class="o">=</span> <span class="n">results_obj</span><span class="o">.</span><span class="n">analysis_obj</span>
        <span class="n">loading_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loading_obj</span>
        <span class="n">load_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_scale</span>
        
        <span class="n">load_velocity</span> <span class="o">=</span> <span class="n">analysis_obj</span><span class="o">.</span><span class="n">loadVel</span>
        
        <span class="n">load_lines</span> <span class="o">=</span> <span class="n">loading_obj</span><span class="o">.</span><span class="n">plot_update</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span><span class="n">lead_x</span><span class="o">=</span><span class="n">load_velocity</span><span class="o">*</span><span class="n">t</span><span class="p">,</span>
                                             <span class="n">load_scale</span><span class="o">=</span><span class="n">load_scale</span><span class="p">)</span>
        <span class="n">lines</span><span class="p">[</span><span class="s1">&#39;load_lines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">load_lines</span>
                    
    <span class="c1"># Update time caption</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">time_text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_template</span> <span class="o">%</span> <span class="p">(</span><span class="n">t</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">lines</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="tstep_results.SysPlot.dynsys_obj" class="name">var <span class="ident">dynsys_obj</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.SysPlot.load_scale" class="name">var <span class="ident">load_scale</span></p>
            

            
  
    <div class="desc"><p>Scale factor used to convert load units (N) to distance (m)</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.SysPlot.loading_obj" class="name">var <span class="ident">loading_obj</span></p>
            

            
  
    <div class="desc"><p>Loading object</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.SysPlot.plot_loading" class="name">var <span class="ident">plot_loading</span></p>
            

            
  
    <div class="desc"><p>Boolean, denotes whether loading should be overlaid onto plots</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.SysPlot.results_obj" class="name">var <span class="ident">results_obj</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.SysPlot.time_template" class="name">var <span class="ident">time_template</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.SysPlot.time_text" class="name">var <span class="ident">time_text</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="tstep_results.TStep_Results" class="name">class <span class="ident">TStep_Results</span></p>
      
  
    <div class="desc"><p>Class used to store, manipulate and plot results from time-stepping 
analysis as carried out by <code>TStep</code></p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">TStep_Results</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class used to store, manipulate and plot results from time-stepping </span>
<span class="sd">    analysis as carried out by `TStep`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># ********** CONSTRUCTOR / DESTRUCTOR ******************</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">tstep_obj</span><span class="p">,</span>
                 <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;calc_dof_stats&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                          <span class="s1">&#39;calc_response_stats&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                          <span class="s1">&#39;retain_dof_values&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                          <span class="s1">&#39;retain_response_values&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
                 <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialisation function</span>
<span class="sd">        ***</span>
<span class="sd">        </span>
<span class="sd">        Required:</span>
<span class="sd">        </span>
<span class="sd">        * `tstep_obj`, `TStep()` class instance to which results relate</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Optional</span>
<span class="sd">        </span>
<span class="sd">        * `options` _dict_, with the following as boolean entries:</span>
<span class="sd">        </span>
<span class="sd">            * `calc_DOF_stats`, if True statistics will be calculated, to </span>
<span class="sd">              summarise time series results for DOF variables</span>
<span class="sd">            </span>
<span class="sd">            * `calc_response_stats`, if True statistics will be calculated, to </span>
<span class="sd">              summarise time series results for response variables</span>
<span class="sd">              </span>
<span class="sd">            * `retain_DOF_values`, if False DOF time series results will be </span>
<span class="sd">              deleted once summary statistics have been computed</span>
<span class="sd">                         </span>
<span class="sd">            * `retain_response_values`, if False response time series results </span>
<span class="sd">              will be deleted once summary statistics have been computed</span>
<span class="sd">          </span>
<span class="sd">            Choosing _False_ for the above can be done to be more economical </span>
<span class="sd">            with memory usage, for example when carrying out multiple analyses. </span>
<span class="sd">            Note that providing DOF time series are retained, responses can </span>
<span class="sd">            always be re-calculated using `calc_responses()` method</span>
<span class="sd">        &quot;&quot;&quot;</span>
                
        <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span><span class="o">=</span><span class="mi">0</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">=</span><span class="n">tstep_obj</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance of `tstep` class, to which results relate</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">DynSys_list</span> <span class="o">=</span> <span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">DynSys_list</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of DynSys objects to which results held by this object relate</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">response_results</span><span class="o">=</span><span class="p">[]</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of matrices to which computed responses are recorded </span>
<span class="sd">        for each time step</span>
<span class="sd">        &quot;&quot;&quot;</span>
                
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">options</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dict containing options - refer __init__() docstring for details</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">dof_stats</span><span class="o">=</span><span class="bp">None</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dict of statistics, evaluated over all time steps, for each DOF</span>
<span class="sd">        </span>
<span class="sd">        _Set using `CalcDOFStats()`_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
    <span class="c1"># -----------------GETTER / SETTER FUNCTIONS FOR PROPERTIES ---------------    </span>
                
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nDOF</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of degrees of freedom for system being analysed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nDOF</span>
    
    <span class="nd">@nDOF.setter</span>
    <span class="k">def</span> <span class="nf">nDOF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nDOF</span> <span class="o">=</span> <span class="n">value</span>
        
    <span class="c1"># ---------------</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">t</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Time values for each results time step</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_t</span>
        
    <span class="nd">@t.setter</span>
    <span class="k">def</span> <span class="nf">t</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">values</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_t</span> <span class="o">=</span> <span class="n">values</span>
        
    <span class="c1"># ---------------</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        External applied forces</span>
<span class="sd">        </span>
<span class="sd">        Returns matrix of shape [nSteps,nDOF]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_obj</span>
        
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">values</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">f_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns `TimeSeries_Results()` instance used to internally implement</span>
<span class="sd">        `f`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_force_results</span>
    
    <span class="nd">@f.setter</span>
    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">values</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_force_results</span> <span class="o">=</span> <span class="bp">None</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nDOF</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">nDOF</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">nDOF</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Inconsistent nDOF!&quot;</span><span class="p">)</span>
            
            <span class="n">obj</span> <span class="o">=</span> <span class="n">TimeSeries_Results</span><span class="p">(</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;f</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">n</span> 
                                              <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nDOF</span><span class="p">)],</span>
                                     <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="p">,</span>
                                     <span class="n">tstep_results_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="p">,</span>
                                     <span class="n">plot_options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;use_common_plot&#39;</span> <span class="p">:</span><span class="bp">True</span><span class="p">})</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_force_results</span> <span class="o">=</span> <span class="n">obj</span>
        
    <span class="c1"># ---------------</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">v</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Displacements of analysis DOFs</span>
<span class="sd">        </span>
<span class="sd">        Returns matrix of shape [nSteps,nDOF]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_obj</span>
        
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">values</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">v_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns `TimeSeries_Results()` instance used to internally implement</span>
<span class="sd">        `v`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_disp_results</span>
    
    <span class="nd">@v.setter</span>
    <span class="k">def</span> <span class="nf">v</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">values</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_disp_results</span> <span class="o">=</span> <span class="bp">None</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nDOF</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">nDOF</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">nDOF</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Inconsistent nDOF!&quot;</span><span class="p">)</span>
            
            <span class="n">obj</span> <span class="o">=</span> <span class="n">TimeSeries_Results</span><span class="p">(</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$y_{</span><span class="si">%d</span><span class="s2">}$&quot;</span> <span class="o">%</span> <span class="n">n</span> 
                                              <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nDOF</span><span class="p">)],</span>
                                     <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="p">,</span>
                                     <span class="n">tstep_results_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="p">,</span>
                                     <span class="n">plot_options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;use_common_plot&#39;</span> <span class="p">:</span><span class="bp">True</span><span class="p">})</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_disp_results</span> <span class="o">=</span> <span class="n">obj</span>
        
    <span class="c1"># ---------------</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vdot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Velocities of analysis DOFs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vdot_obj</span>
        
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">values</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vdot_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns `TimeSeries_Results()` instance used to internally implement</span>
<span class="sd">        `vdot`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_velocity_results</span>
    
    <span class="nd">@vdot.setter</span>
    <span class="k">def</span> <span class="nf">vdot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">values</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_velocity_results</span> <span class="o">=</span> <span class="bp">None</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nDOF</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">nDOF</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">nDOF</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Inconsistent nDOF!&quot;</span><span class="p">)</span>
            
            <span class="n">obj</span> <span class="o">=</span> <span class="n">TimeSeries_Results</span><span class="p">(</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$\dot{v}_{</span><span class="si">%d</span><span class="s2">}$&quot;</span> <span class="o">%</span> <span class="n">n</span>
                                              <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nDOF</span><span class="p">)],</span>
                                     <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="p">,</span>
                                     <span class="n">tstep_results_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="p">,</span>
                                     <span class="n">plot_options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;use_common_plot&#39;</span> <span class="p">:</span><span class="bp">True</span><span class="p">})</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_velocity_results</span> <span class="o">=</span> <span class="n">obj</span>
        
    <span class="c1"># ---------------</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">v2dot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Accelerations of analysis DOFs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v2dot_obj</span>
        
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">values</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">v2dot_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns `TimeSeries_Results()` instance used to internally implement</span>
<span class="sd">        `v2dot`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accn_results</span>
    
    <span class="nd">@v2dot.setter</span>
    <span class="k">def</span> <span class="nf">v2dot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">values</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_accn_results</span> <span class="o">=</span> <span class="bp">None</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nDOF</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">nDOF</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">nDOF</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Inconsistent nDOF!&quot;</span><span class="p">)</span>
            
            <span class="n">obj</span> <span class="o">=</span> <span class="n">TimeSeries_Results</span><span class="p">(</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$\ddot{v}_{</span><span class="si">%d</span><span class="s2">}$&quot;</span> <span class="o">%</span> <span class="n">n</span>
                                              <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nDOF</span><span class="p">)],</span>
                                     <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="p">,</span>
                                     <span class="n">tstep_results_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="p">,</span>
                                     <span class="n">plot_options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;use_common_plot&#39;</span> <span class="p">:</span><span class="bp">True</span><span class="p">})</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_accn_results</span> <span class="o">=</span> <span class="n">obj</span>
        
    <span class="c1"># ---------------</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">f_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal constraint forces</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_constraint_obj</span>
        
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">values</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">f_constraint_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns `TimeSeries_Results()` instance used to internally implement</span>
<span class="sd">        `f_constraint`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constraint_forces</span>
    
    <span class="nd">@f_constraint.setter</span>
    <span class="k">def</span> <span class="nf">f_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">values</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_constraint_forces</span> <span class="o">=</span> <span class="bp">None</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nDOF</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">nDOF</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">nDOF</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Inconsistent nDOF!&quot;</span><span class="p">)</span>
            
            <span class="n">obj</span> <span class="o">=</span> <span class="n">TimeSeries_Results</span><span class="p">(</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$f_{constraint,</span><span class="si">%d</span><span class="s2">}$&quot;</span> <span class="o">%</span> <span class="n">n</span>
                                              <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nDOF</span><span class="p">)],</span>
                                     <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="p">,</span>
                                     <span class="n">tstep_results_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="p">,</span>
                                     <span class="n">plot_options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;use_common_plot&#39;</span> <span class="p">:</span><span class="bp">True</span><span class="p">})</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_constraint_forces</span> <span class="o">=</span> <span class="n">obj</span>
    
    <span class="c1"># ---------------     </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nResults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of time-steps at which results are recorded</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nResults</span>
    
    <span class="nd">@nResults.setter</span>
    <span class="k">def</span> <span class="nf">nResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nResults</span> <span class="o">=</span> <span class="n">value</span>
     
    <span class="c1"># -------------------------------------------------------------------------</span>
    
    
    
    
        
        
    <span class="k">def</span> <span class="nf">ClearResults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clear all results from previous time-stepping analysis</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vdot</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v2dot</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_constraint</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span> <span class="o">=</span> <span class="mi">0</span>
        
        
    <span class="k">def</span> <span class="nf">RecordResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">vdot</span><span class="p">,</span><span class="n">v2dot</span><span class="p">,</span><span class="n">f_constraint</span><span class="p">,</span>
                      <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">append</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Used to record results from time-stepping analysis as implemented </span>
<span class="sd">        by `TStep().run()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="s1">&#39;__len__&#39;</span><span class="p">):</span>
            <span class="n">nResults</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nResults</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">append</span><span class="o">=</span><span class="bp">False</span> <span class="c1"># no results currently save</span>
                       
        <span class="k">if</span> <span class="n">append</span><span class="p">:</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">t</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vdot</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vdot</span><span class="p">,</span><span class="n">vdot</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v2dot</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2dot</span><span class="p">,</span><span class="n">v2dot</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f_constraint</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f_constraint</span><span class="p">,</span><span class="n">f_constraint</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            
        <span class="k">else</span><span class="p">:</span>
                                   
            <span class="bp">self</span><span class="o">.</span><span class="n">nDOF</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="o">=</span><span class="n">t</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">=</span><span class="n">f</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="o">=</span><span class="n">v</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vdot</span><span class="o">=</span><span class="n">vdot</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v2dot</span><span class="o">=</span><span class="n">v2dot</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f_constraint</span><span class="o">=</span><span class="n">f_constraint</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span> <span class="o">+=</span> <span class="n">nResults</span>
        
        
    <span class="k">def</span> <span class="nf">get_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dynsys_obj</span><span class="p">,</span><span class="n">attr_list</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves results for a given DynSys object, which is assumed to be a </span>
<span class="sd">        subsystem of the parent system (this is checked)</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Required:</span>
<span class="sd">            </span>
<span class="sd">        * `dynsys_obj`, instance of DynSys class; must be a subsystem of the </span>
<span class="sd">          parent system</span>
<span class="sd">          </span>
<span class="sd">        * `attr_list`, list of strings, to denote the results attributes to be </span>
<span class="sd">          returned</span>
<span class="sd">         </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Convert to list if single argument provided</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attr_list</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="n">attr_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">attr_list</span><span class="p">)</span>
        
        <span class="c1"># Check that dynsys_obj is part of the system that has been analysed</span>
        <span class="n">parent_sys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span>
        <span class="n">DynSys_list</span> <span class="o">=</span> <span class="n">parent_sys</span><span class="o">.</span><span class="n">DynSys_list</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">dynsys_obj</span> <span class="ow">in</span> <span class="n">DynSys_list</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`dynsys_obj` is not a subsystem &quot;</span> <span class="o">+</span> 
                             <span class="s2">&quot;of the parent system that has been analysed!&quot;</span><span class="p">)</span>
        
        <span class="c1"># Determine splice indices to use to get results relating to requested system </span>
        <span class="n">sys_index</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">DynSys_list</span><span class="p">)</span> <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">dynsys_obj</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="n">nDOF_list_cum</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">cumsum</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">nDOF</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">DynSys_list</span><span class="p">])</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">sys_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">startIndex</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">startIndex</span> <span class="o">=</span> <span class="n">nDOF_list_cum</span><span class="p">[</span><span class="n">sys_index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="n">endIndex</span> <span class="o">=</span> <span class="n">nDOF_list_cum</span><span class="p">[</span><span class="n">sys_index</span><span class="p">]</span> 
        
        <span class="c1"># Loop through to return requested attributes</span>
        <span class="n">vals_list</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attr_list</span><span class="p">:</span>
            
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">attr</span><span class="p">):</span>
                
                <span class="n">vals</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>             <span class="c1"># for full system</span>
                
                <span class="k">if</span> <span class="n">attr</span> <span class="o">!=</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span>
                    <span class="n">vals</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">startIndex</span><span class="p">:</span><span class="n">endIndex</span><span class="p">,:]</span>    <span class="c1"># for subsystem requested</span>
                
                <span class="n">vals_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
                
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not retrieve requested attribute &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">attr</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">vals_list</span>
        
    
    <span class="k">def</span> <span class="nf">_TimePlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ax</span><span class="p">,</span><span class="n">t_vals</span><span class="p">,</span><span class="n">data_vals</span><span class="p">,</span>
                  <span class="n">titleStr</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                  <span class="n">xlabelStr</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                  <span class="n">ylabelStr</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                  <span class="n">xlim</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                  <span class="n">showxticks</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                  <span class="n">data_labels</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Produces a time series results plot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">lines</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_vals</span><span class="p">,</span><span class="n">data_vals</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">titleStr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">titleStr</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">xlabelStr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabelStr</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">ylabelStr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabelStr</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="ow">not</span> <span class="n">showxticks</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
            
        <span class="k">return</span> <span class="n">lines</span>
        
    
    <span class="k">def</span> <span class="nf">PlotStateResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">deprecation_warning</span><span class="p">(</span><span class="s1">&#39;PlotStateResults&#39;</span><span class="p">,</span><span class="s1">&#39;plot_state_results&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_state_results</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
    
    <span class="k">def</span> <span class="nf">plot_state_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                           <span class="n">dynsys_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                           <span class="n">verbose</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Produces time series plots of the following, as subplots in a single </span>
<span class="sd">        figure:</span>
<span class="sd">            </span>
<span class="sd">        * Applied external forces</span>
<span class="sd">        </span>
<span class="sd">        * Displacements</span>
<span class="sd">        </span>
<span class="sd">        * Velocities</span>
<span class="sd">        </span>
<span class="sd">        * Accelerations</span>
<span class="sd">        </span>
<span class="sd">        * Constraint forces (only if constraint equations defined)</span>
<span class="sd">        </span>
<span class="sd">        Note all results plotted relate to the _analysis freedoms_.</span>
<span class="sd">        </span>
<span class="sd">        For systems composed of multiple subsystems, one figure will be </span>
<span class="sd">        produced for each subsystem.</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        ***</span>
<span class="sd">        **Optional:**</span>
<span class="sd">            </span>
<span class="sd">        * `dynsys_obj`, can be used to specify the subsystem for which results </span>
<span class="sd">          which should be plotted. If _None_ then results for all freedoms </span>
<span class="sd">          (i.e. all subsystems) will be plotted.</span>
<span class="sd">          </span>
<span class="sd">        * `verbose`, _boolean_, if True text will be written to console</span>
<span class="sd">          </span>
<span class="sd">        ***</span>
<span class="sd">        **Returns:**</span>
<span class="sd">        </span>
<span class="sd">        _List_ of figure objects</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Preparing state results plot...&quot;</span><span class="p">)</span>
            <span class="n">tic</span><span class="o">=</span><span class="n">timeit</span><span class="o">.</span><span class="n">default_timer</span><span class="p">()</span>
            
        <span class="c1"># Get subsystems to iterate over</span>
        <span class="n">DynSys_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">DynSys_list</span>
        <span class="k">if</span> <span class="n">dynsys_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">dynsys_obj</span> <span class="ow">in</span> <span class="n">DynSys_list</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`dynsys_obj` not in DynSys_list!&quot;</span><span class="p">)</span>
                
            <span class="n">DynSys_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">dynsys_obj</span><span class="p">]</span>
        
        <span class="c1"># Iterate over all subsystems, producing figure for each</span>
        <span class="n">fig_list</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">DynSys_list</span><span class="p">:</span>
            
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;   Plotting state results for &#39;</span><span class="si">%s</span><span class="s2">&#39;...&quot;</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

            <span class="c1"># Determine number of subplots required</span>
            <span class="n">hasConstraints</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">hasConstraints</span><span class="p">()</span>
            
            <span class="k">if</span> <span class="n">hasConstraints</span><span class="p">:</span>
                <span class="n">nPltRows</span><span class="o">=</span><span class="mi">5</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nPltRows</span><span class="o">=</span><span class="mi">4</span>
                
            <span class="c1"># Create plot of results for analysis DOFs</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nPltRows</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
            <span class="n">fig_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        
            <span class="c1"># Set xlim</span>
            <span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">tStart</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">tEnd</span><span class="p">]</span>
            
            <span class="c1"># Get system description string</span>
            <span class="n">sysStr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">DynSys_list</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">DynSys_list</span>
            
            <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">isModal</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">DynSys_list</span><span class="p">]):</span>
                <span class="c1"># All systems and subsystems are modal</span>
                <span class="n">sysStr</span> <span class="o">=</span> <span class="s2">&quot;Modal &quot;</span>
                
             <span class="c1"># Get data to plot   </span>
            <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span>
            <span class="n">f</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">vdot</span><span class="p">,</span><span class="n">v2dot</span><span class="p">,</span><span class="n">f_constraint</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_results</span><span class="p">(</span><span class="n">obj</span><span class="p">,[</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;v&#39;</span><span class="p">,</span>
                                                               <span class="s1">&#39;vdot&#39;</span><span class="p">,</span><span class="s1">&#39;v2dot&#39;</span><span class="p">,</span>
                                                               <span class="s1">&#39;f_constraint&#39;</span><span class="p">])</span>

            
            <span class="c1"># Create time series plots</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_TimePlot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                           <span class="n">t_vals</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
                           <span class="n">data_vals</span><span class="o">=</span><span class="n">f</span><span class="p">,</span>
                           <span class="n">xlim</span><span class="o">=</span><span class="n">xlim</span><span class="p">,</span>
                           <span class="n">titleStr</span><span class="o">=</span><span class="s2">&quot;Applied </span><span class="si">%s</span><span class="s2">Forces (N)&quot;</span> <span class="o">%</span> <span class="n">sysStr</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_TimePlot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                           <span class="n">t_vals</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
                           <span class="n">data_vals</span><span class="o">=</span><span class="n">v</span><span class="p">,</span>
                           <span class="n">titleStr</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Displacements (m)&quot;</span> <span class="o">%</span> <span class="n">sysStr</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_TimePlot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                           <span class="n">t_vals</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
                           <span class="n">data_vals</span><span class="o">=</span><span class="n">vdot</span><span class="p">,</span>
                           <span class="n">titleStr</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Velocities (m/s)&quot;</span> <span class="o">%</span> <span class="n">sysStr</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_TimePlot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                           <span class="n">t_vals</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
                           <span class="n">data_vals</span><span class="o">=</span><span class="n">v2dot</span><span class="p">,</span>
                           <span class="n">titleStr</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Accelerations ($m/s^2$)&quot;</span> <span class="o">%</span> <span class="n">sysStr</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">hasConstraints</span><span class="p">:</span>
                
                <span class="bp">self</span><span class="o">.</span><span class="n">_TimePlot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
                           <span class="n">t_vals</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
                           <span class="n">data_vals</span><span class="o">=</span><span class="n">f_constraint</span><span class="p">,</span>
                           <span class="n">titleStr</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Constraint forces (N)&quot;</span> <span class="o">%</span> <span class="n">sysStr</span><span class="p">)</span>
                
            <span class="n">axarr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (secs)&quot;</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
            
            <span class="c1"># Overall title for plot</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;State variable results for &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="n">toc</span><span class="o">=</span><span class="n">timeit</span><span class="o">.</span><span class="n">default_timer</span><span class="p">()</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Plot prepared after </span><span class="si">%.3f</span><span class="s2"> seconds.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">toc</span><span class="o">-</span><span class="n">tic</span><span class="p">))</span>
            
        <span class="k">return</span> <span class="n">fig_list</span>
    
    
    <span class="k">def</span> <span class="nf">PlotResponseResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">deprecation_warning</span><span class="p">(</span><span class="s1">&#39;PlotResponseResults&#39;</span><span class="p">,</span><span class="s1">&#39;plot_response_results&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_response_results</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
    
    <span class="k">def</span> <span class="nf">plot_response_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                              <span class="n">dynsys_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                              <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Produces a new figure with linked time series subplots for </span>
<span class="sd">        all responses/outputs</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        **Optional:**</span>
<span class="sd">            </span>
<span class="sd">        * `dynsys_obj`, can be used to specify the subsystem for which results </span>
<span class="sd">          which should be plotted. If _None_ then results for all freedoms </span>
<span class="sd">          (i.e. all subsystems) will be plotted.</span>
<span class="sd">          </span>
<span class="sd">        ***</span>
<span class="sd">        **Returns:**</span>
<span class="sd">         </span>
<span class="sd">        Nested list of figure objects</span>
<span class="sd">          </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Preparing response results plots...&quot;</span><span class="p">)</span>
            <span class="n">tic</span><span class="o">=</span><span class="n">timeit</span><span class="o">.</span><span class="n">default_timer</span><span class="p">()</span>
            
        <span class="c1"># Get subsystems to iterate over</span>
        <span class="n">DynSys_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DynSys_list</span>
        <span class="k">if</span> <span class="n">dynsys_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">dynsys_obj</span> <span class="ow">in</span> <span class="n">DynSys_list</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`dynsys_obj` not in DynSys_list!&quot;</span><span class="p">)</span>
                
            <span class="n">DynSys_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">dynsys_obj</span><span class="p">]</span>
    
        <span class="c1"># Iterate over all responses for all specified subsystems</span>
        
        <span class="n">fig_list</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Loop over all specified subsystems</span>
        <span class="k">for</span> <span class="n">dynsys_obj</span><span class="p">,</span> <span class="n">response_obj_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">DynSys_list</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">response_results</span><span class="p">):</span>
            
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;   Plotting responses results for &#39;{0}&#39;...&quot;</span>
                  <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            
            <span class="n">fig_list_inner</span> <span class="o">=</span> <span class="p">[]</span>
            
            <span class="c1"># Iterate over all responses for this subsystem</span>
            <span class="k">for</span> <span class="n">response_results_obj</span> <span class="ow">in</span> <span class="n">response_obj_list</span><span class="p">:</span>
                
                <span class="n">fig_list_inner</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">response_results_obj</span><span class="o">.</span><span class="n">plot</span><span class="p">())</span>
                
            <span class="n">fig_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig_list_inner</span><span class="p">)</span>
                
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="n">toc</span><span class="o">=</span><span class="n">timeit</span><span class="o">.</span><span class="n">default_timer</span><span class="p">()</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Plots prepared after </span><span class="si">%.3f</span><span class="s2"> seconds.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">toc</span><span class="o">-</span><span class="n">tic</span><span class="p">))</span>
            
        <span class="k">return</span> <span class="n">fig_list</span>
        
    
    <span class="k">def</span> <span class="nf">PlotResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="n">deprecation_warning</span><span class="p">(</span><span class="s1">&#39;PlotResults&#39;</span><span class="p">,</span><span class="s1">&#39;plot_results&#39;</span><span class="p">)</span>
    
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_results</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
    
    <span class="k">def</span> <span class="nf">plot_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                     <span class="n">dynsys_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                     <span class="n">verbose</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Presents the results of time-stepping analysis by producing the </span>
<span class="sd">        following plots:</span>
<span class="sd">        </span>
<span class="sd">        * State results plot: refer `PlotStateResults()`</span>
<span class="sd">        </span>
<span class="sd">        * Response results plot: refer `PlotResponseResults()`</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        **Optional:**</span>
<span class="sd">            </span>
<span class="sd">        * `dynsys_obj`, object specifying system whose results are to be </span>
<span class="sd">          plotted. If _None_ plots will be produced for all systems. </span>
<span class="sd">        </span>
<span class="sd">        * `verbose`, _boolean_, if True progress will be written to console</span>
<span class="sd">        </span>
<span class="sd">        * `dof2Plot`, _list_ of integers to denote DOFs to plot. Can be used to </span>
<span class="sd">          produce a &#39;cleaner&#39; plot, in case of large numbers of DOFs. Note will </span>
<span class="sd">          only work in conjunction with `dynsys_obj`, i.e. subsystem must also </span>
<span class="sd">          be selected</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        **Returns:**</span>
<span class="sd">        </span>
<span class="sd">        _List_ of figure objects</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">state_fig_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_state_results</span><span class="p">(</span><span class="n">dynsys_obj</span><span class="o">=</span><span class="n">dynsys_obj</span><span class="p">,</span>
                                                 <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        
        <span class="n">response_fig_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_response_results</span><span class="p">(</span><span class="n">dynsys_obj</span><span class="o">=</span><span class="n">dynsys_obj</span><span class="p">,</span>
                                                       <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">state_fig_list</span><span class="p">,</span> <span class="n">response_fig_list</span>
    
    
    <span class="k">def</span> <span class="nf">PlotResponsePSDs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nperseg</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Produces power spectral density plots of response time series</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Optional:</span>
<span class="sd">        </span>
<span class="sd">        * `nperseg`, length of each segment used in PSD calculation</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Plotting PSD estimates of responses using periodograms...&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response_results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No response time series data avaliable!&quot;</span><span class="p">)</span>
        
        <span class="c1"># Get sampling frequency</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dt</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`dt` is None: cannot calculate PSDs from &quot;</span>
                             <span class="s2">&quot;variable timestep time series&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fs</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dt</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Sampling frequency: fs = </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">fs</span><span class="p">)</span>
        
        <span class="c1"># Loop through all responses</span>
        <span class="n">fig_list</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">responses_list</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_results</span><span class="p">:</span>
            
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">responses_list</span><span class="p">:</span>
                
                <span class="n">fig_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">plot_psd</span><span class="p">())</span>
        
        <span class="k">return</span> <span class="n">fig_list</span>
    

    <span class="k">def</span> <span class="nf">PlotDeformed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">timestep_index</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span><span class="n">dynsys_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Produce a plot of system in its deformed configuration, as per results </span>
<span class="sd">        at a given time step</span>
<span class="sd">        </span>
<span class="sd">        Additional keyword arguments are passed-down to `PlotSystem()` method </span>
<span class="sd">        of applicable system object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Get system to plot</span>
        <span class="k">if</span> <span class="n">dynsys_obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">dynsys_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span>
        
        <span class="c1"># Get results at applicable time step</span>
        <span class="n">t_val</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)[</span><span class="n">timestep_index</span><span class="p">]</span>
        <span class="k">print</span><span class="p">(</span><span class="n">t_val</span><span class="p">)</span>
        <span class="n">v_vals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetResults</span><span class="p">(</span><span class="n">dynsys_obj</span><span class="p">,[</span><span class="s1">&#39;v&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="n">timestep_index</span><span class="p">,:]</span>
        
        <span class="c1"># Create figure and axes onto which to draw system, if not provided</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
            
        <span class="c1"># Plot system onto axes</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">dynsys_obj</span><span class="o">.</span><span class="n">PlotSystem</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">v</span><span class="o">=</span><span class="n">v_vals</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
        <span class="c1"># Overlay caption to </span>
        <span class="n">time_text</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
        <span class="n">time_text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s1">&#39;Time = </span><span class="si">%.2f</span><span class="s1">s&#39;</span> <span class="o">%</span> <span class="n">t_val</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">time_text</span>
    
    
    <span class="k">def</span> <span class="nf">AnimateResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">dynsys_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">SysPlot_kwargs</span><span class="o">=</span><span class="p">{},</span>
                       <span class="n">FuncAnimation_kwargs</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Produce animation of results, plotting deformed configuration of system </span>
<span class="sd">        at each time step</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        **Required:**</span>
<span class="sd">        </span>
<span class="sd">        (No arguments required)</span>
<span class="sd">        </span>
<span class="sd">        **Optional:**</span>
<span class="sd">        </span>
<span class="sd">        * `dynsys_obj`, instance of `DynSys()` class (or derived classes), </span>
<span class="sd">          defining the system to be plotted. If None (per default argument) the </span>
<span class="sd">          parent system will be plotted</span>
<span class="sd">          </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Define axes to plot to</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
            
        <span class="k">else</span><span class="p">:</span>
            
            <span class="n">fig</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
        
        <span class="c1"># Create class to faciliate animation production</span>
        <span class="n">sys_plot_obj</span> <span class="o">=</span> <span class="n">SysPlot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">results_obj</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">SysPlot_kwargs</span><span class="p">)</span>
        
        <span class="c1"># Get tstep data</span>
        <span class="n">nResults</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span>
        
        <span class="c1"># Get time step between frames</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dt</span>
        
        <span class="k">if</span> <span class="n">dt</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># Compute average time step</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">nResults</span>
        
        <span class="c1"># Define default kwargs to pass to FuncAnimation</span>
        <span class="n">FuncAnimation_kwargs_0</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;frames&#39;</span><span class="p">:</span><span class="n">npy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nResults</span><span class="p">),</span>
                                  <span class="s1">&#39;interval&#39;</span><span class="p">:</span><span class="mi">1000</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span>
                                  <span class="s1">&#39;repeat&#39;</span><span class="p">:</span><span class="bp">False</span><span class="p">}</span>
        
        <span class="c1"># Merge with any passed kwargs: n.b passed kwargs override defaults</span>
        <span class="n">FuncAnimation_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">FuncAnimation_kwargs_0</span><span class="p">,</span>
                                <span class="o">**</span><span class="n">FuncAnimation_kwargs</span><span class="p">}</span>
        
        <span class="c1"># Create animation</span>
        <span class="n">anim</span> <span class="o">=</span> <span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">sys_plot_obj</span><span class="o">.</span><span class="n">update</span><span class="p">,</span>
                             <span class="o">**</span><span class="n">FuncAnimation_kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">anim</span>
        
        
        
        
    <span class="k">def</span> <span class="nf">calc_responses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">write_results_to_file</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                       <span class="n">results_fName</span><span class="o">=</span><span class="s2">&quot;ts_results.csv&quot;</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Responses are obtained by pre-multiplying results by output matrices</span>
<span class="sd">        </span>
<span class="sd">        Output matrices, together with their names, must be pre-defined via </span>
<span class="sd">        `DynSys` member function `AddOutputMtrx()` prior to running this </span>
<span class="sd">        function.</span>
<span class="sd">        </span>
<span class="sd">        Where a system consists of multiple subsystems, it should be note that </span>
<span class="sd">        output matrices relate to a given subsystem.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">dynsys_obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span>
        <span class="n">responses_list</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Calculate responses for all systems and subsystems</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dynsys_obj</span><span class="o">.</span><span class="n">DynSys_list</span><span class="p">:</span>
            
            <span class="n">responses_inner_list</span> <span class="o">=</span> <span class="p">[]</span>
            
            <span class="c1"># Retrieve state variables for subsystem</span>
            <span class="n">v</span><span class="p">,</span> <span class="n">vdot</span><span class="p">,</span> <span class="n">v2dot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_results</span><span class="p">(</span><span class="n">x</span><span class="p">,[</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;vdot&#39;</span><span class="p">,</span> <span class="s1">&#39;v2dot&#39;</span><span class="p">])</span>
            <span class="n">state_vector</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">v</span><span class="p">,</span><span class="n">vdot</span><span class="p">,</span><span class="n">v2dot</span><span class="p">))</span>
            
            <span class="c1"># Calculate responses for each set of outputs for this subsystem            </span>
            <span class="k">for</span> <span class="n">_om</span><span class="p">,</span> <span class="n">_names</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">output_mtrx</span><span class="p">,</span><span class="n">x</span><span class="o">.</span><span class="n">output_names</span><span class="p">):</span>
                
                <span class="n">values</span> <span class="o">=</span> <span class="n">_om</span> <span class="err">@</span> <span class="n">state_vector</span>
                                
                <span class="n">obj</span> <span class="o">=</span> <span class="n">TimeSeries_Results</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="n">_names</span><span class="p">,</span>
                                         <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span>
                                         <span class="n">tstep_results_obj</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
                
                <span class="n">responses_inner_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                
            <span class="n">responses_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">responses_inner_list</span><span class="p">)</span>
            
        <span class="c1"># Store as attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">response_results</span> <span class="o">=</span> <span class="n">responses_list</span>
                
        <span class="c1"># Calculate DOF statistics</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;calc_dof_stats&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calc_dof_stats</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
            
        <span class="c1"># Calculate response statistics</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;calc_response_stats&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calc_response_stats</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
            
        <span class="c1"># Write time series results to file</span>
        <span class="k">if</span> <span class="n">write_results_to_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">WriteResults2File</span><span class="p">(</span><span class="n">output_fName</span><span class="o">=</span><span class="n">results_fName</span><span class="p">)</span>
                
        <span class="c1"># Delete DOF time series data (to free-up memory)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;retain_dof_values&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Clearing DOF time series data to save memory...&quot;</span><span class="p">)</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">vdot</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">v2dot</span>
        
        <span class="c1"># Delete response time series data (to free up memory)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;retain_response_values&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Clearing response time series data to save memory...&quot;</span><span class="p">)</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">responses_results</span>
        
    
    <span class="k">def</span> <span class="nf">CalcKineticEnergy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates total kinetic energy of system at each time step:</span>
<span class="sd">        </span>
<span class="sd">        $$ T(t) = \dot{y}(t)^{T} M \dot{y}(t) $$</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">nResults</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span>
        
        <span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">GetSystemMatrices</span><span class="p">()[</span><span class="s2">&quot;M_mtrx&quot;</span><span class="p">]</span>
        <span class="n">vdot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vdot</span>
        
        <span class="n">KE</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">nResults</span><span class="p">,))</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nResults</span><span class="p">):</span>
        
            <span class="n">KE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">vdot</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="err">@</span> <span class="n">M</span> <span class="err">@</span> <span class="n">vdot</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">T</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">KE</span> <span class="o">=</span> <span class="n">KE</span>
        <span class="k">return</span> <span class="n">KE</span>
    
    
    <span class="k">def</span> <span class="nf">CalcPotentialEnergy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates total potential energy of system at each time step:</span>
<span class="sd">        </span>
<span class="sd">        $$ V(t) = y(t)^{T} K y(t) $$</span>

<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">nResults</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span>
        
        <span class="n">K</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">GetSystemMatrices</span><span class="p">()[</span><span class="s2">&quot;K_mtrx&quot;</span><span class="p">]</span>
        <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span>
        
        <span class="n">PE</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">nResults</span><span class="p">,))</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nResults</span><span class="p">):</span>
        
            <span class="n">PE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="err">@</span> <span class="n">K</span> <span class="err">@</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">T</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">PE</span> <span class="o">=</span> <span class="n">PE</span>
        <span class="k">return</span> <span class="n">PE</span>
   
    
    <span class="k">def</span> <span class="nf">CalcExternalWorkPower</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates power of work done by external forces at each time step:</span>
<span class="sd">            </span>
<span class="sd">        $$ P(t) = f(t)^{T} \dot{v}(t) $$</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">nResults</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span>
        
        <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span>
        <span class="n">vdot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vdot</span>
        
        <span class="n">ExtWork_Power</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">nResults</span><span class="p">,))</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nResults</span><span class="p">):</span>
        
            <span class="n">ExtWork_Power</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="err">@</span> <span class="n">vdot</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">T</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">ExtWork_Power</span> <span class="o">=</span> <span class="n">ExtWork_Power</span>
        <span class="k">return</span> <span class="n">ExtWork_Power</span>
    
    
    <span class="k">def</span> <span class="nf">CalcExternalWorkDone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates work done by external forces since t=0</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        _Practically this is done by integrating the power of work done by </span>
<span class="sd">        external forces as calculated by `CalcExternalWorkPower()` method. </span>
<span class="sd">        Note integration is approximate; trapezium rule is used_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">t</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
        <span class="n">ExtWork_power</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CalcExternalWorkPower</span><span class="p">()</span>
        
        <span class="c1"># Integrate power of external work to get total external work from t=0</span>
        <span class="n">ExtWork</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">cumtrapz</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">ExtWork_power</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">ExtWork</span> <span class="o">=</span> <span class="n">ExtWork</span>
        <span class="k">return</span> <span class="n">ExtWork</span>
    
    
    <span class="k">def</span> <span class="nf">PlotEnergyResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">recalculate</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Produce figure with subplots to show key energy results of analysis</span>
<span class="sd">        e.g. external work done, kinetic &amp; potential energies</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">recalculate</span><span class="p">:</span>
            <span class="n">KE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CalcKineticEnergy</span><span class="p">()</span>
            <span class="n">PE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CalcPotentialEnergy</span><span class="p">()</span>
            <span class="n">ExtWork</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CalcExternalWorkDone</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">KE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">KE</span>
            <span class="n">PE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PE</span>
            <span class="n">ExtWork</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExtWork</span>
            
        <span class="c1"># Back-calculate energy dissipated</span>
        <span class="n">E0</span> <span class="o">=</span> <span class="n">PE</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">KE</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>              <span class="c1"># energy of system at t=0</span>
        <span class="n">ED</span> <span class="o">=</span> <span class="n">ExtWork</span> <span class="o">-</span> <span class="p">(</span><span class="n">PE</span><span class="o">+</span><span class="n">KE</span><span class="p">)</span> <span class="o">+</span> <span class="n">E0</span>     <span class="c1"># energy dissipated since t=0</span>
                        
        <span class="c1"># Get time values for plots</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
        
        <span class="n">tstep_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span>

        <span class="c1"># Create new figure for plots</span>
        <span class="n">fig</span><span class="p">,</span><span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Energy results</span><span class="se">\n</span><span class="s2">Analysis: &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">tstep_obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">fontsize_titles</span> <span class="o">=</span> <span class="mi">10</span>
        
        <span class="c1"># Define individual subplots</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">ExtWork</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;External work done&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,(</span><span class="n">KE</span><span class="o">+</span><span class="n">PE</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Conserved energy, $E=T+V$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">ED</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Energy dissipated (from energy balance)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,(</span><span class="n">KE</span><span class="o">-</span><span class="n">PE</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lagrangian, $L=T-V$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;External/Internal work done&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize_titles</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">KE</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Kinetic energy: T(t) = $\dot{y}(t)^{T}M\dot{y}(t)$&quot;</span><span class="p">,</span>
                     <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize_titles</span><span class="p">)</span>
        
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">PE</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Potential energy: V(t) = $y(t)^{T}Ky(t)$&quot;</span><span class="p">,</span>
                     <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize_titles</span><span class="p">)</span>
        
        <span class="c1"># Set details for shared x-axis</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">tStart</span><span class="p">,</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">tEnd</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time $t$ (secs)&quot;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">fig</span>
        
    
        
    <span class="k">def</span> <span class="nf">calc_dof_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Obtain basic statistics to describe DOF time series</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        **Required:**</span>
<span class="sd">        </span>
<span class="sd">        No arguments are required</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        **Optional:**</span>
<span class="sd">        </span>
<span class="sd">        * `verbose`, _boolean_, controls the amount of console output</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        **Returns:**</span>
<span class="sd">        </span>
<span class="sd">        Stats are returned as a _list_ of _dicts_, with list indexs as follows:</span>
<span class="sd">            </span>
<span class="sd">        * 0 : DOF displacements</span>
<span class="sd">        </span>
<span class="sd">        * 1 : DOF velocities</span>
<span class="sd">        </span>
<span class="sd">        * 2 : DOF accelerations</span>
<span class="sd">        </span>
<span class="sd">        * 3 : Constraint forces (only if constraints defined)</span>
<span class="sd">        </span>
<span class="sd">        Dict entries will in general be _arrays_, giving stats results for each </span>
<span class="sd">        degree of freedom</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;calc_dof_stats&#39;</span><span class="p">]:</span>
            
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Calculating DOF statistics...&quot;</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">v_obj</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">vdot_obj</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">v2dot_obj</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">f_constraint_obj</span><span class="p">]:</span>
                
                <span class="n">obj</span><span class="o">.</span><span class="n">calc_stats</span><span class="p">()</span>
                        
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&#39;calc_dof_stats&#39; option set to False</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
                      <span class="s2">&quot;DOF statistics will not be computed&quot;</span><span class="p">)</span>

        
    
    <span class="k">def</span> <span class="nf">calc_response_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate basic statistics to describe response time series</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;calc_response_stats&#39;</span><span class="p">]:</span>
            
            <span class="c1"># Get paired lists to loop over</span>
            <span class="n">response_obj_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_results</span>
            <span class="n">dynsys_obj_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">DynSys_list</span>
            
            <span class="c1"># Loop over all systems and subsystems</span>
            <span class="k">for</span> <span class="n">dynsys_obj</span><span class="p">,</span> <span class="n">response_objs</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dynsys_obj_list</span><span class="p">,</span>
                                                 <span class="n">response_obj_list</span><span class="p">):</span>
                
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Calculating response statistics &quot;</span> <span class="o">+</span> 
                          <span class="s2">&quot;for &#39;{0}&#39;...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

                <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">response_objs</span><span class="p">:</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">calc_stats</span><span class="p">()</span>
                                
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&#39;calc_response_stats&#39; option set to False</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> 
                      <span class="s2">&quot;Response statistics will not be computed&quot;</span><span class="p">)</span>
            
            
    <span class="k">def</span> <span class="nf">get_dof_stats_df</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns dof stats as Pandas dataframe</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">def</span> <span class="nf">get_stats_df</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">prefix</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
            <span class="n">stats_dict</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">stats</span>
            <span class="n">names</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">names</span>
            <span class="k">print</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">stats_dict</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">df</span>
        
        <span class="n">df_list</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_stats_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f_obj</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">))</span>
        <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_stats_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v_obj</span><span class="p">,</span><span class="s1">&#39;disp&#39;</span><span class="p">))</span>
        <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_stats_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vdot_obj</span><span class="p">,</span><span class="s1">&#39;vel&#39;</span><span class="p">))</span>
        <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_stats_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2dot_obj</span><span class="p">,</span><span class="s1">&#39;acc&#39;</span><span class="p">))</span>
        <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_stats_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f_constraint_obj</span><span class="p">,</span><span class="s1">&#39;f_constraint&#39;</span><span class="p">))</span>
            
        <span class="k">return</span> <span class="n">df_list</span>
        
    
    <span class="k">def</span> <span class="nf">get_response_stats_df</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns response stats as list of Pandas dataframes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">df_list</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">dynsys_obj</span><span class="p">,</span> <span class="n">results_obj_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DynSys_list</span><span class="p">,</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">response_results</span><span class="p">):</span>
                    
            <span class="k">for</span> <span class="n">results_obj</span> <span class="ow">in</span> <span class="n">results_obj_list</span><span class="p">:</span>
            
                <span class="n">response_names</span> <span class="o">=</span> <span class="n">results_obj</span><span class="o">.</span><span class="n">names</span>
                <span class="n">stats_dict</span> <span class="o">=</span> <span class="n">results_obj</span><span class="o">.</span><span class="n">stats</span>

                <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">stats_dict</span><span class="p">,</span>
                                                <span class="n">index</span><span class="o">=</span><span class="n">response_names</span><span class="p">))</span>
            
        <span class="k">return</span> <span class="n">df_list</span>
    
    
    <span class="k">def</span> <span class="nf">PrintResponseStats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints response stats to text window</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">for</span> <span class="n">dynsys_obj</span><span class="p">,</span> <span class="n">stats_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_stats_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;System name: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Response names: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">output_names</span><span class="p">))</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Response statistics :&quot;</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">stats_str</span><span class="p">,</span> <span class="n">stats_vals</span> <span class="ow">in</span> <span class="n">stats_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39;:&quot;</span> <span class="o">%</span> <span class="n">stats_str</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="n">stats_vals</span><span class="p">)</span>
            
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    
    
    <span class="k">def</span> <span class="nf">WriteResults2File</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">output_fName</span><span class="o">=</span><span class="s2">&quot;timeseries_results.csv&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes time-series results to file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">header</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
        <span class="n">header</span><span class="o">+=</span><span class="s2">&quot;Time series results export</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">header</span><span class="o">+=</span><span class="s2">&quot;dynsys_obj:, {0}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
        <span class="n">header</span><span class="o">+=</span><span class="s2">&quot;nDOF:, {0}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nDOF</span><span class="p">)</span>
        <span class="n">header</span><span class="o">+=</span><span class="s2">&quot;nResults:, {0}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nResults</span><span class="p">)</span>
        <span class="n">header</span><span class="o">+=</span><span class="s2">&quot;DynSys version:, {0}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">currentVersion</span><span class="p">)</span>
        <span class="n">header</span><span class="o">+=</span><span class="s2">&quot;Export date/time:, {0}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">))</span>
        <span class="n">header</span><span class="o">+=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        
        <span class="n">array2write</span><span class="o">=</span><span class="bp">None</span>
        
        <span class="k">def</span> <span class="nf">writeArray</span><span class="p">(</span><span class="n">arrName</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Function to append array and create suitable headers</span>
<span class="sd">            &quot;&quot;&quot;</span>
            
            <span class="n">arr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">arrName</span><span class="p">)</span>

            <span class="n">nonlocal</span> <span class="n">header</span><span class="p">,</span> <span class="n">array2write</span>
            
            <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="n">header</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%s%d</span><span class="s2">,&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">arrName</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">header</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">,&quot;</span> <span class="o">%</span> <span class="n">arrName</span>
                
            <span class="k">if</span> <span class="n">array2write</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">array2write</span> <span class="o">=</span> <span class="n">arr</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">array2write</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">array2write</span><span class="p">,</span><span class="n">arr</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            
        <span class="c1"># Use the above function to prepare data to write to file</span>
        <span class="n">writeArray</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
        <span class="n">writeArray</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
        <span class="n">writeArray</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>
        <span class="n">writeArray</span><span class="p">(</span><span class="s1">&#39;vdot&#39;</span><span class="p">)</span>
        <span class="n">writeArray</span><span class="p">(</span><span class="s1">&#39;v2dot&#39;</span><span class="p">)</span>
        <span class="n">writeArray</span><span class="p">(</span><span class="s1">&#39;f_constraint&#39;</span><span class="p">)</span>
        
        <span class="c1"># Write to file</span>
        <span class="n">npy</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">output_fName</span><span class="p">,</span>
                    <span class="n">X</span><span class="o">=</span><span class="n">array2write</span><span class="p">,</span>
                    <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                    <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">)</span>
        
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Time-series results written to `{0}`&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output_fName</span><span class="p">))</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#tstep_results.TStep_Results">TStep_Results</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, tstep_obj, options={&#39;calc_dof_stats&#39;: True, &#39;calc_response_stats&#39;: True, &#39;retain_dof_values&#39;: True, &#39;retain_response_values&#39;: True})</p>
    </div>
    

    
  
    <div class="desc"><p>Initialisation function</p>
<hr />
<p>Required:</p>
<ul>
<li><code>tstep_obj</code>, <code>TStep()</code> class instance to which results relate</li>
</ul>
<hr />
<p>Optional</p>
<ul>
<li>
<p><code>options</code> <em>dict</em>, with the following as boolean entries:</p>
<ul>
<li>
<p><code>calc_DOF_stats</code>, if True statistics will be calculated, to 
  summarise time series results for DOF variables</p>
</li>
<li>
<p><code>calc_response_stats</code>, if True statistics will be calculated, to 
  summarise time series results for response variables</p>
</li>
<li>
<p><code>retain_DOF_values</code>, if False DOF time series results will be 
  deleted once summary statistics have been computed</p>
</li>
<li>
<p><code>retain_response_values</code>, if False response time series results 
  will be deleted once summary statistics have been computed</p>
</li>
</ul>
<p>Choosing <em>False</em> for the above can be done to be more economical 
with memory usage, for example when carrying out multiple analyses. 
Note that providing DOF time series are retained, responses can 
always be re-calculated using <code>calc_responses()</code> method</p>
</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.__init__', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">tstep_obj</span><span class="p">,</span>
             <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;calc_dof_stats&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                      <span class="s1">&#39;calc_response_stats&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                      <span class="s1">&#39;retain_dof_values&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                      <span class="s1">&#39;retain_response_values&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
             <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialisation function</span>
<span class="sd">    ***</span>
<span class="sd">    </span>
<span class="sd">    Required:</span>
<span class="sd">    </span>
<span class="sd">    * `tstep_obj`, `TStep()` class instance to which results relate</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    Optional</span>
<span class="sd">    </span>
<span class="sd">    * `options` _dict_, with the following as boolean entries:</span>
<span class="sd">    </span>
<span class="sd">        * `calc_DOF_stats`, if True statistics will be calculated, to </span>
<span class="sd">          summarise time series results for DOF variables</span>
<span class="sd">        </span>
<span class="sd">        * `calc_response_stats`, if True statistics will be calculated, to </span>
<span class="sd">          summarise time series results for response variables</span>
<span class="sd">          </span>
<span class="sd">        * `retain_DOF_values`, if False DOF time series results will be </span>
<span class="sd">          deleted once summary statistics have been computed</span>
<span class="sd">                     </span>
<span class="sd">        * `retain_response_values`, if False response time series results </span>
<span class="sd">          will be deleted once summary statistics have been computed</span>
<span class="sd">      </span>
<span class="sd">        Choosing _False_ for the above can be done to be more economical </span>
<span class="sd">        with memory usage, for example when carrying out multiple analyses. </span>
<span class="sd">        Note that providing DOF time series are retained, responses can </span>
<span class="sd">        always be re-calculated using `calc_responses()` method</span>
<span class="sd">    &quot;&quot;&quot;</span>
            
    <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span><span class="o">=</span><span class="mi">0</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">=</span><span class="n">tstep_obj</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instance of `tstep` class, to which results relate</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">DynSys_list</span> <span class="o">=</span> <span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">DynSys_list</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List of DynSys objects to which results held by this object relate</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">response_results</span><span class="o">=</span><span class="p">[]</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List of matrices to which computed responses are recorded </span>
<span class="sd">    for each time step</span>
<span class="sd">    &quot;&quot;&quot;</span>
            
    <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">options</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dict containing options - refer __init__() docstring for details</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">dof_stats</span><span class="o">=</span><span class="bp">None</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dict of statistics, evaluated over all time steps, for each DOF</span>
<span class="sd">    </span>
<span class="sd">    _Set using `CalcDOFStats()`_</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.AnimateResults">
    <p>def <span class="ident">AnimateResults</span>(</p><p>self, dynsys_obj=None, ax=None, SysPlot_kwargs={}, FuncAnimation_kwargs={})</p>
    </div>
    

    
  
    <div class="desc"><p>Produce animation of results, plotting deformed configuration of system 
at each time step</p>
<hr />
<p><strong>Required:</strong></p>
<p>(No arguments required)</p>
<p><strong>Optional:</strong></p>
<ul>
<li><code>dynsys_obj</code>, instance of <code>DynSys()</code> class (or derived classes), 
  defining the system to be plotted. If None (per default argument) the 
  parent system will be plotted</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.AnimateResults', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.AnimateResults" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">AnimateResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                   <span class="n">dynsys_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                   <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                   <span class="n">SysPlot_kwargs</span><span class="o">=</span><span class="p">{},</span>
                   <span class="n">FuncAnimation_kwargs</span><span class="o">=</span><span class="p">{}):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Produce animation of results, plotting deformed configuration of system </span>
<span class="sd">    at each time step</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    **Required:**</span>
<span class="sd">    </span>
<span class="sd">    (No arguments required)</span>
<span class="sd">    </span>
<span class="sd">    **Optional:**</span>
<span class="sd">    </span>
<span class="sd">    * `dynsys_obj`, instance of `DynSys()` class (or derived classes), </span>
<span class="sd">      defining the system to be plotted. If None (per default argument) the </span>
<span class="sd">      parent system will be plotted</span>
<span class="sd">      </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Define axes to plot to</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
        
    <span class="k">else</span><span class="p">:</span>
        
        <span class="n">fig</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
    
    <span class="c1"># Create class to faciliate animation production</span>
    <span class="n">sys_plot_obj</span> <span class="o">=</span> <span class="n">SysPlot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">results_obj</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">SysPlot_kwargs</span><span class="p">)</span>
    
    <span class="c1"># Get tstep data</span>
    <span class="n">nResults</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span>
    
    <span class="c1"># Get time step between frames</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dt</span>
    
    <span class="k">if</span> <span class="n">dt</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># Compute average time step</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">nResults</span>
    
    <span class="c1"># Define default kwargs to pass to FuncAnimation</span>
    <span class="n">FuncAnimation_kwargs_0</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;frames&#39;</span><span class="p">:</span><span class="n">npy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nResults</span><span class="p">),</span>
                              <span class="s1">&#39;interval&#39;</span><span class="p">:</span><span class="mi">1000</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span>
                              <span class="s1">&#39;repeat&#39;</span><span class="p">:</span><span class="bp">False</span><span class="p">}</span>
    
    <span class="c1"># Merge with any passed kwargs: n.b passed kwargs override defaults</span>
    <span class="n">FuncAnimation_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">FuncAnimation_kwargs_0</span><span class="p">,</span>
                            <span class="o">**</span><span class="n">FuncAnimation_kwargs</span><span class="p">}</span>
    
    <span class="c1"># Create animation</span>
    <span class="n">anim</span> <span class="o">=</span> <span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">sys_plot_obj</span><span class="o">.</span><span class="n">update</span><span class="p">,</span>
                         <span class="o">**</span><span class="n">FuncAnimation_kwargs</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">anim</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.CalcExternalWorkDone">
    <p>def <span class="ident">CalcExternalWorkDone</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculates work done by external forces since t=0</p>
<hr />
<p><em>Practically this is done by integrating the power of work done by 
external forces as calculated by <code>CalcExternalWorkPower()</code> method. 
Note integration is approximate; trapezium rule is used</em></p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.CalcExternalWorkDone', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.CalcExternalWorkDone" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">CalcExternalWorkDone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates work done by external forces since t=0</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    _Practically this is done by integrating the power of work done by </span>
<span class="sd">    external forces as calculated by `CalcExternalWorkPower()` method. </span>
<span class="sd">    Note integration is approximate; trapezium rule is used_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">t</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
    <span class="n">ExtWork_power</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CalcExternalWorkPower</span><span class="p">()</span>
    
    <span class="c1"># Integrate power of external work to get total external work from t=0</span>
    <span class="n">ExtWork</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">cumtrapz</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">ExtWork_power</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">ExtWork</span> <span class="o">=</span> <span class="n">ExtWork</span>
    <span class="k">return</span> <span class="n">ExtWork</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.CalcExternalWorkPower">
    <p>def <span class="ident">CalcExternalWorkPower</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculates power of work done by external forces at each time step:</p>
<p>$$ P(t) = f(t)^{T} \dot{v}(t) $$</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.CalcExternalWorkPower', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.CalcExternalWorkPower" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">CalcExternalWorkPower</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates power of work done by external forces at each time step:</span>
<span class="sd">        </span>
<span class="sd">    $$ P(t) = f(t)^{T} \dot{v}(t) $$</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">nResults</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span>
    
    <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span>
    <span class="n">vdot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vdot</span>
    
    <span class="n">ExtWork_Power</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">nResults</span><span class="p">,))</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nResults</span><span class="p">):</span>
    
        <span class="n">ExtWork_Power</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="err">@</span> <span class="n">vdot</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">T</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">ExtWork_Power</span> <span class="o">=</span> <span class="n">ExtWork_Power</span>
    <span class="k">return</span> <span class="n">ExtWork_Power</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.CalcKineticEnergy">
    <p>def <span class="ident">CalcKineticEnergy</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculates total kinetic energy of system at each time step:</p>
<p>$$ T(t) = \dot{y}(t)^{T} M \dot{y}(t) $$</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.CalcKineticEnergy', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.CalcKineticEnergy" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">CalcKineticEnergy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates total kinetic energy of system at each time step:</span>
<span class="sd">    </span>
<span class="sd">    $$ T(t) = \dot{y}(t)^{T} M \dot{y}(t) $$</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">nResults</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span>
    
    <span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">GetSystemMatrices</span><span class="p">()[</span><span class="s2">&quot;M_mtrx&quot;</span><span class="p">]</span>
    <span class="n">vdot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vdot</span>
    
    <span class="n">KE</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">nResults</span><span class="p">,))</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nResults</span><span class="p">):</span>
    
        <span class="n">KE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">vdot</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="err">@</span> <span class="n">M</span> <span class="err">@</span> <span class="n">vdot</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">T</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">KE</span> <span class="o">=</span> <span class="n">KE</span>
    <span class="k">return</span> <span class="n">KE</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.CalcPotentialEnergy">
    <p>def <span class="ident">CalcPotentialEnergy</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculates total potential energy of system at each time step:</p>
<p>$$ V(t) = y(t)^{T} K y(t) $$</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.CalcPotentialEnergy', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.CalcPotentialEnergy" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">CalcPotentialEnergy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates total potential energy of system at each time step:</span>
<span class="sd">    </span>
<span class="sd">    $$ V(t) = y(t)^{T} K y(t) $$</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">nResults</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span>
    
    <span class="n">K</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">GetSystemMatrices</span><span class="p">()[</span><span class="s2">&quot;K_mtrx&quot;</span><span class="p">]</span>
    <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span>
    
    <span class="n">PE</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">nResults</span><span class="p">,))</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nResults</span><span class="p">):</span>
    
        <span class="n">PE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="err">@</span> <span class="n">K</span> <span class="err">@</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">T</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">PE</span> <span class="o">=</span> <span class="n">PE</span>
    <span class="k">return</span> <span class="n">PE</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.ClearResults">
    <p>def <span class="ident">ClearResults</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Clear all results from previous time-stepping analysis</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.ClearResults', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.ClearResults" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">ClearResults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Clear all results from previous time-stepping analysis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vdot</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">v2dot</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">f_constraint</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.PlotDeformed">
    <p>def <span class="ident">PlotDeformed</span>(</p><p>self, timestep_index, dynsys_obj=None, ax=None, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Produce a plot of system in its deformed configuration, as per results 
at a given time step</p>
<p>Additional keyword arguments are passed-down to <code>PlotSystem()</code> method 
of applicable system object</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.PlotDeformed', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.PlotDeformed" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">PlotDeformed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">timestep_index</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span><span class="n">dynsys_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Produce a plot of system in its deformed configuration, as per results </span>
<span class="sd">    at a given time step</span>
<span class="sd">    </span>
<span class="sd">    Additional keyword arguments are passed-down to `PlotSystem()` method </span>
<span class="sd">    of applicable system object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Get system to plot</span>
    <span class="k">if</span> <span class="n">dynsys_obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">dynsys_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span>
    
    <span class="c1"># Get results at applicable time step</span>
    <span class="n">t_val</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)[</span><span class="n">timestep_index</span><span class="p">]</span>
    <span class="k">print</span><span class="p">(</span><span class="n">t_val</span><span class="p">)</span>
    <span class="n">v_vals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetResults</span><span class="p">(</span><span class="n">dynsys_obj</span><span class="p">,[</span><span class="s1">&#39;v&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="n">timestep_index</span><span class="p">,:]</span>
    
    <span class="c1"># Create figure and axes onto which to draw system, if not provided</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
        
    <span class="c1"># Plot system onto axes</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">dynsys_obj</span><span class="o">.</span><span class="n">PlotSystem</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">v</span><span class="o">=</span><span class="n">v_vals</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Overlay caption to </span>
    <span class="n">time_text</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
    <span class="n">time_text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s1">&#39;Time = </span><span class="si">%.2f</span><span class="s1">s&#39;</span> <span class="o">%</span> <span class="n">t_val</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">time_text</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.PlotEnergyResults">
    <p>def <span class="ident">PlotEnergyResults</span>(</p><p>self, recalculate=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Produce figure with subplots to show key energy results of analysis
e.g. external work done, kinetic &amp; potential energies</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.PlotEnergyResults', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.PlotEnergyResults" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">PlotEnergyResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">recalculate</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Produce figure with subplots to show key energy results of analysis</span>
<span class="sd">    e.g. external work done, kinetic &amp; potential energies</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="n">recalculate</span><span class="p">:</span>
        <span class="n">KE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CalcKineticEnergy</span><span class="p">()</span>
        <span class="n">PE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CalcPotentialEnergy</span><span class="p">()</span>
        <span class="n">ExtWork</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CalcExternalWorkDone</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">KE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">KE</span>
        <span class="n">PE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PE</span>
        <span class="n">ExtWork</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExtWork</span>
        
    <span class="c1"># Back-calculate energy dissipated</span>
    <span class="n">E0</span> <span class="o">=</span> <span class="n">PE</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">KE</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>              <span class="c1"># energy of system at t=0</span>
    <span class="n">ED</span> <span class="o">=</span> <span class="n">ExtWork</span> <span class="o">-</span> <span class="p">(</span><span class="n">PE</span><span class="o">+</span><span class="n">KE</span><span class="p">)</span> <span class="o">+</span> <span class="n">E0</span>     <span class="c1"># energy dissipated since t=0</span>
                    
    <span class="c1"># Get time values for plots</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
    
    <span class="n">tstep_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span>
    <span class="c1"># Create new figure for plots</span>
    <span class="n">fig</span><span class="p">,</span><span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Energy results</span><span class="se">\n</span><span class="s2">Analysis: &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">tstep_obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">fontsize_titles</span> <span class="o">=</span> <span class="mi">10</span>
    
    <span class="c1"># Define individual subplots</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">ExtWork</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;External work done&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,(</span><span class="n">KE</span><span class="o">+</span><span class="n">PE</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Conserved energy, $E=T+V$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">ED</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Energy dissipated (from energy balance)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,(</span><span class="n">KE</span><span class="o">-</span><span class="n">PE</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lagrangian, $L=T-V$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;External/Internal work done&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize_titles</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">KE</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Kinetic energy: T(t) = $\dot{y}(t)^{T}M\dot{y}(t)$&quot;</span><span class="p">,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize_titles</span><span class="p">)</span>
    
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">PE</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Potential energy: V(t) = $y(t)^{T}Ky(t)$&quot;</span><span class="p">,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize_titles</span><span class="p">)</span>
    
    <span class="c1"># Set details for shared x-axis</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">tStart</span><span class="p">,</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">tEnd</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time $t$ (secs)&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">fig</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.PlotResponsePSDs">
    <p>def <span class="ident">PlotResponsePSDs</span>(</p><p>self, nperseg=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Produces power spectral density plots of response time series</p>
<hr />
<p>Optional:</p>
<ul>
<li><code>nperseg</code>, length of each segment used in PSD calculation</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.PlotResponsePSDs', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.PlotResponsePSDs" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">PlotResponsePSDs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nperseg</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Produces power spectral density plots of response time series</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    Optional:</span>
<span class="sd">    </span>
<span class="sd">    * `nperseg`, length of each segment used in PSD calculation</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Plotting PSD estimates of responses using periodograms...&quot;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response_results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No response time series data avaliable!&quot;</span><span class="p">)</span>
    
    <span class="c1"># Get sampling frequency</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dt</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`dt` is None: cannot calculate PSDs from &quot;</span>
                         <span class="s2">&quot;variable timestep time series&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dt</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Sampling frequency: fs = </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">fs</span><span class="p">)</span>
    
    <span class="c1"># Loop through all responses</span>
    <span class="n">fig_list</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">responses_list</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_results</span><span class="p">:</span>
        
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">responses_list</span><span class="p">:</span>
            
            <span class="n">fig_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">plot_psd</span><span class="p">())</span>
    
    <span class="k">return</span> <span class="n">fig_list</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.PlotResponseResults">
    <p>def <span class="ident">PlotResponseResults</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.PlotResponseResults', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.PlotResponseResults" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">PlotResponseResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">deprecation_warning</span><span class="p">(</span><span class="s1">&#39;PlotResponseResults&#39;</span><span class="p">,</span><span class="s1">&#39;plot_response_results&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_response_results</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.PlotResults">
    <p>def <span class="ident">PlotResults</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.PlotResults', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.PlotResults" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">PlotResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    
    <span class="n">deprecation_warning</span><span class="p">(</span><span class="s1">&#39;PlotResults&#39;</span><span class="p">,</span><span class="s1">&#39;plot_results&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_results</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.PlotStateResults">
    <p>def <span class="ident">PlotStateResults</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.PlotStateResults', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.PlotStateResults" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">PlotStateResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">deprecation_warning</span><span class="p">(</span><span class="s1">&#39;PlotStateResults&#39;</span><span class="p">,</span><span class="s1">&#39;plot_state_results&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_state_results</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.PrintResponseStats">
    <p>def <span class="ident">PrintResponseStats</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Prints response stats to text window</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.PrintResponseStats', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.PrintResponseStats" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">PrintResponseStats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prints response stats to text window</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">for</span> <span class="n">dynsys_obj</span><span class="p">,</span> <span class="n">stats_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_stats_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;System name: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Response names: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">output_names</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Response statistics :&quot;</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">stats_str</span><span class="p">,</span> <span class="n">stats_vals</span> <span class="ow">in</span> <span class="n">stats_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39;:&quot;</span> <span class="o">%</span> <span class="n">stats_str</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">stats_vals</span><span class="p">)</span>
        
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.RecordResults">
    <p>def <span class="ident">RecordResults</span>(</p><p>self, t, f, v, vdot, v2dot, f_constraint, verbose=True, append=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Used to record results from time-stepping analysis as implemented 
by <code>TStep().run()</code></p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.RecordResults', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.RecordResults" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">RecordResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">vdot</span><span class="p">,</span><span class="n">v2dot</span><span class="p">,</span><span class="n">f_constraint</span><span class="p">,</span>
                  <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">append</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to record results from time-stepping analysis as implemented </span>
<span class="sd">    by `TStep().run()`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="s1">&#39;__len__&#39;</span><span class="p">):</span>
        <span class="n">nResults</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nResults</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">append</span><span class="o">=</span><span class="bp">False</span> <span class="c1"># no results currently save</span>
                   
    <span class="k">if</span> <span class="n">append</span><span class="p">:</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">t</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vdot</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vdot</span><span class="p">,</span><span class="n">vdot</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v2dot</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2dot</span><span class="p">,</span><span class="n">v2dot</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_constraint</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f_constraint</span><span class="p">,</span><span class="n">f_constraint</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
    <span class="k">else</span><span class="p">:</span>
                               
        <span class="bp">self</span><span class="o">.</span><span class="n">nDOF</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="o">=</span><span class="n">t</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">=</span><span class="n">f</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="o">=</span><span class="n">v</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vdot</span><span class="o">=</span><span class="n">vdot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v2dot</span><span class="o">=</span><span class="n">v2dot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_constraint</span><span class="o">=</span><span class="n">f_constraint</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">nResults</span> <span class="o">+=</span> <span class="n">nResults</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.WriteResults2File">
    <p>def <span class="ident">WriteResults2File</span>(</p><p>self, output_fName=&#39;timeseries_results.csv&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Writes time-series results to file</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.WriteResults2File', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.WriteResults2File" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">WriteResults2File</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">output_fName</span><span class="o">=</span><span class="s2">&quot;timeseries_results.csv&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes time-series results to file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">header</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
    <span class="n">header</span><span class="o">+=</span><span class="s2">&quot;Time series results export</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">header</span><span class="o">+=</span><span class="s2">&quot;dynsys_obj:, {0}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
    <span class="n">header</span><span class="o">+=</span><span class="s2">&quot;nDOF:, {0}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nDOF</span><span class="p">)</span>
    <span class="n">header</span><span class="o">+=</span><span class="s2">&quot;nResults:, {0}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nResults</span><span class="p">)</span>
    <span class="n">header</span><span class="o">+=</span><span class="s2">&quot;DynSys version:, {0}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">currentVersion</span><span class="p">)</span>
    <span class="n">header</span><span class="o">+=</span><span class="s2">&quot;Export date/time:, {0}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">))</span>
    <span class="n">header</span><span class="o">+=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
    
    <span class="n">array2write</span><span class="o">=</span><span class="bp">None</span>
    
    <span class="k">def</span> <span class="nf">writeArray</span><span class="p">(</span><span class="n">arrName</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to append array and create suitable headers</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">arr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">arrName</span><span class="p">)</span>
        <span class="n">nonlocal</span> <span class="n">header</span><span class="p">,</span> <span class="n">array2write</span>
        
        <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">header</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%s%d</span><span class="s2">,&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">arrName</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">header</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">,&quot;</span> <span class="o">%</span> <span class="n">arrName</span>
            
        <span class="k">if</span> <span class="n">array2write</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">array2write</span> <span class="o">=</span> <span class="n">arr</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">array2write</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">array2write</span><span class="p">,</span><span class="n">arr</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
    <span class="c1"># Use the above function to prepare data to write to file</span>
    <span class="n">writeArray</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
    <span class="n">writeArray</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
    <span class="n">writeArray</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>
    <span class="n">writeArray</span><span class="p">(</span><span class="s1">&#39;vdot&#39;</span><span class="p">)</span>
    <span class="n">writeArray</span><span class="p">(</span><span class="s1">&#39;v2dot&#39;</span><span class="p">)</span>
    <span class="n">writeArray</span><span class="p">(</span><span class="s1">&#39;f_constraint&#39;</span><span class="p">)</span>
    
    <span class="c1"># Write to file</span>
    <span class="n">npy</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">output_fName</span><span class="p">,</span>
                <span class="n">X</span><span class="o">=</span><span class="n">array2write</span><span class="p">,</span>
                <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">)</span>
    
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Time-series results written to `{0}`&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output_fName</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.calc_dof_stats">
    <p>def <span class="ident">calc_dof_stats</span>(</p><p>self, verbose=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Obtain basic statistics to describe DOF time series</p>
<hr />
<p><strong>Required:</strong></p>
<p>No arguments are required</p>
<hr />
<p><strong>Optional:</strong></p>
<ul>
<li><code>verbose</code>, <em>boolean</em>, controls the amount of console output</li>
</ul>
<hr />
<p><strong>Returns:</strong></p>
<p>Stats are returned as a <em>list</em> of <em>dicts</em>, with list indexs as follows:</p>
<ul>
<li>
<p>0 : DOF displacements</p>
</li>
<li>
<p>1 : DOF velocities</p>
</li>
<li>
<p>2 : DOF accelerations</p>
</li>
<li>
<p>3 : Constraint forces (only if constraints defined)</p>
</li>
</ul>
<p>Dict entries will in general be <em>arrays</em>, giving stats results for each 
degree of freedom</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.calc_dof_stats', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.calc_dof_stats" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">calc_dof_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Obtain basic statistics to describe DOF time series</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    **Required:**</span>
<span class="sd">    </span>
<span class="sd">    No arguments are required</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    **Optional:**</span>
<span class="sd">    </span>
<span class="sd">    * `verbose`, _boolean_, controls the amount of console output</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    **Returns:**</span>
<span class="sd">    </span>
<span class="sd">    Stats are returned as a _list_ of _dicts_, with list indexs as follows:</span>
<span class="sd">        </span>
<span class="sd">    * 0 : DOF displacements</span>
<span class="sd">    </span>
<span class="sd">    * 1 : DOF velocities</span>
<span class="sd">    </span>
<span class="sd">    * 2 : DOF accelerations</span>
<span class="sd">    </span>
<span class="sd">    * 3 : Constraint forces (only if constraints defined)</span>
<span class="sd">    </span>
<span class="sd">    Dict entries will in general be _arrays_, giving stats results for each </span>
<span class="sd">    degree of freedom</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;calc_dof_stats&#39;</span><span class="p">]:</span>
        
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Calculating DOF statistics...&quot;</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">v_obj</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vdot_obj</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">v2dot_obj</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">f_constraint_obj</span><span class="p">]:</span>
            
            <span class="n">obj</span><span class="o">.</span><span class="n">calc_stats</span><span class="p">()</span>
                    
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&#39;calc_dof_stats&#39; option set to False</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
                  <span class="s2">&quot;DOF statistics will not be computed&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.calc_response_stats">
    <p>def <span class="ident">calc_response_stats</span>(</p><p>self, verbose=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculate basic statistics to describe response time series</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.calc_response_stats', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.calc_response_stats" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">calc_response_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate basic statistics to describe response time series</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;calc_response_stats&#39;</span><span class="p">]:</span>
        
        <span class="c1"># Get paired lists to loop over</span>
        <span class="n">response_obj_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_results</span>
        <span class="n">dynsys_obj_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">DynSys_list</span>
        
        <span class="c1"># Loop over all systems and subsystems</span>
        <span class="k">for</span> <span class="n">dynsys_obj</span><span class="p">,</span> <span class="n">response_objs</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dynsys_obj_list</span><span class="p">,</span>
                                             <span class="n">response_obj_list</span><span class="p">):</span>
            
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Calculating response statistics &quot;</span> <span class="o">+</span> 
                      <span class="s2">&quot;for &#39;{0}&#39;...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">response_objs</span><span class="p">:</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">calc_stats</span><span class="p">()</span>
                            
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&#39;calc_response_stats&#39; option set to False</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> 
                  <span class="s2">&quot;Response statistics will not be computed&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.calc_responses">
    <p>def <span class="ident">calc_responses</span>(</p><p>self, write_results_to_file=False, results_fName=&#39;ts_results.csv&#39;, verbose=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Responses are obtained by pre-multiplying results by output matrices</p>
<p>Output matrices, together with their names, must be pre-defined via 
<code>DynSys</code> member function <code>AddOutputMtrx()</code> prior to running this 
function.</p>
<p>Where a system consists of multiple subsystems, it should be note that 
output matrices relate to a given subsystem.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.calc_responses', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.calc_responses" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">calc_responses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                   <span class="n">write_results_to_file</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                   <span class="n">results_fName</span><span class="o">=</span><span class="s2">&quot;ts_results.csv&quot;</span><span class="p">,</span>
                   <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Responses are obtained by pre-multiplying results by output matrices</span>
<span class="sd">    </span>
<span class="sd">    Output matrices, together with their names, must be pre-defined via </span>
<span class="sd">    `DynSys` member function `AddOutputMtrx()` prior to running this </span>
<span class="sd">    function.</span>
<span class="sd">    </span>
<span class="sd">    Where a system consists of multiple subsystems, it should be note that </span>
<span class="sd">    output matrices relate to a given subsystem.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">dynsys_obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span>
    <span class="n">responses_list</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="c1"># Calculate responses for all systems and subsystems</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dynsys_obj</span><span class="o">.</span><span class="n">DynSys_list</span><span class="p">:</span>
        
        <span class="n">responses_inner_list</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Retrieve state variables for subsystem</span>
        <span class="n">v</span><span class="p">,</span> <span class="n">vdot</span><span class="p">,</span> <span class="n">v2dot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_results</span><span class="p">(</span><span class="n">x</span><span class="p">,[</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;vdot&#39;</span><span class="p">,</span> <span class="s1">&#39;v2dot&#39;</span><span class="p">])</span>
        <span class="n">state_vector</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">v</span><span class="p">,</span><span class="n">vdot</span><span class="p">,</span><span class="n">v2dot</span><span class="p">))</span>
        
        <span class="c1"># Calculate responses for each set of outputs for this subsystem            </span>
        <span class="k">for</span> <span class="n">_om</span><span class="p">,</span> <span class="n">_names</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">output_mtrx</span><span class="p">,</span><span class="n">x</span><span class="o">.</span><span class="n">output_names</span><span class="p">):</span>
            
            <span class="n">values</span> <span class="o">=</span> <span class="n">_om</span> <span class="err">@</span> <span class="n">state_vector</span>
                            
            <span class="n">obj</span> <span class="o">=</span> <span class="n">TimeSeries_Results</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="n">_names</span><span class="p">,</span>
                                     <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span>
                                     <span class="n">tstep_results_obj</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
            
            <span class="n">responses_inner_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            
        <span class="n">responses_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">responses_inner_list</span><span class="p">)</span>
        
    <span class="c1"># Store as attributes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">response_results</span> <span class="o">=</span> <span class="n">responses_list</span>
            
    <span class="c1"># Calculate DOF statistics</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;calc_dof_stats&#39;</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc_dof_stats</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        
    <span class="c1"># Calculate response statistics</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;calc_response_stats&#39;</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc_response_stats</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        
    <span class="c1"># Write time series results to file</span>
    <span class="k">if</span> <span class="n">write_results_to_file</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">WriteResults2File</span><span class="p">(</span><span class="n">output_fName</span><span class="o">=</span><span class="n">results_fName</span><span class="p">)</span>
            
    <span class="c1"># Delete DOF time series data (to free-up memory)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;retain_dof_values&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Clearing DOF time series data to save memory...&quot;</span><span class="p">)</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">vdot</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">v2dot</span>
    
    <span class="c1"># Delete response time series data (to free up memory)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;retain_response_values&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Clearing response time series data to save memory...&quot;</span><span class="p">)</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">responses_results</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.get_dof_stats_df">
    <p>def <span class="ident">get_dof_stats_df</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns dof stats as Pandas dataframe</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.get_dof_stats_df', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.get_dof_stats_df" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_dof_stats_df</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns dof stats as Pandas dataframe</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">get_stats_df</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">prefix</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
        <span class="n">stats_dict</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">stats</span>
        <span class="n">names</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">names</span>
        <span class="k">print</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">stats_dict</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span>
    
    <span class="n">df_list</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_stats_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f_obj</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">))</span>
    <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_stats_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v_obj</span><span class="p">,</span><span class="s1">&#39;disp&#39;</span><span class="p">))</span>
    <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_stats_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vdot_obj</span><span class="p">,</span><span class="s1">&#39;vel&#39;</span><span class="p">))</span>
    <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_stats_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2dot_obj</span><span class="p">,</span><span class="s1">&#39;acc&#39;</span><span class="p">))</span>
    <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_stats_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f_constraint_obj</span><span class="p">,</span><span class="s1">&#39;f_constraint&#39;</span><span class="p">))</span>
        
    <span class="k">return</span> <span class="n">df_list</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.get_response_stats_df">
    <p>def <span class="ident">get_response_stats_df</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns response stats as list of Pandas dataframes</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.get_response_stats_df', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.get_response_stats_df" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_response_stats_df</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns response stats as list of Pandas dataframes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">df_list</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">dynsys_obj</span><span class="p">,</span> <span class="n">results_obj_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DynSys_list</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">response_results</span><span class="p">):</span>
                
        <span class="k">for</span> <span class="n">results_obj</span> <span class="ow">in</span> <span class="n">results_obj_list</span><span class="p">:</span>
        
            <span class="n">response_names</span> <span class="o">=</span> <span class="n">results_obj</span><span class="o">.</span><span class="n">names</span>
            <span class="n">stats_dict</span> <span class="o">=</span> <span class="n">results_obj</span><span class="o">.</span><span class="n">stats</span>
            <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">stats_dict</span><span class="p">,</span>
                                            <span class="n">index</span><span class="o">=</span><span class="n">response_names</span><span class="p">))</span>
        
    <span class="k">return</span> <span class="n">df_list</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.get_results">
    <p>def <span class="ident">get_results</span>(</p><p>self, dynsys_obj, attr_list)</p>
    </div>
    

    
  
    <div class="desc"><p>Retrieves results for a given DynSys object, which is assumed to be a 
subsystem of the parent system (this is checked)</p>
<hr />
<p>Required:</p>
<ul>
<li>
<p><code>dynsys_obj</code>, instance of DynSys class; must be a subsystem of the 
  parent system</p>
</li>
<li>
<p><code>attr_list</code>, list of strings, to denote the results attributes to be 
  returned</p>
</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.get_results', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.get_results" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dynsys_obj</span><span class="p">,</span><span class="n">attr_list</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves results for a given DynSys object, which is assumed to be a </span>
<span class="sd">    subsystem of the parent system (this is checked)</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    Required:</span>
<span class="sd">        </span>
<span class="sd">    * `dynsys_obj`, instance of DynSys class; must be a subsystem of the </span>
<span class="sd">      parent system</span>
<span class="sd">      </span>
<span class="sd">    * `attr_list`, list of strings, to denote the results attributes to be </span>
<span class="sd">      returned</span>
<span class="sd">     </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Convert to list if single argument provided</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attr_list</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
        <span class="n">attr_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">attr_list</span><span class="p">)</span>
    
    <span class="c1"># Check that dynsys_obj is part of the system that has been analysed</span>
    <span class="n">parent_sys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span>
    <span class="n">DynSys_list</span> <span class="o">=</span> <span class="n">parent_sys</span><span class="o">.</span><span class="n">DynSys_list</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">dynsys_obj</span> <span class="ow">in</span> <span class="n">DynSys_list</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`dynsys_obj` is not a subsystem &quot;</span> <span class="o">+</span> 
                         <span class="s2">&quot;of the parent system that has been analysed!&quot;</span><span class="p">)</span>
    
    <span class="c1"># Determine splice indices to use to get results relating to requested system </span>
    <span class="n">sys_index</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">DynSys_list</span><span class="p">)</span> <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">dynsys_obj</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">nDOF_list_cum</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">cumsum</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">nDOF</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">DynSys_list</span><span class="p">])</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="n">sys_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">startIndex</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">startIndex</span> <span class="o">=</span> <span class="n">nDOF_list_cum</span><span class="p">[</span><span class="n">sys_index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="n">endIndex</span> <span class="o">=</span> <span class="n">nDOF_list_cum</span><span class="p">[</span><span class="n">sys_index</span><span class="p">]</span> 
    
    <span class="c1"># Loop through to return requested attributes</span>
    <span class="n">vals_list</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attr_list</span><span class="p">:</span>
        
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">attr</span><span class="p">):</span>
            
            <span class="n">vals</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>             <span class="c1"># for full system</span>
            
            <span class="k">if</span> <span class="n">attr</span> <span class="o">!=</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span>
                <span class="n">vals</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">startIndex</span><span class="p">:</span><span class="n">endIndex</span><span class="p">,:]</span>    <span class="c1"># for subsystem requested</span>
            
            <span class="n">vals_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not retrieve requested attribute &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">attr</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">vals_list</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.plot_response_results">
    <p>def <span class="ident">plot_response_results</span>(</p><p>self, dynsys_obj=None, verbose=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Produces a new figure with linked time series subplots for 
all responses/outputs</p>
<hr />
<p><strong>Optional:</strong></p>
<ul>
<li><code>dynsys_obj</code>, can be used to specify the subsystem for which results 
  which should be plotted. If <em>None</em> then results for all freedoms 
  (i.e. all subsystems) will be plotted.</li>
</ul>
<hr />
<p><strong>Returns:</strong></p>
<p>Nested list of figure objects</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.plot_response_results', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.plot_response_results" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">plot_response_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                          <span class="n">dynsys_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                          <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Produces a new figure with linked time series subplots for </span>
<span class="sd">    all responses/outputs</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    **Optional:**</span>
<span class="sd">        </span>
<span class="sd">    * `dynsys_obj`, can be used to specify the subsystem for which results </span>
<span class="sd">      which should be plotted. If _None_ then results for all freedoms </span>
<span class="sd">      (i.e. all subsystems) will be plotted.</span>
<span class="sd">      </span>
<span class="sd">    ***</span>
<span class="sd">    **Returns:**</span>
<span class="sd">     </span>
<span class="sd">    Nested list of figure objects</span>
<span class="sd">      </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Preparing response results plots...&quot;</span><span class="p">)</span>
        <span class="n">tic</span><span class="o">=</span><span class="n">timeit</span><span class="o">.</span><span class="n">default_timer</span><span class="p">()</span>
        
    <span class="c1"># Get subsystems to iterate over</span>
    <span class="n">DynSys_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DynSys_list</span>
    <span class="k">if</span> <span class="n">dynsys_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">dynsys_obj</span> <span class="ow">in</span> <span class="n">DynSys_list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`dynsys_obj` not in DynSys_list!&quot;</span><span class="p">)</span>
            
        <span class="n">DynSys_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">dynsys_obj</span><span class="p">]</span>

    <span class="c1"># Iterate over all responses for all specified subsystems</span>
    
    <span class="n">fig_list</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="c1"># Loop over all specified subsystems</span>
    <span class="k">for</span> <span class="n">dynsys_obj</span><span class="p">,</span> <span class="n">response_obj_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">DynSys_list</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">response_results</span><span class="p">):</span>
        
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;   Plotting responses results for &#39;{0}&#39;...&quot;</span>
              <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        
        <span class="n">fig_list_inner</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Iterate over all responses for this subsystem</span>
        <span class="k">for</span> <span class="n">response_results_obj</span> <span class="ow">in</span> <span class="n">response_obj_list</span><span class="p">:</span>
            
            <span class="n">fig_list_inner</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">response_results_obj</span><span class="o">.</span><span class="n">plot</span><span class="p">())</span>
            
        <span class="n">fig_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig_list_inner</span><span class="p">)</span>
            
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="n">toc</span><span class="o">=</span><span class="n">timeit</span><span class="o">.</span><span class="n">default_timer</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Plots prepared after </span><span class="si">%.3f</span><span class="s2"> seconds.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">toc</span><span class="o">-</span><span class="n">tic</span><span class="p">))</span>
        
    <span class="k">return</span> <span class="n">fig_list</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.plot_results">
    <p>def <span class="ident">plot_results</span>(</p><p>self, dynsys_obj=None, verbose=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Presents the results of time-stepping analysis by producing the 
following plots:</p>
<ul>
<li>
<p>State results plot: refer <code>PlotStateResults()</code></p>
</li>
<li>
<p>Response results plot: refer <code>PlotResponseResults()</code></p>
</li>
</ul>
<hr />
<p><strong>Optional:</strong></p>
<ul>
<li>
<p><code>dynsys_obj</code>, object specifying system whose results are to be 
  plotted. If <em>None</em> plots will be produced for all systems. </p>
</li>
<li>
<p><code>verbose</code>, <em>boolean</em>, if True progress will be written to console</p>
</li>
<li>
<p><code>dof2Plot</code>, <em>list</em> of integers to denote DOFs to plot. Can be used to 
  produce a 'cleaner' plot, in case of large numbers of DOFs. Note will 
  only work in conjunction with <code>dynsys_obj</code>, i.e. subsystem must also 
  be selected</p>
</li>
</ul>
<hr />
<p><strong>Returns:</strong></p>
<p><em>List</em> of figure objects</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.plot_results', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.plot_results" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">plot_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">dynsys_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">verbose</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Presents the results of time-stepping analysis by producing the </span>
<span class="sd">    following plots:</span>
<span class="sd">    </span>
<span class="sd">    * State results plot: refer `PlotStateResults()`</span>
<span class="sd">    </span>
<span class="sd">    * Response results plot: refer `PlotResponseResults()`</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    **Optional:**</span>
<span class="sd">        </span>
<span class="sd">    * `dynsys_obj`, object specifying system whose results are to be </span>
<span class="sd">      plotted. If _None_ plots will be produced for all systems. </span>
<span class="sd">    </span>
<span class="sd">    * `verbose`, _boolean_, if True progress will be written to console</span>
<span class="sd">    </span>
<span class="sd">    * `dof2Plot`, _list_ of integers to denote DOFs to plot. Can be used to </span>
<span class="sd">      produce a &#39;cleaner&#39; plot, in case of large numbers of DOFs. Note will </span>
<span class="sd">      only work in conjunction with `dynsys_obj`, i.e. subsystem must also </span>
<span class="sd">      be selected</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    **Returns:**</span>
<span class="sd">    </span>
<span class="sd">    _List_ of figure objects</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">state_fig_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_state_results</span><span class="p">(</span><span class="n">dynsys_obj</span><span class="o">=</span><span class="n">dynsys_obj</span><span class="p">,</span>
                                             <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
    
    <span class="n">response_fig_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_response_results</span><span class="p">(</span><span class="n">dynsys_obj</span><span class="o">=</span><span class="n">dynsys_obj</span><span class="p">,</span>
                                                   <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">state_fig_list</span><span class="p">,</span> <span class="n">response_fig_list</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TStep_Results.plot_state_results">
    <p>def <span class="ident">plot_state_results</span>(</p><p>self, dynsys_obj=None, verbose=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Produces time series plots of the following, as subplots in a single 
figure:</p>
<ul>
<li>
<p>Applied external forces</p>
</li>
<li>
<p>Displacements</p>
</li>
<li>
<p>Velocities</p>
</li>
<li>
<p>Accelerations</p>
</li>
<li>
<p>Constraint forces (only if constraint equations defined)</p>
</li>
</ul>
<p>Note all results plotted relate to the <em>analysis freedoms</em>.</p>
<p>For systems composed of multiple subsystems, one figure will be 
produced for each subsystem.</p>
<hr />
<hr />
<p><strong>Optional:</strong></p>
<ul>
<li>
<p><code>dynsys_obj</code>, can be used to specify the subsystem for which results 
  which should be plotted. If <em>None</em> then results for all freedoms 
  (i.e. all subsystems) will be plotted.</p>
</li>
<li>
<p><code>verbose</code>, <em>boolean</em>, if True text will be written to console</p>
</li>
</ul>
<hr />
<p><strong>Returns:</strong></p>
<p><em>List</em> of figure objects</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TStep_Results.plot_state_results', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TStep_Results.plot_state_results" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">plot_state_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">dynsys_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Produces time series plots of the following, as subplots in a single </span>
<span class="sd">    figure:</span>
<span class="sd">        </span>
<span class="sd">    * Applied external forces</span>
<span class="sd">    </span>
<span class="sd">    * Displacements</span>
<span class="sd">    </span>
<span class="sd">    * Velocities</span>
<span class="sd">    </span>
<span class="sd">    * Accelerations</span>
<span class="sd">    </span>
<span class="sd">    * Constraint forces (only if constraint equations defined)</span>
<span class="sd">    </span>
<span class="sd">    Note all results plotted relate to the _analysis freedoms_.</span>
<span class="sd">    </span>
<span class="sd">    For systems composed of multiple subsystems, one figure will be </span>
<span class="sd">    produced for each subsystem.</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    ***</span>
<span class="sd">    **Optional:**</span>
<span class="sd">        </span>
<span class="sd">    * `dynsys_obj`, can be used to specify the subsystem for which results </span>
<span class="sd">      which should be plotted. If _None_ then results for all freedoms </span>
<span class="sd">      (i.e. all subsystems) will be plotted.</span>
<span class="sd">      </span>
<span class="sd">    * `verbose`, _boolean_, if True text will be written to console</span>
<span class="sd">      </span>
<span class="sd">    ***</span>
<span class="sd">    **Returns:**</span>
<span class="sd">    </span>
<span class="sd">    _List_ of figure objects</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Preparing state results plot...&quot;</span><span class="p">)</span>
        <span class="n">tic</span><span class="o">=</span><span class="n">timeit</span><span class="o">.</span><span class="n">default_timer</span><span class="p">()</span>
        
    <span class="c1"># Get subsystems to iterate over</span>
    <span class="n">DynSys_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">DynSys_list</span>
    <span class="k">if</span> <span class="n">dynsys_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">dynsys_obj</span> <span class="ow">in</span> <span class="n">DynSys_list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`dynsys_obj` not in DynSys_list!&quot;</span><span class="p">)</span>
            
        <span class="n">DynSys_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">dynsys_obj</span><span class="p">]</span>
    
    <span class="c1"># Iterate over all subsystems, producing figure for each</span>
    <span class="n">fig_list</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">DynSys_list</span><span class="p">:</span>
        
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;   Plotting state results for &#39;</span><span class="si">%s</span><span class="s2">&#39;...&quot;</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="c1"># Determine number of subplots required</span>
        <span class="n">hasConstraints</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">hasConstraints</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">hasConstraints</span><span class="p">:</span>
            <span class="n">nPltRows</span><span class="o">=</span><span class="mi">5</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nPltRows</span><span class="o">=</span><span class="mi">4</span>
            
        <span class="c1"># Create plot of results for analysis DOFs</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nPltRows</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
        <span class="n">fig_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    
        <span class="c1"># Set xlim</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">tStart</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">tEnd</span><span class="p">]</span>
        
        <span class="c1"># Get system description string</span>
        <span class="n">sysStr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">DynSys_list</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">DynSys_list</span>
        
        <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">isModal</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">DynSys_list</span><span class="p">]):</span>
            <span class="c1"># All systems and subsystems are modal</span>
            <span class="n">sysStr</span> <span class="o">=</span> <span class="s2">&quot;Modal &quot;</span>
            
         <span class="c1"># Get data to plot   </span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span>
        <span class="n">f</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">vdot</span><span class="p">,</span><span class="n">v2dot</span><span class="p">,</span><span class="n">f_constraint</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_results</span><span class="p">(</span><span class="n">obj</span><span class="p">,[</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;v&#39;</span><span class="p">,</span>
                                                           <span class="s1">&#39;vdot&#39;</span><span class="p">,</span><span class="s1">&#39;v2dot&#39;</span><span class="p">,</span>
                                                           <span class="s1">&#39;f_constraint&#39;</span><span class="p">])</span>
        
        <span class="c1"># Create time series plots</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_TimePlot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                       <span class="n">t_vals</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
                       <span class="n">data_vals</span><span class="o">=</span><span class="n">f</span><span class="p">,</span>
                       <span class="n">xlim</span><span class="o">=</span><span class="n">xlim</span><span class="p">,</span>
                       <span class="n">titleStr</span><span class="o">=</span><span class="s2">&quot;Applied </span><span class="si">%s</span><span class="s2">Forces (N)&quot;</span> <span class="o">%</span> <span class="n">sysStr</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_TimePlot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                       <span class="n">t_vals</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
                       <span class="n">data_vals</span><span class="o">=</span><span class="n">v</span><span class="p">,</span>
                       <span class="n">titleStr</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Displacements (m)&quot;</span> <span class="o">%</span> <span class="n">sysStr</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_TimePlot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                       <span class="n">t_vals</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
                       <span class="n">data_vals</span><span class="o">=</span><span class="n">vdot</span><span class="p">,</span>
                       <span class="n">titleStr</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Velocities (m/s)&quot;</span> <span class="o">%</span> <span class="n">sysStr</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_TimePlot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                       <span class="n">t_vals</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
                       <span class="n">data_vals</span><span class="o">=</span><span class="n">v2dot</span><span class="p">,</span>
                       <span class="n">titleStr</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Accelerations ($m/s^2$)&quot;</span> <span class="o">%</span> <span class="n">sysStr</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">hasConstraints</span><span class="p">:</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_TimePlot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
                       <span class="n">t_vals</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
                       <span class="n">data_vals</span><span class="o">=</span><span class="n">f_constraint</span><span class="p">,</span>
                       <span class="n">titleStr</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Constraint forces (N)&quot;</span> <span class="o">%</span> <span class="n">sysStr</span><span class="p">)</span>
            
        <span class="n">axarr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (secs)&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        
        <span class="c1"># Overall title for plot</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;State variable results for &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="n">toc</span><span class="o">=</span><span class="n">timeit</span><span class="o">.</span><span class="n">default_timer</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Plot prepared after </span><span class="si">%.3f</span><span class="s2"> seconds.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">toc</span><span class="o">-</span><span class="n">tic</span><span class="p">))</span>
        
    <span class="k">return</span> <span class="n">fig_list</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="tstep_results.TStep_Results.DynSys_list" class="name">var <span class="ident">DynSys_list</span></p>
            

            
  
    <div class="desc"><p>List of DynSys objects to which results held by this object relate</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.TStep_Results.dof_stats" class="name">var <span class="ident">dof_stats</span></p>
            

            
  
    <div class="desc"><p>Dict of statistics, evaluated over all time steps, for each DOF</p>
<p><em>Set using <code>CalcDOFStats()</code></em></p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.TStep_Results.f" class="name">var <span class="ident">f</span></p>
            

            
  
    <div class="desc"><p>External applied forces</p>
<p>Returns matrix of shape [nSteps,nDOF]</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.TStep_Results.f_constraint" class="name">var <span class="ident">f_constraint</span></p>
            

            
  
    <div class="desc"><p>Internal constraint forces</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.TStep_Results.f_constraint_obj" class="name">var <span class="ident">f_constraint_obj</span></p>
            

            
  
    <div class="desc"><p>Returns <code>TimeSeries_Results()</code> instance used to internally implement
<code>f_constraint</code></p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.TStep_Results.f_obj" class="name">var <span class="ident">f_obj</span></p>
            

            
  
    <div class="desc"><p>Returns <code>TimeSeries_Results()</code> instance used to internally implement
<code>f</code></p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.TStep_Results.nDOF" class="name">var <span class="ident">nDOF</span></p>
            

            
  
    <div class="desc"><p>Number of degrees of freedom for system being analysed</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.TStep_Results.nResults" class="name">var <span class="ident">nResults</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.TStep_Results.options" class="name">var <span class="ident">options</span></p>
            

            
  
    <div class="desc"><p>Dict containing options - refer <strong>init</strong>() docstring for details</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.TStep_Results.response_results" class="name">var <span class="ident">response_results</span></p>
            

            
  
    <div class="desc"><p>List of matrices to which computed responses are recorded 
for each time step</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.TStep_Results.t" class="name">var <span class="ident">t</span></p>
            

            
  
    <div class="desc"><p>Time values for each results time step</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.TStep_Results.tstep_obj" class="name">var <span class="ident">tstep_obj</span></p>
            

            
  
    <div class="desc"><p>Instance of <code>tstep</code> class, to which results relate</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.TStep_Results.v" class="name">var <span class="ident">v</span></p>
            

            
  
    <div class="desc"><p>Displacements of analysis DOFs</p>
<p>Returns matrix of shape [nSteps,nDOF]</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.TStep_Results.v2dot" class="name">var <span class="ident">v2dot</span></p>
            

            
  
    <div class="desc"><p>Accelerations of analysis DOFs</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.TStep_Results.v2dot_obj" class="name">var <span class="ident">v2dot_obj</span></p>
            

            
  
    <div class="desc"><p>Returns <code>TimeSeries_Results()</code> instance used to internally implement
<code>v2dot</code></p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.TStep_Results.v_obj" class="name">var <span class="ident">v_obj</span></p>
            

            
  
    <div class="desc"><p>Returns <code>TimeSeries_Results()</code> instance used to internally implement
<code>v</code></p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.TStep_Results.vdot" class="name">var <span class="ident">vdot</span></p>
            

            
  
    <div class="desc"><p>Velocities of analysis DOFs</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.TStep_Results.vdot_obj" class="name">var <span class="ident">vdot_obj</span></p>
            

            
  
    <div class="desc"><p>Returns <code>TimeSeries_Results()</code> instance used to internally implement
<code>vdot</code></p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="tstep_results.TimeSeries_Results" class="name">class <span class="ident">TimeSeries_Results</span></p>
      
  
    <div class="desc"><p>Class to act as container for time series results, with methods to compute 
statistics etc</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TimeSeries_Results', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TimeSeries_Results" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">TimeSeries_Results</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to act as container for time series results, with methods to compute </span>
<span class="sd">    statistics etc</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">names</span><span class="p">,</span><span class="n">values</span><span class="p">,</span><span class="n">tstep_results_obj</span><span class="p">,</span>
                 <span class="n">location_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">plot_options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;use_common_scale&#39;</span> <span class="p">:</span><span class="bp">True</span><span class="p">}</span>
                 <span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">names</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tstep_results_obj</span> <span class="o">=</span> <span class="n">tstep_results_obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">location_obj</span> <span class="o">=</span> <span class="n">location_obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_options</span> <span class="o">=</span> <span class="n">plot_options</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">dynsys_obj</span> <span class="o">=</span> <span class="n">tstep_results_obj</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_stats_dict</span> <span class="o">=</span> <span class="bp">None</span>
        
        
    <span class="c1"># ----------------</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of names of defined responses</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names</span>
    
    <span class="nd">@names.setter</span>
    <span class="k">def</span> <span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_names</span> <span class="o">=</span> <span class="n">value</span>
    
    <span class="c1"># ----------------</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Time series results</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span>
    
    <span class="nd">@values.setter</span>
    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">value</span>
        
    <span class="c1"># ----------------</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">location_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Location object to which results relate</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_location_obj</span>
    
    <span class="nd">@location_obj.setter</span>
    <span class="k">def</span> <span class="nf">location_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">check_is_class</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_location_obj</span> <span class="o">=</span> <span class="n">obj</span>
        
    <span class="c1"># ----------------</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dict containing statistics dervied from time series results</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stats_dict</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calc_stats</span><span class="p">()</span>
            
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stats_dict</span>
    
    <span class="c1"># Note no setter method - cannot set stats directly!</span>
    <span class="c1"># ----------------</span>
        
    <span class="k">def</span> <span class="nf">calc_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate basis statistics to summarise time series results</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">vals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span>
        
        <span class="c1"># Record stats within a dict</span>
        <span class="n">stats_dict</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">stats_dict</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">stats_dict</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">stats_dict</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">stats_dict</span><span class="p">[</span><span class="s2">&quot;std&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">stats_dict</span><span class="p">[</span><span class="s2">&quot;absmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">_stats_dict</span> <span class="o">=</span> <span class="n">stats_dict</span>
        
        <span class="k">return</span> <span class="n">stats_dict</span>
    
    
   
    
    
    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">axarr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots time series results along with related stats</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">tstep_results_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_results_obj</span>
        <span class="n">tstep_obj</span> <span class="o">=</span> <span class="n">tstep_results_obj</span><span class="o">.</span><span class="n">tstep_obj</span>
        
        <span class="n">nResponses</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">axarr</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nResponses</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="c1"># Get plot options</span>
        <span class="n">use_common_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_options</span><span class="p">[</span><span class="s1">&#39;use_common_scale&#39;</span><span class="p">]</span>
        
        <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;plot_stats&#39;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_options</span><span class="p">,</span><span class="n">attr</span><span class="p">):</span>
            <span class="n">plot_stats</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_options</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plot_stats</span> <span class="o">=</span> <span class="bp">False</span>
        
        <span class="c1"># Get time values and time interval</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">tstep_results_obj</span><span class="o">.</span><span class="n">t</span>
        <span class="n">tInterval</span><span class="o">=</span> <span class="p">[</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">tStart</span><span class="p">,</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">tEnd</span><span class="p">]</span>
        
        <span class="c1"># Determine common scale to use for plots</span>
        
        
        <span class="k">if</span> <span class="n">use_common_scale</span><span class="p">:</span>
            
            <span class="n">maxVal</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
            <span class="n">minVal</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
            <span class="n">absmaxVal</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">maxVal</span><span class="p">,</span><span class="n">minVal</span><span class="p">])</span>
            
        <span class="c1"># Loop through plotting all responses</span>
        
        <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)):</span>
            
            <span class="c1"># Get axis object</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">axarr</span><span class="p">,</span> <span class="s2">&quot;__len__&quot;</span><span class="p">):</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span>
                        
            <span class="c1"># Make time series plot</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">vals</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">plot_stats</span><span class="p">:</span>
                <span class="c1"># Overlay stats if avaliable</span>
                <span class="n">stats_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span>
                
                <span class="k">if</span> <span class="n">stats_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">stats_dict</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">][</span><span class="n">r</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">stats_dict</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">][</span><span class="n">r</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">stats_dict</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">][</span><span class="n">r</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
                                   
            <span class="c1"># Set axis limits and labels</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">tInterval</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="n">nResponses</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">use_common_scale</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="n">absmaxVal</span><span class="p">,</span><span class="o">+</span><span class="n">absmaxVal</span><span class="p">])</span>
            
            <span class="c1"># Create legend</span>
            <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
                
        <span class="k">return</span> <span class="n">fig</span>
        
    
    <span class="k">def</span> <span class="nf">plot_psd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="c1"># Create figure</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
        
        <span class="c1"># Time series plot</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_results_obj</span><span class="o">.</span><span class="n">t</span>
        <span class="n">responses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span>
        <span class="n">response_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span>
        
        <span class="n">handles</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">responses</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">npy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">t</span><span class="p">)])</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Response time series&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (secs)&quot;</span><span class="p">)</span>
        
        <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span><span class="n">response_names</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
        
        <span class="c1"># PSD plot</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">dt</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">periodogram</span><span class="p">(</span><span class="n">responses</span><span class="p">,</span><span class="n">fs</span><span class="p">)</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">Pxx</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">fs</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Periodograms of responses&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency (Hz)&quot;</span><span class="p">)</span>
        
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;System: &#39;{0}&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        
        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>        <span class="c1"># create space for suptitle</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>      <span class="c1"># create space for figlegend</span>
        
        <span class="k">return</span> <span class="n">fig</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#tstep_results.TimeSeries_Results">TimeSeries_Results</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="tstep_results.TimeSeries_Results.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, names, values, tstep_results_obj, location_obj=None, plot_options={&#39;use_common_scale&#39;: True})</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TimeSeries_Results.__init__', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TimeSeries_Results.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">names</span><span class="p">,</span><span class="n">values</span><span class="p">,</span><span class="n">tstep_results_obj</span><span class="p">,</span>
             <span class="n">location_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">plot_options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;use_common_scale&#39;</span> <span class="p">:</span><span class="bp">True</span><span class="p">}</span>
             <span class="p">):</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">names</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tstep_results_obj</span> <span class="o">=</span> <span class="n">tstep_results_obj</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">location_obj</span> <span class="o">=</span> <span class="n">location_obj</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">plot_options</span> <span class="o">=</span> <span class="n">plot_options</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">dynsys_obj</span> <span class="o">=</span> <span class="n">tstep_results_obj</span><span class="o">.</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">dynsys_obj</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">_stats_dict</span> <span class="o">=</span> <span class="bp">None</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TimeSeries_Results.calc_stats">
    <p>def <span class="ident">calc_stats</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculate basis statistics to summarise time series results</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TimeSeries_Results.calc_stats', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TimeSeries_Results.calc_stats" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">calc_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate basis statistics to summarise time series results</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">vals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span>
    
    <span class="c1"># Record stats within a dict</span>
    <span class="n">stats_dict</span><span class="o">=</span><span class="p">{}</span>
    <span class="n">stats_dict</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">stats_dict</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">stats_dict</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">stats_dict</span><span class="p">[</span><span class="s2">&quot;std&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">stats_dict</span><span class="p">[</span><span class="s2">&quot;absmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">_stats_dict</span> <span class="o">=</span> <span class="n">stats_dict</span>
    
    <span class="k">return</span> <span class="n">stats_dict</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TimeSeries_Results.plot">
    <p>def <span class="ident">plot</span>(</p><p>self, axarr=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Plots time series results along with related stats</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TimeSeries_Results.plot', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TimeSeries_Results.plot" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">axarr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots time series results along with related stats</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">tstep_results_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_results_obj</span>
    <span class="n">tstep_obj</span> <span class="o">=</span> <span class="n">tstep_results_obj</span><span class="o">.</span><span class="n">tstep_obj</span>
    
    <span class="n">nResponses</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">axarr</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nResponses</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    
    <span class="c1"># Get plot options</span>
    <span class="n">use_common_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_options</span><span class="p">[</span><span class="s1">&#39;use_common_scale&#39;</span><span class="p">]</span>
    
    <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;plot_stats&#39;</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_options</span><span class="p">,</span><span class="n">attr</span><span class="p">):</span>
        <span class="n">plot_stats</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_options</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plot_stats</span> <span class="o">=</span> <span class="bp">False</span>
    
    <span class="c1"># Get time values and time interval</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">tstep_results_obj</span><span class="o">.</span><span class="n">t</span>
    <span class="n">tInterval</span><span class="o">=</span> <span class="p">[</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">tStart</span><span class="p">,</span><span class="n">tstep_obj</span><span class="o">.</span><span class="n">tEnd</span><span class="p">]</span>
    
    <span class="c1"># Determine common scale to use for plots</span>
    
    
    <span class="k">if</span> <span class="n">use_common_scale</span><span class="p">:</span>
        
        <span class="n">maxVal</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="n">minVal</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="n">absmaxVal</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">maxVal</span><span class="p">,</span><span class="n">minVal</span><span class="p">])</span>
        
    <span class="c1"># Loop through plotting all responses</span>
    
    <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)):</span>
        
        <span class="c1"># Get axis object</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">axarr</span><span class="p">,</span> <span class="s2">&quot;__len__&quot;</span><span class="p">):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span>
                    
        <span class="c1"># Make time series plot</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">vals</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">plot_stats</span><span class="p">:</span>
            <span class="c1"># Overlay stats if avaliable</span>
            <span class="n">stats_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span>
            
            <span class="k">if</span> <span class="n">stats_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">stats_dict</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">][</span><span class="n">r</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">stats_dict</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">][</span><span class="n">r</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">stats_dict</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">][</span><span class="n">r</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
                               
        <span class="c1"># Set axis limits and labels</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">tInterval</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="n">nResponses</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">use_common_scale</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="n">absmaxVal</span><span class="p">,</span><span class="o">+</span><span class="n">absmaxVal</span><span class="p">])</span>
        
        <span class="c1"># Create legend</span>
        <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
            
    <span class="k">return</span> <span class="n">fig</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="tstep_results.TimeSeries_Results.plot_psd">
    <p>def <span class="ident">plot_psd</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-tstep_results.TimeSeries_Results.plot_psd', this);">Show source &equiv;</a></p>
  <div id="source-tstep_results.TimeSeries_Results.plot_psd" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">plot_psd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    
    <span class="c1"># Create figure</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    
    <span class="c1"># Time series plot</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstep_results_obj</span><span class="o">.</span><span class="n">t</span>
    <span class="n">responses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span>
    <span class="n">response_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span>
    
    <span class="n">handles</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">responses</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">npy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">t</span><span class="p">)])</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Response time series&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (secs)&quot;</span><span class="p">)</span>
    
    <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span><span class="n">response_names</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
    
    <span class="c1"># PSD plot</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">dt</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">periodogram</span><span class="p">(</span><span class="n">responses</span><span class="p">,</span><span class="n">fs</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">Pxx</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">fs</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Periodograms of responses&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency (Hz)&quot;</span><span class="p">)</span>
    
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;System: &#39;{0}&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dynsys_obj</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>        <span class="c1"># create space for suptitle</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>      <span class="c1"># create space for figlegend</span>
    
    <span class="k">return</span> <span class="n">fig</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="tstep_results.TimeSeries_Results.dynsys_obj" class="name">var <span class="ident">dynsys_obj</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.TimeSeries_Results.location_obj" class="name">var <span class="ident">location_obj</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.TimeSeries_Results.names" class="name">var <span class="ident">names</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.TimeSeries_Results.plot_options" class="name">var <span class="ident">plot_options</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.TimeSeries_Results.stats" class="name">var <span class="ident">stats</span></p>
            

            
  
    <div class="desc"><p>Dict containing statistics dervied from time series results</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.TimeSeries_Results.tstep_results_obj" class="name">var <span class="ident">tstep_results_obj</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="tstep_results.TimeSeries_Results.values" class="name">var <span class="ident">values</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>