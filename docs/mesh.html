Version: 1.7.2
<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>mesh API documentation</title>
    <meta name="description" content="Class used to defined meshes, i.e. nodes interconnected by elements (lines)" />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">
    <li class="set"><h3><a href="#header-variables">Module variables</a></h3>
      
  <ul>
    <li class="mono"><a href="#mesh.default_y_direction">default_y_direction</a></li>
    <li class="mono"><a href="#mesh.vertical_direction">vertical_direction</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-functions">Functions</a></h3>
      
  <ul>
    <li class="mono"><a href="#mesh.integrate_gauss">integrate_gauss</a></li>
    <li class="mono"><a href="#mesh.integrate_over_mesh">integrate_over_mesh</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#mesh.DispResults">DispResults</a></span>
        
          
  <ul>
    <li class="mono"><a href="#mesh.DispResults.__init__">__init__</a></li>
    <li class="mono"><a href="#mesh.DispResults.add">add</a></li>
    <li class="mono"><a href="#mesh.DispResults.clear">clear</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#mesh.Element">Element</a></span>
        
          
  <ul>
    <li class="mono"><a href="#mesh.Element.__init__">__init__</a></li>
    <li class="mono"><a href="#mesh.Element.connect_nodes">connect_nodes</a></li>
    <li class="mono"><a href="#mesh.Element.define_gauss_points">define_gauss_points</a></li>
    <li class="mono"><a href="#mesh.Element.get_connected_node">get_connected_node</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#mesh.ForceResults">ForceResults</a></span>
        
          
  <ul>
    <li class="mono"><a href="#mesh.ForceResults.__init__">__init__</a></li>
    <li class="mono"><a href="#mesh.ForceResults.add">add</a></li>
    <li class="mono"><a href="#mesh.ForceResults.clear">clear</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#mesh.GaussPoint">GaussPoint</a></span>
        
          
  <ul>
    <li class="mono"><a href="#mesh.GaussPoint.__init__">__init__</a></li>
    <li class="mono"><a href="#mesh.GaussPoint.get_x">get_x</a></li>
    <li class="mono"><a href="#mesh.GaussPoint.get_xyz">get_xyz</a></li>
    <li class="mono"><a href="#mesh.GaussPoint.get_y">get_y</a></li>
    <li class="mono"><a href="#mesh.GaussPoint.get_z">get_z</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#mesh.LineElement">LineElement</a></span>
        
          
  <ul>
    <li class="mono"><a href="#mesh.LineElement.__init__">__init__</a></li>
    <li class="mono"><a href="#mesh.LineElement.connect_nodes">connect_nodes</a></li>
    <li class="mono"><a href="#mesh.LineElement.define_gauss_points">define_gauss_points</a></li>
    <li class="mono"><a href="#mesh.LineElement.get_axes">get_axes</a></li>
    <li class="mono"><a href="#mesh.LineElement.get_connected_node">get_connected_node</a></li>
    <li class="mono"><a href="#mesh.LineElement.get_end_positions">get_end_positions</a></li>
    <li class="mono"><a href="#mesh.LineElement.get_midpoint_xyz">get_midpoint_xyz</a></li>
    <li class="mono"><a href="#mesh.LineElement.length">length</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#mesh.Mesh">Mesh</a></span>
        
          
  <ul>
    <li class="mono"><a href="#mesh.Mesh.__init__">__init__</a></li>
    <li class="mono"><a href="#mesh.Mesh.append_objs">append_objs</a></li>
    <li class="mono"><a href="#mesh.Mesh.calc_extents">calc_extents</a></li>
    <li class="mono"><a href="#mesh.Mesh.define_gauss_points">define_gauss_points</a></li>
    <li class="mono"><a href="#mesh.Mesh.define_line_elements">define_line_elements</a></li>
    <li class="mono"><a href="#mesh.Mesh.define_nodes">define_nodes</a></li>
    <li class="mono"><a href="#mesh.Mesh.get_connected_meshes">get_connected_meshes</a></li>
    <li class="mono"><a href="#mesh.Mesh.get_gauss_points">get_gauss_points</a></li>
    <li class="mono"><a href="#mesh.Mesh.has_elements">has_elements</a></li>
    <li class="mono"><a href="#mesh.Mesh.has_nodes">has_nodes</a></li>
    <li class="mono"><a href="#mesh.Mesh.plot">plot</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#mesh.MeshChain">MeshChain</a></span>
        
          
  <ul>
    <li class="mono"><a href="#mesh.MeshChain.__init__">__init__</a></li>
    <li class="mono"><a href="#mesh.MeshChain.append_objs">append_objs</a></li>
    <li class="mono"><a href="#mesh.MeshChain.calc_extents">calc_extents</a></li>
    <li class="mono"><a href="#mesh.MeshChain.define_gauss_points">define_gauss_points</a></li>
    <li class="mono"><a href="#mesh.MeshChain.define_line_elements">define_line_elements</a></li>
    <li class="mono"><a href="#mesh.MeshChain.define_nodes">define_nodes</a></li>
    <li class="mono"><a href="#mesh.MeshChain.get_connected_meshes">get_connected_meshes</a></li>
    <li class="mono"><a href="#mesh.MeshChain.get_gauss_points">get_gauss_points</a></li>
    <li class="mono"><a href="#mesh.MeshChain.has_elements">has_elements</a></li>
    <li class="mono"><a href="#mesh.MeshChain.has_nodes">has_nodes</a></li>
    <li class="mono"><a href="#mesh.MeshChain.plot">plot</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#mesh.MeshResults">MeshResults</a></span>
        
          
  <ul>
    <li class="mono"><a href="#mesh.MeshResults.__init__">__init__</a></li>
    <li class="mono"><a href="#mesh.MeshResults.add">add</a></li>
    <li class="mono"><a href="#mesh.MeshResults.clear">clear</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#mesh.Node">Node</a></span>
        
          
  <ul>
    <li class="mono"><a href="#mesh.Node.__init__">__init__</a></li>
    <li class="mono"><a href="#mesh.Node.connect_elements">connect_elements</a></li>
    <li class="mono"><a href="#mesh.Node.get_x">get_x</a></li>
    <li class="mono"><a href="#mesh.Node.get_xyz">get_xyz</a></li>
    <li class="mono"><a href="#mesh.Node.get_y">get_y</a></li>
    <li class="mono"><a href="#mesh.Node.get_z">get_z</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#mesh.Point">Point</a></span>
        
          
  <ul>
    <li class="mono"><a href="#mesh.Point.__init__">__init__</a></li>
    <li class="mono"><a href="#mesh.Point.get_x">get_x</a></li>
    <li class="mono"><a href="#mesh.Point.get_xyz">get_xyz</a></li>
    <li class="mono"><a href="#mesh.Point.get_y">get_y</a></li>
    <li class="mono"><a href="#mesh.Point.get_z">get_z</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#mesh.ReactionResults">ReactionResults</a></span>
        
          
  <ul>
    <li class="mono"><a href="#mesh.ReactionResults.__init__">__init__</a></li>
    <li class="mono"><a href="#mesh.ReactionResults.add">add</a></li>
    <li class="mono"><a href="#mesh.ReactionResults.clear">clear</a></li>
  </ul>

        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">mesh</span> module</h1>
  <p>Class used to defined meshes, i.e. nodes interconnected by elements (lines)</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh', this);">Show source &equiv;</a></p>
  <div id="source-mesh" class="source">
    <div class="codehilite"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Class used to defined meshes, i.e. nodes interconnected by elements (lines)</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># Library imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">npy</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">count</span>
<span class="kn">from</span> <span class="nn">inspect</span> <span class="kn">import</span> <span class="n">getmro</span>
<span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">from</span> <span class="nn">common</span> <span class="kn">import</span> <span class="n">check_class</span><span class="p">,</span> <span class="n">set_equal_aspect_3d</span>

<span class="n">vertical_direction</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">default_y_direction</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">])</span>


<span class="k">class</span> <span class="nc">Mesh</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class is used to define a mesh, i.e. nodes inter-connected by elements</span>
<span class="sd">    </span>
<span class="sd">    Meshes of meshes are also permissible</span>
<span class="sd">    &quot;&quot;&quot;</span>
        
    <span class="c1"># Class properties</span>
    <span class="n">_ids</span> <span class="o">=</span> <span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># used to assign IDs to objects</span>
    
    <span class="c1"># Class methods</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">mesh_objs</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="p">[],</span>
                 <span class="n">node_objs</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="p">[],</span>
                 <span class="n">element_objs</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialises mesh with sub-meshes, nodes and elements</span>
<span class="sd">        </span>
<span class="sd">        These can be passed in via dicts `mesh_objs`, `node_objs` and </span>
<span class="sd">        `element_objs` or alternatively be appended once object initialised </span>
<span class="sd">        using class methods provided for the purpose</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ids</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sequential integer ID, assigned to uniquely identify object</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Mesh </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        User-assigned name, usually of _string_ type</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Create empty dictionary attributes to contain objects within</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_objs</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="p">:</span> <span class="bp">self</span><span class="p">}</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dict of mesh objects related to this mesh. Will always include `self` </span>
<span class="sd">        but also any sub-meshes defined. Keys are names of each mesh</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">node_objs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dict of node objects directly related to this mesh. Keys are names of </span>
<span class="sd">        each node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">element_objs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dict of element objects directly related to this mesh. Keys are names </span>
<span class="sd">        of each node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Append objects passed-in via lists</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append_objs</span><span class="p">(</span><span class="n">mesh_objs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append_objs</span><span class="p">(</span><span class="n">element_objs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append_objs</span><span class="p">(</span><span class="n">node_objs</span><span class="p">)</span>
        
        
    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">calc_extents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine xyz extents of mesh</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Get list mesh objects to include in extent calculation</span>
        <span class="n">mesh_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connected_meshes</span><span class="p">(</span><span class="n">get_full_tree</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

        <span class="c1"># Loop over all nodes in all meshes</span>
        <span class="n">node_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">mesh_obj</span> <span class="ow">in</span> <span class="n">mesh_list</span><span class="p">:</span>
            
            <span class="n">node_list</span> <span class="o">=</span> <span class="n">mesh_obj</span><span class="o">.</span><span class="n">node_objs</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            
            <span class="k">for</span> <span class="n">node_obj</span> <span class="ow">in</span> <span class="n">node_list</span><span class="p">:</span>
               
                <span class="n">node_count</span> <span class="o">+=</span> <span class="mi">1</span>                
                <span class="n">xyz_vals</span><span class="o">=</span><span class="n">node_obj</span><span class="o">.</span><span class="n">get_xyz</span><span class="p">()</span>
                
                <span class="k">if</span> <span class="n">node_count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">xyz_min</span> <span class="o">=</span> <span class="n">xyz_vals</span>
                    <span class="n">xyz_max</span> <span class="o">=</span> <span class="n">xyz_vals</span>
                
                <span class="n">xyz_min</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">xyz_min</span><span class="p">,</span><span class="n">xyz_vals</span><span class="p">)</span>
                <span class="n">xyz_max</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">xyz_max</span><span class="p">,</span><span class="n">xyz_vals</span><span class="p">)</span>
                  
        <span class="k">if</span> <span class="n">node_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    
            <span class="c1"># Reshape into nested list</span>
            <span class="n">xyz_lim</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">xyz_min</span><span class="p">,</span><span class="n">xyz_max</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">xyz_lim</span>
                    
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Warning: mesh &#39;</span><span class="si">%s</span><span class="s2">&#39; does not have any nodes!</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> 
                  <span class="s2">&quot;Could not evaluate mesh extents&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">None</span>
        
    
    <span class="k">def</span> <span class="nf">append_objs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj_list</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Append objects to mesh</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># create list in case of single object input</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj_list</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">):</span>
            <span class="n">obj_list</span><span class="o">=</span><span class="p">[</span><span class="n">obj_list</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">obj_list</span><span class="p">:</span>
          
            <span class="c1"># Create link to this mesh object, to which object now belongs</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">parent_mesh</span><span class="o">=</span><span class="bp">self</span> 
    
            <span class="c1"># Add new objects to dictionaries according to class</span>
            <span class="n">class_name_list</span> <span class="o">=</span> <span class="n">getmro</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">Mesh</span> <span class="ow">in</span> <span class="n">class_name_list</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mesh_objs</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
                
            <span class="k">elif</span> <span class="n">Element</span> <span class="ow">in</span> <span class="n">class_name_list</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">element_objs</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
                
            <span class="k">elif</span> <span class="n">Node</span> <span class="ow">in</span> <span class="n">class_name_list</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">node_objs</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
            
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unexpected object!</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">+</span> 
                                 <span class="s2">&quot;Class list{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">class_name_list</span><span class="p">))</span>
            
            
    <span class="k">def</span> <span class="nf">define_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">df</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">fname</span><span class="o">=</span><span class="s1">&#39;nodes.csv&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to define nodes from tabulated input</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Pandas Dataframe containing the following columns to be provided:</span>
<span class="sd">        </span>
<span class="sd">        | Node | X   | Y   | Z   | </span>
<span class="sd">        | ...  | ... | ... | ... | </span>
<span class="sd">        </span>
<span class="sd">        or alternatively `fName` defines .csv file containing similar input</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Use pandas to read in data as dataframe</span>
        <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span>
                                 <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                 <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">],</span>
                                 <span class="n">index_col</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                                 <span class="n">converters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Node&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">},</span>
                                 <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="c1"># Loop through rows in dataframe</span>
        <span class="n">node_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            
            <span class="c1"># Define new node object</span>
            <span class="n">new_node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">parent_mesh</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Node&quot;</span><span class="p">],</span>
                            <span class="n">xyz</span><span class="o">=</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]])</span>
            
            <span class="n">node_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_node</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">append_objs</span><span class="p">(</span><span class="n">node_list</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">node_list</span>
    
            
    <span class="k">def</span> <span class="nf">define_line_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">df</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">fname</span><span class="o">=</span><span class="s2">&quot;elements.csv&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to read element connectivity from tabulated input</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Pandas Dataframe containing the following columns to be provided:</span>
<span class="sd">        </span>
<span class="sd">        | Member | EndJ  | EndK  |</span>
<span class="sd">        | ...    | ...   | ...   |</span>
<span class="sd">        </span>
<span class="sd">        or alternatively `fName` defines .csv file containing similar input</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Use pandas to read in data as dataframe</span>
        <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                                 <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            
        <span class="c1"># Loop throuh rows in dataframe</span>
        <span class="n">element_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            
            <span class="c1"># Get node objects for each end</span>
            <span class="n">node1_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_objs</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;EndJ&quot;</span><span class="p">]]</span>
            <span class="n">node2_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_objs</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;EndK&quot;</span><span class="p">]]</span>
            
            <span class="c1"># Define new line element</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="n">LineElement</span><span class="p">(</span><span class="n">parent_mesh</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                              <span class="n">name</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;Member&quot;</span><span class="p">],</span>
                              <span class="n">connected_nodes</span><span class="o">=</span><span class="p">[</span><span class="n">node1_obj</span><span class="p">,</span><span class="n">node2_obj</span><span class="p">])</span>
            
            <span class="n">element_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_obj</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">append_objs</span><span class="p">(</span><span class="n">element_list</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">element_list</span>
    
    
    <span class="k">def</span> <span class="nf">define_gauss_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">N_gp</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loops over all elements in mesh, defining gauss points</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">element_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_objs</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">N_gp</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">N_gp</span><span class="p">)</span><span class="o">!=</span><span class="nb">len</span><span class="p">(</span><span class="n">element_list</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Length of `N_gp` list does not agree &quot;</span> <span class="o">+</span> 
                                 <span class="s2">&quot;with total number of elements&quot;</span><span class="p">)</span>
                
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">N_gp</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`N_gp` to be either `int` or `list`&quot;</span><span class="p">)</span>
                
                        
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">element_obj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">element_list</span><span class="p">):</span>
            
            <span class="c1"># Determine number of gauss points required for this element</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">N_gp</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">n</span> <span class="o">=</span> <span class="n">N_gp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                
            <span class="k">else</span><span class="p">:</span>
                <span class="n">n</span> <span class="o">=</span> <span class="n">N_gp</span>
                
            <span class="c1"># Define gps</span>
            <span class="n">element_obj</span><span class="o">.</span><span class="n">define_gauss_points</span><span class="p">(</span><span class="n">N_gp</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
    
    
    <span class="k">def</span> <span class="nf">get_connected_meshes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">get_full_tree</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns list including all mesh objects associated with mesh object </span>
<span class="sd">        </span>
<span class="sd">        Optional:</span>
<span class="sd">            </span>
<span class="sd">        * `get_full_tree`, _boolean_, if True then full mesh tree will be </span>
<span class="sd">          returned. If False (default) then only meshes which are sub-meshes to </span>
<span class="sd">          _self_ will be returned</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">mesh_obj</span><span class="p">,</span> <span class="n">visited</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">add_parent</span><span class="o">=</span><span class="n">get_full_tree</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Method to implement depth-first search through mesh tree</span>
<span class="sd">            &quot;&quot;&quot;</span>
        
            <span class="k">if</span> <span class="n">visited</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            
            <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">mesh_obj</span><span class="p">)</span>
                
            <span class="c1"># Get adjacency list for current mesh object</span>
            <span class="n">connected_meshes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mesh_obj</span><span class="o">.</span><span class="n">mesh_objs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            
            <span class="k">if</span> <span class="n">add_parent</span><span class="p">:</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="s1">&#39;parent_mesh&#39;</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">mesh_obj</span><span class="p">,</span><span class="n">attr</span><span class="p">):</span>
                    <span class="n">connected_meshes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">mesh_obj</span><span class="p">,</span><span class="n">attr</span><span class="p">))</span>
                
            <span class="c1"># Recursively run function if current mesh object not in visited set</span>
            <span class="k">for</span> <span class="nb">next</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">connected_meshes</span><span class="p">)</span> <span class="o">-</span> <span class="n">visited</span><span class="p">:</span>
                <span class="n">dfs</span><span class="p">(</span><span class="nb">next</span><span class="p">,</span> <span class="n">visited</span><span class="o">=</span><span class="n">visited</span><span class="p">,</span> <span class="n">add_parent</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                
            <span class="k">return</span> <span class="n">visited</span>
    
        <span class="n">mesh_obj_list</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mesh_obj_list</span>


    <span class="k">def</span> <span class="nf">get_gauss_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns all nested list to describe all gauss points associated with </span>
<span class="sd">        mesh via its elements</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gp_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_objs</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">gp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">gauss_points</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gp_list</span>

    
    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">set_axis_limits</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
             <span class="n">set_square_axes</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
             <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots mesh and all sub-meshes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Plotting mesh &#39;</span><span class="si">%s</span><span class="s2">&#39;...&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
        <span class="c1"># Get list of all related meshes</span>
        <span class="n">mesh_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connected_meshes</span><span class="p">(</span><span class="n">get_full_tree</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">mesh_obj</span> <span class="ow">in</span> <span class="n">mesh_list</span><span class="p">:</span>
                
            <span class="n">ax</span> <span class="o">=</span> <span class="n">mesh_obj</span><span class="o">.</span><span class="n">_plot_init</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">mesh_obj</span><span class="o">.</span><span class="n">_plot_update</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">set_axis_limits</span><span class="p">:</span>
            
            <span class="n">axis_limits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_extents</span><span class="p">()</span>
                            
            <span class="k">if</span> <span class="ow">not</span> <span class="n">set_square_axes</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">axis_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">axis_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="n">axis_limits</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                
            <span class="k">else</span><span class="p">:</span>
                
                <span class="c1"># Draw hidden line to ensure proper scaling of axes</span>
                <span class="n">set_equal_aspect_3d</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">axis_limits</span><span class="p">)</span>
                
        
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">ax</span>
    
    
    <span class="k">def</span> <span class="nf">_plot_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">plot_gps</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">plot_axes</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialises mesh plot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
        
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;X (m)&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Y (m)&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span>
        
        <span class="c1"># Define plot artists (n.b. data set in plot_update)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="s1">&#39;elements&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],[],</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="s1">&#39;nodes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],[],</span><span class="s1">&#39;k.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">plot_gps</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="s1">&#39;gauss_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],[],</span><span class="s1">&#39;g.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            
        <span class="k">if</span> <span class="n">plot_axes</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="s1">&#39;x_axes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">([],[],[],</span>
                                                     <span class="p">[],[],[],</span>
                                                     <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                                                     <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="s1">&#39;y_axes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">([],[],[],</span>
                                                     <span class="p">[],[],[],</span>
                                                     <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                                                     <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="s1">&#39;z_axes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">([],[],[],</span>
                                                     <span class="p">[],[],[],</span>
                                                     <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                                                     <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">ax</span>
    
    
    <span class="k">def</span> <span class="nf">_plot_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates mesh plot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Plot all nodes</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_nodes</span><span class="p">():</span>
            
            <span class="n">node_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_objs</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="n">XYZ</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">obj</span><span class="o">.</span><span class="n">xyz</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">node_list</span><span class="p">])</span>
            
            <span class="n">node_artist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="s1">&#39;nodes&#39;</span><span class="p">]</span>
            <span class="n">node_artist</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">XYZ</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">XYZ</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">node_artist</span><span class="o">.</span><span class="n">set_3d_properties</span><span class="p">(</span><span class="n">XYZ</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>
        
        <span class="c1"># Plot all elements</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_elements</span><span class="p">():</span>
            
            <span class="n">element_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_objs</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            
            <span class="n">xyz_end1</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">element_obj</span><span class="o">.</span><span class="n">connected_nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_xyz</span><span class="p">()</span> 
                                 <span class="k">for</span> <span class="n">element_obj</span> <span class="ow">in</span> <span class="n">element_list</span><span class="p">])</span>
            
            <span class="n">xyz_end2</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">element_obj</span><span class="o">.</span><span class="n">connected_nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_xyz</span><span class="p">()</span> 
                                 <span class="k">for</span> <span class="n">element_obj</span> <span class="ow">in</span> <span class="n">element_list</span><span class="p">])</span>
        
            <span class="n">nan</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">element_list</span><span class="p">),),</span><span class="n">npy</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span> <span class="c1"># used to create gaps</span>
            
            <span class="n">X</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">xyz_end1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">xyz_end2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">nan</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
            <span class="n">Y</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">xyz_end1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">xyz_end2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">nan</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
            <span class="n">Z</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">xyz_end1</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">xyz_end2</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">nan</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        
            <span class="n">elements</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="s1">&#39;elements&#39;</span><span class="p">]</span>
            <span class="n">elements</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
            <span class="n">elements</span><span class="o">.</span><span class="n">set_3d_properties</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
            <span class="n">elements</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        
        <span class="c1"># Plot gauss points</span>
        <span class="n">attr</span> <span class="o">=</span> <span class="s1">&#39;gauss_points&#39;</span>
        <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">:</span>
            
            <span class="n">gp_artist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span>
            
            <span class="n">gp_XYZ</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">gp</span><span class="o">.</span><span class="n">xyz</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">element_list</span>
                                <span class="k">for</span> <span class="n">gp</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">gauss_points</span><span class="p">])</span>
        
            <span class="n">gp_artist</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">gp_XYZ</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">gp_XYZ</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">gp_artist</span><span class="o">.</span><span class="n">set_3d_properties</span><span class="p">(</span><span class="n">gp_XYZ</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>
            
        <span class="c1"># Plot local axes</span>
        <span class="n">attr</span> <span class="o">=</span> <span class="s1">&#39;x_axes&#39;</span>
        <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">:</span>
            
            <span class="n">x_axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="s1">&#39;x_axes&#39;</span><span class="p">]</span>
            <span class="n">y_axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="s1">&#39;y_axes&#39;</span><span class="p">]</span>
            <span class="n">z_axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="s1">&#39;z_axes&#39;</span><span class="p">]</span>
            
            <span class="n">element_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_objs</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            
            <span class="n">origin</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">e</span><span class="o">.</span><span class="n">get_midpoint_xyz</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">element_list</span><span class="p">])</span>
            
            <span class="n">axes</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">e</span><span class="o">.</span><span class="n">get_axes</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">element_list</span><span class="p">])</span>
            <span class="n">ex</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,:]</span>
            <span class="n">ey</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[:,</span><span class="mi">1</span><span class="p">,:]</span>
            <span class="n">ez</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[:,</span><span class="mi">2</span><span class="p">,:]</span>
            
            <span class="n">sf</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="c1"># scale factor for element axes</span>
            <span class="n">x_axes</span><span class="o">.</span><span class="n">set_segments</span><span class="p">([[</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span><span class="n">sf</span><span class="o">*</span><span class="n">ex</span><span class="p">)])</span>
            <span class="n">y_axes</span><span class="o">.</span><span class="n">set_segments</span><span class="p">([[</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span><span class="n">sf</span><span class="o">*</span><span class="n">ey</span><span class="p">)])</span>
            <span class="n">z_axes</span><span class="o">.</span><span class="n">set_segments</span><span class="p">([[</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span><span class="n">sf</span><span class="o">*</span><span class="n">ez</span><span class="p">)])</span>
        
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span>


    <span class="k">def</span> <span class="nf">has_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node_objs</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">1</span>
    
    <span class="k">def</span> <span class="nf">has_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element_objs</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">1</span>
    
    
<span class="k">class</span> <span class="nc">MeshChain</span><span class="p">(</span><span class="n">Mesh</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to implement a chain mesh, i.e. series of elements forming a chain</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">node_list</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Required:</span>
<span class="sd">            </span>
<span class="sd">        * `node_list`, list of Node objects defining chain</span>
<span class="sd">        </span>
<span class="sd">        Other keyword arguments are passed to `Mesh.__init__()` method</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Define elements linking nodes</span>
        
        <span class="n">nNodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">node_list</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">nNodes</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot define mesh chain from only 1 node!&quot;</span><span class="p">)</span>
           
        <span class="n">element_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nNodes</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            
            <span class="n">node1</span> <span class="o">=</span> <span class="n">node_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">node2</span> <span class="o">=</span> <span class="n">node_list</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            
            <span class="n">element_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LineElement</span><span class="p">(</span><span class="n">parent_mesh</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="c1"># append later</span>
                                            <span class="n">connected_nodes</span><span class="o">=</span><span class="p">[</span><span class="n">node1</span><span class="p">,</span><span class="n">node2</span><span class="p">]))</span>
        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">node_objs</span><span class="o">=</span><span class="n">node_list</span><span class="p">,</span>
                         <span class="n">element_objs</span><span class="o">=</span><span class="n">element_list</span><span class="p">,</span>
                         <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
        
<span class="k">class</span> <span class="nc">Element</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class used to define elements, i.e. entities connecting nodes </span>
<span class="sd">    (points in space)</span>
<span class="sd">    </span>
<span class="sd">    _Note: implemented as an abstract class. Objects cannot be instantiated_</span>
<span class="sd">    &quot;&quot;&quot;</span>
        
    <span class="c1"># Class properties</span>
    <span class="n">_ids</span> <span class="o">=</span> <span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># used to assign IDs to objects</span>
    
    <span class="n">_nNodes_expected</span> <span class="o">=</span> <span class="bp">None</span>
    
    <span class="c1"># Class methods</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_mesh</span><span class="p">,</span> <span class="n">connected_nodes</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates new element, in the context of `parent_mesh`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Prevent direct instatiation of this class</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="n">Element</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;&lt;Element&gt; must be subclassed.&quot;</span><span class="p">)</span>
                
        <span class="bp">self</span><span class="o">.</span><span class="n">parent_mesh</span> <span class="o">=</span> <span class="n">parent_mesh</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parent mesh to which element directly relates</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ids</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sequential integer ID, assigned to uniquely identify object</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        User-assigned name, usually of _string_ type</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">connected_nodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of node objects connecting to this element. Keys are node names</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">gauss_points</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of gauss point objects associated with this element</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Connect to parent mesh</span>
        <span class="k">if</span> <span class="n">parent_mesh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent_mesh</span><span class="o">.</span><span class="n">append_objs</span><span class="p">([</span><span class="bp">self</span><span class="p">])</span>

        <span class="c1"># Connect any nodes passed in as list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect_nodes</span><span class="p">(</span><span class="n">connected_nodes</span><span class="p">)</span>
        
    
    <span class="c1"># -----</span>
          
    
    <span class="k">def</span> <span class="nf">connect_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">node_objs</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_node_objs</span><span class="p">(</span><span class="n">node_objs</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">node_obj</span> <span class="ow">in</span> <span class="n">node_objs</span><span class="p">:</span>
            
            <span class="n">check_class</span><span class="p">(</span><span class="n">node_obj</span><span class="p">,</span><span class="n">Node</span><span class="p">)</span>

            <span class="c1"># Append object to connected nodes list</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connected_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_obj</span><span class="p">)</span>
            
            <span class="c1"># Create two-way linked list</span>
            <span class="n">node_obj</span><span class="o">.</span><span class="n">connect_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            
            
    <span class="k">def</span> <span class="nf">_check_node_objs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">node_objs</span><span class="p">):</span>
        
        <span class="n">N</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nNodes_expected</span>
        
        <span class="k">if</span> <span class="n">N</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">node_objs</span><span class="p">)</span><span class="o">!=</span> <span class="n">N</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unexpected number of nodes supplied &quot;</span>
                                 <span class="s2">&quot;to define element!&quot;</span><span class="p">)</span>
                
            
    <span class="k">def</span> <span class="nf">get_connected_node</span><span class="p">(</span><span class="n">node_index</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
        
        <span class="k">return</span> 
    
    
    
    
    
    <span class="k">def</span> <span class="nf">define_gauss_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Defines gauss points to be associated with element</span>
<span class="sd">        </span>
<span class="sd">        _To be overridden by derived class method_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Not implemented for base class! To be overridden&quot;</span><span class="p">)</span>
        
    
    
<span class="k">class</span> <span class="nc">LineElement</span><span class="p">(</span><span class="n">Element</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to implement line elements, i.e. element between two nodes in 3d</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">_nNodes_expected</span> <span class="o">=</span> <span class="mi">2</span>
            

    <span class="k">def</span> <span class="nf">get_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns list of (3,) arrays defining unit vectors for each element axis</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Calculate x-axis, taking as being direction vector from end1 to end2</span>
        <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_end_positions</span><span class="p">()</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">-</span> <span class="n">r1</span>
        <span class="n">x</span> <span class="o">/=</span> <span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        
        <span class="c1"># Calculate y-axis</span>
        <span class="c1"># y to lie in horizontal plane orthogonal to x</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">vertical_direction</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">norm</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Special case for vertical members</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Element &#39;</span><span class="si">%s</span><span class="s2">&#39; is vertical&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">default_y_direction</span>
            
        <span class="c1"># Calculate z-axis to be orthogonal to x and y</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    
        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span>
        
        
    <span class="k">def</span> <span class="nf">get_end_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns position vectors of each end of elements</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connected_nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_xyz</span><span class="p">()</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connected_nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_xyz</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span>
    
    
    <span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns length of element i.e. distance between end nodes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_end_positions</span><span class="p">()</span>
        <span class="n">r12</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">-</span> <span class="n">r1</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">r12</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
    
    
    <span class="k">def</span> <span class="nf">get_midpoint_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns position vector denoting the midpoint of element</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_end_positions</span><span class="p">()</span>
        <span class="k">return</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">r1</span><span class="o">+</span><span class="n">r2</span><span class="p">)</span>
    
    
    <span class="k">def</span> <span class="nf">define_gauss_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">N_gp</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Defines gauss points to be associated with element</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Required:</span>
<span class="sd">            </span>
<span class="sd">        * `N_gp`, integer, defines number of gauss points to be defined per </span>
<span class="sd">          element. This relates to accuracy of integration.</span>
<span class="sd">          </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Define weights and locations for gauss points based on [-1,1] domain</span>
        <span class="c1"># Refer https://en.wikipedia.org/wiki/Gaussian_quadrature</span>
        
        <span class="k">if</span> <span class="n">N_gp</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            
            <span class="n">locs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">]</span>
        
        <span class="k">elif</span> <span class="n">N_gp</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            
            <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">locs</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">val</span><span class="p">,</span> <span class="o">+</span><span class="n">val</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">val</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]</span>
            
        <span class="k">elif</span> <span class="n">N_gp</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            
            <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">locs</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">val</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">+</span><span class="n">val</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">val</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">5</span><span class="o">/</span><span class="mi">9</span><span class="p">),(</span><span class="mi">8</span><span class="o">/</span><span class="mi">9</span><span class="p">),(</span><span class="mi">5</span><span class="o">/</span><span class="mi">9</span><span class="p">)]</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;N_gp&gt;3 not yet implemented!&quot;</span><span class="p">)</span>
            
        <span class="c1"># Convert to numpy arrays</span>
        <span class="n">locs</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">locs</span><span class="p">)</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Gauss points for element &#39;</span><span class="si">%s</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> 
                  <span class="s2">&quot;Locs: {0}</span><span class="se">\n</span><span class="s2">Weights:{1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">locs</span><span class="p">,</span><span class="n">weights</span><span class="p">))</span>
        
        <span class="c1"># Convert to [0,L] domain</span>
        <span class="n">L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">()</span>
        <span class="n">weights</span> <span class="o">*=</span> <span class="n">L</span><span class="o">/</span><span class="mi">2</span>
        
        <span class="c1"># Define gauss points</span>
        <span class="n">locs</span> <span class="o">=</span> <span class="p">(</span><span class="n">locs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>                     <span class="c1"># convert to [0,1] domain</span>
        <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_end_positions</span><span class="p">()</span>
        <span class="n">r12</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">-</span> <span class="n">r1</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">gauss_points</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">loc</span><span class="p">,</span><span class="n">weight</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">locs</span><span class="p">,</span><span class="n">weights</span><span class="p">):</span>
            
            <span class="c1"># Calculate position of gauss point</span>
            <span class="n">xyz</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">+</span> <span class="n">loc</span> <span class="o">*</span> <span class="n">r12</span>
            
            <span class="c1"># Define new GaussPoint object and append to list</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gauss_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GaussPoint</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span><span class="n">weight</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span><span class="n">xyz</span><span class="o">=</span><span class="n">xyz</span><span class="p">))</span>
            
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gauss_points</span>
         
<span class="c1"># *****************************************************************************</span>
    
<span class="k">class</span> <span class="nc">Point</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class used to define discrete points in space    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Class properties</span>
    <span class="n">_ids</span> <span class="o">=</span> <span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># used to assign IDs to objects</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xyz</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates new point instance</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Required:</span>
<span class="sd">            </span>
<span class="sd">        * `xyz`, list or array of length 3, defines position of node</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Optional:</span>
<span class="sd">            </span>
<span class="sd">        * `name`, _string_ name to identify points</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ids</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sequential integer ID, assigned to uniquely identify object</span>
<span class="sd">        &quot;&quot;&quot;</span>  
        
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        User-assigned name, usually of _string_ type</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span> <span class="o">=</span> <span class="n">xyz</span>
        
    
    <span class="c1"># ------------ATTRIBUTES ---------------</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
    
    <span class="nd">@x.setter</span>
    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        
    <span class="c1"># -----</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">get_y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
    
    <span class="nd">@y.setter</span>
    <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        
    <span class="c1"># -----</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">z</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">get_z</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span>
    
    <span class="nd">@z.setter</span>
    <span class="k">def</span> <span class="nf">z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        
    <span class="c1"># -----</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Array of shape (3,) defining position of node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xyz</span>
    
    <span class="k">def</span> <span class="nf">get_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span>
    
    <span class="nd">@xyz.setter</span>
    <span class="k">def</span> <span class="nf">xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`xyz` unexpected shape!</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> 
                             <span class="s2">&quot;Shape: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xyz</span> <span class="o">=</span> <span class="n">value</span>
        
    
        
        
<span class="c1"># *****************************************************************************</span>
        
<span class="k">class</span> <span class="nc">Node</span><span class="p">(</span><span class="n">Point</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class used to define nodes i.e. points in space which define the </span>
<span class="sd">    vertices (end points in 1D) of elements and which are thus related via a </span>
<span class="sd">    mesh</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Class properties</span>
    <span class="n">_ids</span> <span class="o">=</span> <span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># used to assign IDs to objects</span>
    
    <span class="c1"># Class methods</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_mesh</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">connected_elements</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates new node, in the context of `parent_mesh`</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Required:</span>
<span class="sd">            </span>
<span class="sd">        * `parent_mesh`, instance of _mesh_ class. Defines mesh context in </span>
<span class="sd">          which node is defined</span>
<span class="sd">          </span>
<span class="sd">        * `xyz`, list or array of length 3, defines position of node</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Optional:</span>
<span class="sd">            </span>
<span class="sd">        * `name`, _string_ name to identify nodes</span>
<span class="sd">        </span>
<span class="sd">        * `connected_elements`, list of _element_ objects connected to this </span>
<span class="sd">          node. Will normally be empty, with nodes connected to elements when </span>
<span class="sd">          elements are defined</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
    
        <span class="bp">self</span><span class="o">.</span><span class="n">parent_mesh</span> <span class="o">=</span> <span class="n">parent_mesh</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parent mesh to which element directly relates</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">connected_elements</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dict of element objects connected to this node. Keys are element names</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">lcase_disp</span> <span class="o">=</span> <span class="n">DispResults</span><span class="p">(</span><span class="n">node_obj</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">results_arr</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance of `DispResults` class used as container for </span>
<span class="sd">        displacements as obtained for ordinary loadcases / combinations</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">modal_disp</span> <span class="o">=</span> <span class="n">DispResults</span><span class="p">(</span><span class="n">node_obj</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">results_arr</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance of `DispResults` class used as container for </span>
<span class="sd">        mode displacements as obtained from eigenvalue analysis</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Connect to parent mesh</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent_mesh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent_mesh</span><span class="o">.</span><span class="n">append_objs</span><span class="p">([</span><span class="bp">self</span><span class="p">])</span>
        
        <span class="c1"># Connect any elements passed in via list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect_elements</span><span class="p">(</span><span class="n">connected_elements</span><span class="p">)</span>
        
        
    <span class="k">def</span> <span class="nf">connect_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">element_objs</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to associate element objects with node object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># create list in case of single object input</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">element_objs</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">):</span>
            <span class="n">element_objs</span><span class="o">=</span><span class="p">[</span><span class="n">element_objs</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">element_objs</span><span class="p">:</span>
            
            <span class="n">check_class</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">Element</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connected_elements</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="n">obj</span>
            
    

<span class="k">class</span> <span class="nc">GaussPoint</span><span class="p">(</span><span class="n">Point</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Defines gauss point, i.e. point at specific position within an element</span>
<span class="sd">    but not at its vertices. Gauss points have weights, which are used when </span>
<span class="sd">    performing gauss quadrature (numerical integration)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Class properties</span>
    <span class="n">_ids</span> <span class="o">=</span> <span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># used to assign IDs to objects</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">loc</span><span class="p">,</span><span class="n">weight</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
               
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span> <span class="n">loc</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Location of gauss point within [0,1] domain along element to which </span>
<span class="sd">        gauss point relates (useful for interpolation of properties / results </span>
<span class="sd">        found at the end of the element)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="n">weight</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Weight associated with gauss point, for use when carrying out </span>
<span class="sd">        integration by gauss quadrature</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
      
        
<span class="c1"># ------------------- CLASSES TO STORE MESH RESULTS -----------------------</span>
        
<span class="k">class</span> <span class="nc">MeshResults</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class used to store results with relation to mesh objects</span>
<span class="sd">    (e.g. nodes for displacements, member-node locations for forces)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">nComponents</span> <span class="o">=</span> <span class="bp">None</span>   <span class="c1"># integer defining expected number of components</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_list</span><span class="p">,</span> <span class="n">results_arr</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">obj_list</span> <span class="o">=</span> <span class="n">obj_list</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of mesh objects to which results relate. E.g. displacements </span>
<span class="sd">        relate to nodes (i.e. list length = 1), whereas forces relate to </span>
<span class="sd">        elements and nodes (i.e. list of length = 2)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">results_arr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">results_arr</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;New instance of &#39;</span><span class="si">%s</span><span class="s2">&#39; created&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="n">print_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">print_str</span> <span class="o">+=</span> <span class="s2">&quot;Class:</span><span class="se">\t</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">print_str</span> <span class="o">+=</span> <span class="s2">&quot;Name:</span><span class="se">\t</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">print_str</span> <span class="o">+=</span> <span class="s2">&quot;Shape of values array:</span><span class="se">\n</span><span class="s2">{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">print_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">print_str</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        2d-array of vector results for multiple loadcases. </span>
<span class="sd">        Shape is [nLoadcase,nComponents]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span>
    
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns list comprising names of mesh objects associated</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_list</span><span class="p">]</span>
       
        
    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">new_results</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appends results for new loadcase</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Appending new results to location {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">new_results</span><span class="p">))</span>
        
    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clears results held within object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nComponents</span><span class="p">))</span>
        
        
    
        
        
    
<span class="k">class</span> <span class="nc">DispResults</span><span class="p">(</span><span class="n">MeshResults</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class used to store displacement results, with relation to a given node</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">nComponents</span> <span class="o">=</span> <span class="mi">6</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_obj</span><span class="p">,</span> <span class="n">results_arr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span><span class="n">node_obj</span><span class="p">],</span> <span class="n">results_arr</span><span class="p">)</span>
        
        
<span class="k">class</span> <span class="nc">ReactionResults</span><span class="p">(</span><span class="n">MeshResults</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class used to store reaction results, with relation to a given node</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">nComponents</span> <span class="o">=</span> <span class="mi">6</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_obj</span><span class="p">,</span> <span class="n">results_arr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span><span class="n">node_obj</span><span class="p">],</span> <span class="n">results_arr</span><span class="p">)</span>
        
        
<span class="k">class</span> <span class="nc">ForceResults</span><span class="p">(</span><span class="n">MeshResults</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class used to store force results, with regards to a given [element, node]</span>
<span class="sd">    location</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">nComponents</span> <span class="o">=</span> <span class="mi">6</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element_obj</span><span class="p">,</span> <span class="n">node_obj</span><span class="p">,</span> <span class="n">results_arr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span><span class="n">element_obj</span><span class="p">,</span><span class="n">node_obj</span><span class="p">],</span> <span class="n">results_arr</span><span class="p">)</span>
    


<span class="c1"># ********************** FUNCTIONS ****************************************</span>
     
<span class="k">def</span> <span class="nf">integrate_over_mesh</span><span class="p">(</span><span class="n">mesh_obj</span><span class="p">,</span>
                        <span class="n">integrand_func</span><span class="p">:</span><span class="nb">callable</span><span class="p">,</span>
                        <span class="n">args</span><span class="o">=</span><span class="p">[],</span>
                        <span class="n">kwargs</span><span class="o">=</span><span class="p">{},</span>
                        <span class="n">cumulative</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to perform gauss integration across the domain of a mesh</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    Required:</span>
<span class="sd">        </span>
<span class="sd">    * `mesh_obj`, instance of Mesh class, defining mesh to be integrated over</span>
<span class="sd">    </span>
<span class="sd">    * `integrand_func`, _callable_ defining the integrand, i.e. the function to </span>
<span class="sd">      be integrated over the mesh:</span>
<span class="sd">          </span>
<span class="sd">          * First argument shall be &#39;GaussPoint&#39; instance</span>
<span class="sd">          </span>
<span class="sd">          * Other arguments may be passed via `args` and `kwargs` parameters.</span>
<span class="sd">      </span>
<span class="sd">    ***</span>
<span class="sd">    Optional:</span>
<span class="sd">    </span>
<span class="sd">    * `cumulative`, boolean, if True the integral as evaluated over individual </span>
<span class="sd">      elements will be returned. If False (default) only total integral over </span>
<span class="sd">      all elements in the mesh will be returned.</span>
<span class="sd">      </span>
<span class="sd">    ***</span>
<span class="sd">    Returns:</span>
<span class="sd">        </span>
<span class="sd">    Float or numpy array, depending on `cumulative` parameter.</span>
<span class="sd">          </span>
<span class="sd">    &quot;&quot;&quot;</span>  
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mesh_obj</span><span class="p">,</span> <span class="n">Mesh</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`mesh_obj` to be of Mesh type&quot;</span><span class="p">)</span>
        
    <span class="n">full_gp_list</span> <span class="o">=</span> <span class="n">mesh_obj</span><span class="o">.</span><span class="n">get_gauss_points</span><span class="p">()</span>
        
    <span class="n">mesh_integral</span> <span class="o">=</span> <span class="p">[]</span>
        
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">gp_list</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">full_gp_list</span><span class="p">):</span> <span class="c1"># iterate over all elements</span>
        
        <span class="n">element_integral</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">gp</span> <span class="ow">in</span> <span class="n">gp_list</span><span class="p">:</span> <span class="c1"># iterate over all gps (within each element)</span>
            
            <span class="n">element_integral</span> <span class="o">+=</span> <span class="n">gp</span><span class="o">.</span><span class="n">weight</span> <span class="o">*</span> <span class="n">integrand_func</span><span class="p">(</span><span class="n">gp</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="n">mesh_integral</span> <span class="o">+=</span> <span class="p">[</span><span class="n">element_integral</span><span class="p">]</span>
    
    <span class="c1"># Determine which type of summation to use to aggregate integrals over mesh</span>
    <span class="k">if</span> <span class="n">cumulative</span><span class="p">:</span>
        <span class="n">integral</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mesh_integral</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">integral</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">mesh_integral</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">integral</span>
            

<span class="k">def</span> <span class="nf">integrate_gauss</span><span class="p">(</span><span class="n">f</span><span class="p">:</span><span class="nb">callable</span><span class="p">,</span><span class="n">x</span><span class="p">,</span>
                    <span class="n">f_args</span><span class="o">=</span><span class="p">[],</span><span class="n">f_kwargs</span><span class="o">=</span><span class="p">{},</span>
                    <span class="n">n_gp</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                    <span class="n">make_plot</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                    <span class="n">ax_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluates integral by sub-dividing x-domain into a list of elements and </span>
<span class="sd">    using gauss quadrature to obtain integral across each element.</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    Required:</span>
<span class="sd">    </span>
<span class="sd">    * `f`, integrand function f(x)</span>
<span class="sd">    </span>
<span class="sd">    * `x`, 1d-array providing salient values to use in integration:</span>
<span class="sd">        </span>
<span class="sd">        * Bounds for integration are x[0], x[-1]</span>
<span class="sd">        </span>
<span class="sd">        * Other values may be provided to control the mesh used for gauss </span>
<span class="sd">          quadrature. E.g. more accurate integration is obtained by </span>
<span class="sd">          narrowing the step (element length) in parts of the function where </span>
<span class="sd">          integrand function is known a-priori to vary strongly.</span>
<span class="sd">          </span>
<span class="sd">    ***</span>
<span class="sd">    Optional:</span>
<span class="sd">        </span>
<span class="sd">    * `f_args`, `f_kwargs`; _list_ and _dict_ respectively, used to pass </span>
<span class="sd">      arguments and keyword arguments to `f`.</span>
<span class="sd">      </span>
<span class="sd">    * `n_gp`, either int or _list_ of length `len(x)-1`, used to define </span>
<span class="sd">      number of gauss points per element</span>
<span class="sd">      </span>
<span class="sd">    Any further keyword arguments provided are passed to </span>
<span class="sd">    `integrate_over_mesh()` method, which is being used to implement </span>
<span class="sd">    integration over a mesh.      </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Define mesh i.e. series of elements forming a chain</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`x` to be list of length 2</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
                         <span class="s2">&quot;x[0] and x[-1] denote bounds for integration&quot;</span><span class="p">)</span>
    
    <span class="n">node_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_x</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="n">node_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">parent_mesh</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="c1">#append later by MeshChain init</span>
                              <span class="n">xyz</span><span class="o">=</span><span class="p">[</span><span class="n">_x</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]))</span>
        
    <span class="n">integration_mesh</span> <span class="o">=</span> <span class="n">MeshChain</span><span class="p">(</span><span class="n">node_list</span><span class="o">=</span><span class="n">node_list</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;integration_mesh&#39;</span><span class="p">)</span>
    
    <span class="n">integration_mesh</span><span class="o">.</span><span class="n">define_gauss_points</span><span class="p">(</span><span class="n">N_gp</span><span class="o">=</span><span class="n">n_gp</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    
    <span class="c1"># Define wrapper around passed function to implement using gauss point data</span>
    <span class="k">def</span> <span class="nf">f_gp</span><span class="p">(</span><span class="n">gp_obj</span><span class="p">,</span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">gp_obj</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">b</span><span class="p">)</span>
    
    <span class="c1"># Evaluate integral</span>
    <span class="n">integral_vals</span> <span class="o">=</span> <span class="n">integrate_over_mesh</span><span class="p">(</span><span class="n">integration_mesh</span><span class="p">,</span>
                                        <span class="n">f_gp</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="n">f_args</span><span class="p">,</span><span class="n">kwargs</span><span class="o">=</span><span class="n">f_kwargs</span><span class="p">,</span>
                                        <span class="n">cumulative</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="c1"># Make plot</span>
    <span class="k">if</span> <span class="n">make_plot</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ax_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax_list</span>
            
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">*</span><span class="n">f_args</span><span class="p">,</span><span class="o">**</span><span class="n">f_kwargs</span><span class="p">),</span><span class="s1">&#39;g.&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$f(x_{salient})$&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">npy</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="mf">0.0</span><span class="p">,</span><span class="n">integral_vals</span><span class="p">)),</span><span class="s1">&#39;g.&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;gauss&#39;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">integration_mesh</span><span class="p">,</span> <span class="n">integral_vals</span>
    
    
            
    
<span class="c1"># ********************** TEST ROUTINES ****************************************</span>
        
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    
    <span class="n">testRoutine2Run</span><span class="o">=</span><span class="mi">3</span>
    
    <span class="k">if</span> <span class="n">testRoutine2Run</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;*** TEST ROUTINE 1 COMMENCED ***&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    
        <span class="c1"># Define new mesh</span>
        <span class="n">meshObj1</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;myMesh&quot;</span><span class="p">)</span>
        
        <span class="c1"># Define some nodes</span>
        <span class="n">xyz</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]])</span>
        <span class="n">Nn</span> <span class="o">=</span> <span class="n">xyz</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nn</span><span class="p">):</span>
            <span class="n">Node</span><span class="p">(</span><span class="n">meshObj1</span><span class="p">,</span><span class="n">xyz</span><span class="o">=</span><span class="n">xyz</span><span class="p">[</span><span class="n">n</span><span class="p">,:],</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Node </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            
        <span class="c1"># Plot mesh</span>
        <span class="n">meshObj1</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
        
    <span class="k">if</span> <span class="n">testRoutine2Run</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
        
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;*** TEST ROUTINE 2 COMMENCED *****&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;--- Test of local element axes ---&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    
        <span class="c1"># Define new mesh</span>
        <span class="n">meshObj1</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Element axes test&quot;</span><span class="p">)</span>
        
        <span class="c1"># Define some nodes</span>
        <span class="n">xyz</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
        <span class="n">Nn</span> <span class="o">=</span> <span class="n">xyz</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nn</span><span class="p">):</span>
            <span class="n">Node</span><span class="p">(</span><span class="n">meshObj1</span><span class="p">,</span><span class="n">xyz</span><span class="o">=</span><span class="n">xyz</span><span class="p">[</span><span class="n">n</span><span class="p">,:],</span><span class="n">name</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
            
        <span class="c1"># Define some elements</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Nn</span><span class="p">):</span>
            
            <span class="n">node1</span> <span class="o">=</span> <span class="n">meshObj1</span><span class="o">.</span><span class="n">node_objs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">node2</span> <span class="o">=</span> <span class="n">meshObj1</span><span class="o">.</span><span class="n">node_objs</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
            <span class="n">LineElement</span><span class="p">(</span><span class="n">meshObj1</span><span class="p">,[</span><span class="n">node1</span><span class="p">,</span><span class="n">node2</span><span class="p">])</span>
            
        <span class="c1"># Plot mesh</span>
        <span class="n">meshObj1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_axes</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="n">testRoutine2Run</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
        
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;*** TEST ROUTINE 2 COMMENCED *****&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;--- Test of integration by gauss quadrature ---&quot;</span><span class="p">)</span>
        
        <span class="c1"># Define arbitrary polynomial</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">poly1d</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">])</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        
        <span class="c1"># Perform integration over an uneven mesh using just two elements</span>
        <span class="n">x_salient</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mf">0.1</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_salient</span><span class="p">,</span><span class="n">p</span><span class="p">(</span><span class="n">x_salient</span><span class="p">),</span><span class="s1">&#39;r.&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span> <span class="c1"># overlay y=0 line</span>
        
        <span class="n">mesh</span><span class="p">,</span> <span class="n">integral_vals</span> <span class="o">=</span> <span class="n">integrate_gauss</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">x_salient</span><span class="p">,</span>
                                              <span class="n">n_gp</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                              <span class="n">cumulative</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                              <span class="n">make_plot</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                              <span class="n">ax_list</span><span class="o">=</span><span class="p">[</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">])</span>
        
        <span class="c1"># Derive exact integrated polynomial</span>
        <span class="n">p_integral</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">polyint</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">p0</span> <span class="o">=</span> <span class="n">p_integral</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># integration constant</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p_integral</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">p0</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        
        <span class="c1"># Define some nodes</span>
        
            
<span class="c1">#        # Define some elements</span>
<span class="c1">#        elemTopo = npy.asarray([[0,1],[1,2],[0,2]])</span>
<span class="c1">#        Ne = elemTopo.shape[0]</span>
<span class="c1">#        </span>
<span class="c1">#        for e in range(Ne):</span>
<span class="c1">#            Element(meshObj1,elemTopo[e,:],name=&quot;Element %d&quot; (e+1))</span>
<span class="c1">#            </span>
<span class="c1">#        # Define a mesh of meshes</span>
<span class="c1">#        meshObj2 = Mesh(name=&quot;myMeshOfMeshes&quot;)</span>
<span class="c1">#        meshObj2.appendObjs(&quot;mesh&quot;,meshObj1)</span>
<span class="c1">#        meshObj2.printAttrs()</span>
<span class="c1">#        </span>
<span class="c1">#        # Define deformed configuration of mesh</span>
<span class="c1">#        #vMask=&quot;101&quot;</span>
<span class="c1">#        meshObj1.nodeObjs[0].setDeformedPos([0.2,0.1],vmask=&quot;101&quot;)</span>
<span class="c1">#        meshObj1.nodeObjs[1].setDeformedPos([-0.2,0.2,-0.1])</span>
<span class="c1">#        meshObj1.nodeObjs[2].setDeformedPos([0.2,0.5],vmask=&quot;110&quot;)</span>
<span class="c1">#        meshObj1.nodeObjs[3].setDeformedPos([-0.2,-0.4,0.1])</span>
<span class="c1">#        </span>
<span class="c1">#        # Produce 3D plot of mesh</span>
<span class="c1">#        fig = plt.figure()</span>
<span class="c1">#        ax = fig.gca(projection=&#39;3d&#39;)</span>
<span class="c1">#        meshObj2.plot(ax,plotDeformed=True)</span>
<span class="c1">#        plt.show()</span>
<span class="c1">##        </span>
<span class="c1">#    elif testRoutine2Run==2:</span>
<span class="c1">#        </span>
<span class="c1">#        print(&quot;*** TEST ROUTINE 2 COMMENCED ***&quot;)</span>
<span class="c1">#        print(&quot;&quot;)</span>
<span class="c1">#        </span>
<span class="c1">#        # Define new mesh, reading data from file</span>
<span class="c1">#        meshObj3 = mesh(name=&quot;myCoolMesh&quot;)</span>
<span class="c1">#        meshObj3.defineFromFiles()</span>
<span class="c1">#        </span>
<span class="c1">#        # Read deformations from file</span>
<span class="c1">#        meshObj3.readDeformations(&quot;Step2&quot;)</span>
<span class="c1">#        </span>
<span class="c1">#        # Produce 3D plot of mesh</span>
<span class="c1">#        fig = plt.figure(figsize=(9,9))</span>
<span class="c1">#        ax = fig.gca(projection=&#39;3d&#39;)</span>
<span class="c1">#        dwgObjs=meshObj3.plot(ax,printOutput=False,plotDeformed=True)</span>
<span class="c1">#        plt.show()</span>
<span class="c1">#        </span>
<span class="c1">#        # Read deformations from file and update plot</span>
<span class="c1">#        meshObj3.readDeformations(&quot;Step3&quot;)</span>
<span class="c1">#        dwgObjs=meshObj3.plot(ax,updatePlot=True,dwgObjs=dwgObjs,printOutput=False,plotDeformed=True)</span>
<span class="c1">#        </span>
<span class="c1">#    elif testRoutine2Run==3:</span>
<span class="c1">#        </span>
<span class="c1">#        print(&quot;*** TEST ROUTINE 2 COMMENCED ***&quot;)</span>
<span class="c1">#        print(&quot;&quot;)</span>
<span class="c1">#        </span>
<span class="c1">#        # Define new mesh, reading data from file</span>
<span class="c1">#        meshObj1 = mesh(name=&quot;myCoolMesh&quot;)</span>
<span class="c1">#        meshObj1.defineFromFiles()</span>
<span class="c1">#        </span>
<span class="c1">#        # Create new figure with 3D axes system</span>
<span class="c1">#        fig = plt.figure(figsize=(9,9))</span>
<span class="c1">#        ax = fig.gca(projection=&#39;3d&#39;)</span>
<span class="c1">#        </span>
<span class="c1">#        # Set appropriate limits for plot</span>
<span class="c1">#        xyz_min,xyz_max=[-10,-10,0],[10,10,10]</span>
<span class="c1">#        ax.set_xlim([xyz_min[0],xyz_max[0]])</span>
<span class="c1">#        ax.set_ylim([xyz_min[1],xyz_max[1]])</span>
<span class="c1">#        ax.set_zlim([xyz_min[2],xyz_max[2]])</span>
<span class="c1">#        </span>
<span class="c1">#         # Set axes labels etc.</span>
<span class="c1">#        ax.set_xlabel(&quot;x&quot;)</span>
<span class="c1">#        ax.set_ylabel(&quot;y&quot;)</span>
<span class="c1">#        ax.set_zlabel(&quot;z&quot;)</span>
<span class="c1">#        ax.set_title(&quot;My mesh animation&quot;)</span>
<span class="c1">#        </span>
<span class="c1">#        # Create drawing objects (with no data)</span>
<span class="c1">#        dwgObjs=meshObj1.plot(ax,</span>
<span class="c1">#                              printOutput=False,plotNull=True,</span>
<span class="c1">#                              plotDeformed=True,</span>
<span class="c1">#                              plotNodes=False,plotElements=True,</span>
<span class="c1">#                              elementLineStyle_undeformed=&#39;--&#39;,</span>
<span class="c1">#                              elementLineStyle_deformed=&#39;-&#39;,</span>
<span class="c1">#                              nodeStyle=&#39;.&#39;,nodeColor=&#39;m&#39;)</span>
<span class="c1">#        time_template = &#39;Time = %.3fs&#39;</span>
<span class="c1">#        time_text = ax.text(0.05, 0.9, 0,&#39;&#39;, transform=ax.transAxes)</span>
<span class="c1">#        </span>
<span class="c1">#        # Define function used to draw a clear frame</span>
<span class="c1">#        def init():</span>
<span class="c1">#            return animate(0,dt,dwgObjs,time_text)</span>
<span class="c1">#            </span>
<span class="c1">#        # Define function to run repeatedly to create animation</span>
<span class="c1">#        def animate(i,dt,dwgObjs,time_text):</span>
<span class="c1">#            </span>
<span class="c1">#            t_val=i*dt</span>
<span class="c1">#            </span>
<span class="c1">#            # Read deformations from file</span>
<span class="c1">#            meshObj1.readDeformations(&quot;Step{0}&quot;.format(i+1),printOutput=False)</span>
<span class="c1">#        </span>
<span class="c1">#            # Update plot</span>
<span class="c1">#            dwgObjs=meshObj1.plot(ax,</span>
<span class="c1">#                                  updatePlot=True,dwgObjs=dwgObjs,</span>
<span class="c1">#                                  printOutput=False,plotDeformed=True,</span>
<span class="c1">#                                  plotNodes=False,plotElements=True)</span>
<span class="c1">#            </span>
<span class="c1">#            # Update time lobel</span>
<span class="c1">#            time_text.set_text(time_template % t_val)</span>
<span class="c1">#        </span>
<span class="c1">#            return dwgObjs,time_text</span>
<span class="c1">#        </span>
<span class="c1">#        dt=1</span>
<span class="c1">#        delay=2</span>
<span class="c1">#        ani = animation.FuncAnimation(fig, animate,</span>
<span class="c1">#                                      frames=3,</span>
<span class="c1">#                                      fargs=(dt,dwgObjs,time_text,),</span>
<span class="c1">#                                      interval=dt*1000,</span>
<span class="c1">#                                      repeat=True,repeat_delay=delay*1000,</span>
<span class="c1">#                                      init_func=init)</span>
<span class="c1">#        plt.show()</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;(No valid test routine selected)&quot;</span><span class="p">)</span>
        
   

    
    
    
</pre></div>

  </div>

  </header>

  <section id="section-items">
    <h2 class="section-title" id="header-variables">Module variables</h2>
      <div class="item">
      <p id="mesh.default_y_direction" class="name">var <span class="ident">default_y_direction</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="mesh.vertical_direction" class="name">var <span class="ident">vertical_direction</span></p>
      
  
  <div class="source_cont">
</div>

      </div>

    <h2 class="section-title" id="header-functions">Functions</h2>
      
  <div class="item">
    <div class="name def" id="mesh.integrate_gauss">
    <p>def <span class="ident">integrate_gauss</span>(</p><p>f, x, f_args=[], f_kwargs={}, n_gp=3, make_plot=True, ax_list=None, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Evaluates integral by sub-dividing x-domain into a list of elements and 
using gauss quadrature to obtain integral across each element.</p>
<hr />
<p>Required:</p>
<ul>
<li>
<p><code>f</code>, integrand function f(x)</p>
</li>
<li>
<p><code>x</code>, 1d-array providing salient values to use in integration:</p>
<ul>
<li>
<p>Bounds for integration are x[0], x[-1]</p>
</li>
<li>
<p>Other values may be provided to control the mesh used for gauss 
  quadrature. E.g. more accurate integration is obtained by 
  narrowing the step (element length) in parts of the function where 
  integrand function is known a-priori to vary strongly.</p>
</li>
</ul>
</li>
</ul>
<hr />
<p>Optional:</p>
<ul>
<li>
<p><code>f_args</code>, <code>f_kwargs</code>; <em>list</em> and <em>dict</em> respectively, used to pass 
  arguments and keyword arguments to <code>f</code>.</p>
</li>
<li>
<p><code>n_gp</code>, either int or <em>list</em> of length <code>len(x)-1</code>, used to define 
  number of gauss points per element</p>
</li>
</ul>
<p>Any further keyword arguments provided are passed to 
<code>integrate_over_mesh()</code> method, which is being used to implement 
integration over a mesh.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.integrate_gauss', this);">Show source &equiv;</a></p>
  <div id="source-mesh.integrate_gauss" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">integrate_gauss</span><span class="p">(</span><span class="n">f</span><span class="p">:</span><span class="nb">callable</span><span class="p">,</span><span class="n">x</span><span class="p">,</span>
                    <span class="n">f_args</span><span class="o">=</span><span class="p">[],</span><span class="n">f_kwargs</span><span class="o">=</span><span class="p">{},</span>
                    <span class="n">n_gp</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                    <span class="n">make_plot</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                    <span class="n">ax_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluates integral by sub-dividing x-domain into a list of elements and </span>
<span class="sd">    using gauss quadrature to obtain integral across each element.</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    Required:</span>
<span class="sd">    </span>
<span class="sd">    * `f`, integrand function f(x)</span>
<span class="sd">    </span>
<span class="sd">    * `x`, 1d-array providing salient values to use in integration:</span>
<span class="sd">        </span>
<span class="sd">        * Bounds for integration are x[0], x[-1]</span>
<span class="sd">        </span>
<span class="sd">        * Other values may be provided to control the mesh used for gauss </span>
<span class="sd">          quadrature. E.g. more accurate integration is obtained by </span>
<span class="sd">          narrowing the step (element length) in parts of the function where </span>
<span class="sd">          integrand function is known a-priori to vary strongly.</span>
<span class="sd">          </span>
<span class="sd">    ***</span>
<span class="sd">    Optional:</span>
<span class="sd">        </span>
<span class="sd">    * `f_args`, `f_kwargs`; _list_ and _dict_ respectively, used to pass </span>
<span class="sd">      arguments and keyword arguments to `f`.</span>
<span class="sd">      </span>
<span class="sd">    * `n_gp`, either int or _list_ of length `len(x)-1`, used to define </span>
<span class="sd">      number of gauss points per element</span>
<span class="sd">      </span>
<span class="sd">    Any further keyword arguments provided are passed to </span>
<span class="sd">    `integrate_over_mesh()` method, which is being used to implement </span>
<span class="sd">    integration over a mesh.      </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Define mesh i.e. series of elements forming a chain</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`x` to be list of length 2</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
                         <span class="s2">&quot;x[0] and x[-1] denote bounds for integration&quot;</span><span class="p">)</span>
    
    <span class="n">node_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_x</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="n">node_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">parent_mesh</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="c1">#append later by MeshChain init</span>
                              <span class="n">xyz</span><span class="o">=</span><span class="p">[</span><span class="n">_x</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]))</span>
        
    <span class="n">integration_mesh</span> <span class="o">=</span> <span class="n">MeshChain</span><span class="p">(</span><span class="n">node_list</span><span class="o">=</span><span class="n">node_list</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;integration_mesh&#39;</span><span class="p">)</span>
    
    <span class="n">integration_mesh</span><span class="o">.</span><span class="n">define_gauss_points</span><span class="p">(</span><span class="n">N_gp</span><span class="o">=</span><span class="n">n_gp</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    
    <span class="c1"># Define wrapper around passed function to implement using gauss point data</span>
    <span class="k">def</span> <span class="nf">f_gp</span><span class="p">(</span><span class="n">gp_obj</span><span class="p">,</span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">gp_obj</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">b</span><span class="p">)</span>
    
    <span class="c1"># Evaluate integral</span>
    <span class="n">integral_vals</span> <span class="o">=</span> <span class="n">integrate_over_mesh</span><span class="p">(</span><span class="n">integration_mesh</span><span class="p">,</span>
                                        <span class="n">f_gp</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="n">f_args</span><span class="p">,</span><span class="n">kwargs</span><span class="o">=</span><span class="n">f_kwargs</span><span class="p">,</span>
                                        <span class="n">cumulative</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="c1"># Make plot</span>
    <span class="k">if</span> <span class="n">make_plot</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ax_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax_list</span>
            
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">*</span><span class="n">f_args</span><span class="p">,</span><span class="o">**</span><span class="n">f_kwargs</span><span class="p">),</span><span class="s1">&#39;g.&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$f(x_{salient})$&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">npy</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="mf">0.0</span><span class="p">,</span><span class="n">integral_vals</span><span class="p">)),</span><span class="s1">&#39;g.&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;gauss&#39;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">integration_mesh</span><span class="p">,</span> <span class="n">integral_vals</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="mesh.integrate_over_mesh">
    <p>def <span class="ident">integrate_over_mesh</span>(</p><p>mesh_obj, integrand_func, args=[], kwargs={}, cumulative=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Function to perform gauss integration across the domain of a mesh</p>
<hr />
<p>Required:</p>
<ul>
<li>
<p><code>mesh_obj</code>, instance of Mesh class, defining mesh to be integrated over</p>
</li>
<li>
<p><code>integrand_func</code>, <em>callable</em> defining the integrand, i.e. the function to 
  be integrated over the mesh:</p>
<ul>
<li>
<p>First argument shall be 'GaussPoint' instance</p>
</li>
<li>
<p>Other arguments may be passed via <code>args</code> and <code>kwargs</code> parameters.</p>
</li>
</ul>
</li>
</ul>
<hr />
<p>Optional:</p>
<ul>
<li><code>cumulative</code>, boolean, if True the integral as evaluated over individual 
  elements will be returned. If False (default) only total integral over 
  all elements in the mesh will be returned.</li>
</ul>
<hr />
<p>Returns:</p>
<p>Float or numpy array, depending on <code>cumulative</code> parameter.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.integrate_over_mesh', this);">Show source &equiv;</a></p>
  <div id="source-mesh.integrate_over_mesh" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">integrate_over_mesh</span><span class="p">(</span><span class="n">mesh_obj</span><span class="p">,</span>
                        <span class="n">integrand_func</span><span class="p">:</span><span class="nb">callable</span><span class="p">,</span>
                        <span class="n">args</span><span class="o">=</span><span class="p">[],</span>
                        <span class="n">kwargs</span><span class="o">=</span><span class="p">{},</span>
                        <span class="n">cumulative</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to perform gauss integration across the domain of a mesh</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    Required:</span>
<span class="sd">        </span>
<span class="sd">    * `mesh_obj`, instance of Mesh class, defining mesh to be integrated over</span>
<span class="sd">    </span>
<span class="sd">    * `integrand_func`, _callable_ defining the integrand, i.e. the function to </span>
<span class="sd">      be integrated over the mesh:</span>
<span class="sd">          </span>
<span class="sd">          * First argument shall be &#39;GaussPoint&#39; instance</span>
<span class="sd">          </span>
<span class="sd">          * Other arguments may be passed via `args` and `kwargs` parameters.</span>
<span class="sd">      </span>
<span class="sd">    ***</span>
<span class="sd">    Optional:</span>
<span class="sd">    </span>
<span class="sd">    * `cumulative`, boolean, if True the integral as evaluated over individual </span>
<span class="sd">      elements will be returned. If False (default) only total integral over </span>
<span class="sd">      all elements in the mesh will be returned.</span>
<span class="sd">      </span>
<span class="sd">    ***</span>
<span class="sd">    Returns:</span>
<span class="sd">        </span>
<span class="sd">    Float or numpy array, depending on `cumulative` parameter.</span>
<span class="sd">          </span>
<span class="sd">    &quot;&quot;&quot;</span>  
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mesh_obj</span><span class="p">,</span> <span class="n">Mesh</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`mesh_obj` to be of Mesh type&quot;</span><span class="p">)</span>
        
    <span class="n">full_gp_list</span> <span class="o">=</span> <span class="n">mesh_obj</span><span class="o">.</span><span class="n">get_gauss_points</span><span class="p">()</span>
        
    <span class="n">mesh_integral</span> <span class="o">=</span> <span class="p">[]</span>
        
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">gp_list</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">full_gp_list</span><span class="p">):</span> <span class="c1"># iterate over all elements</span>
        
        <span class="n">element_integral</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">gp</span> <span class="ow">in</span> <span class="n">gp_list</span><span class="p">:</span> <span class="c1"># iterate over all gps (within each element)</span>
            
            <span class="n">element_integral</span> <span class="o">+=</span> <span class="n">gp</span><span class="o">.</span><span class="n">weight</span> <span class="o">*</span> <span class="n">integrand_func</span><span class="p">(</span><span class="n">gp</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="n">mesh_integral</span> <span class="o">+=</span> <span class="p">[</span><span class="n">element_integral</span><span class="p">]</span>
    
    <span class="c1"># Determine which type of summation to use to aggregate integrals over mesh</span>
    <span class="k">if</span> <span class="n">cumulative</span><span class="p">:</span>
        <span class="n">integral</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mesh_integral</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">integral</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">mesh_integral</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">integral</span>
</pre></div>

  </div>
</div>

  </div>
  

    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="mesh.DispResults" class="name">class <span class="ident">DispResults</span></p>
      
  
    <div class="desc"><p>Class used to store displacement results, with relation to a given node</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.DispResults', this);">Show source &equiv;</a></p>
  <div id="source-mesh.DispResults" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">DispResults</span><span class="p">(</span><span class="n">MeshResults</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class used to store displacement results, with relation to a given node</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">nComponents</span> <span class="o">=</span> <span class="mi">6</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_obj</span><span class="p">,</span> <span class="n">results_arr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span><span class="n">node_obj</span><span class="p">],</span> <span class="n">results_arr</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#mesh.DispResults">DispResults</a></li>
          <li><a href="#mesh.MeshResults">MeshResults</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="mesh.DispResults.nComponents" class="name">var <span class="ident">nComponents</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="mesh.DispResults.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, node_obj, results_arr=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.DispResults.__init__', this);">Show source &equiv;</a></p>
  <div id="source-mesh.DispResults.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_obj</span><span class="p">,</span> <span class="n">results_arr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span><span class="n">node_obj</span><span class="p">],</span> <span class="n">results_arr</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.DispResults.add">
    <p>def <span class="ident">add</span>(</p><p>self, new_results, verbose=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Appends results for new loadcase</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.DispResults.add', this);">Show source &equiv;</a></p>
  <div id="source-mesh.DispResults.add" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">new_results</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Appends results for new loadcase</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Appending new results to location {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">new_results</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.DispResults.clear">
    <p>def <span class="ident">clear</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Clears results held within object</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.DispResults.clear', this);">Show source &equiv;</a></p>
  <div id="source-mesh.DispResults.clear" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Clears results held within object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nComponents</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="mesh.DispResults.name" class="name">var <span class="ident">name</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#mesh.MeshResults">MeshResults</a></code>.<code><a href="#mesh.MeshResults.name">name</a></code>
    </p>

            
  
    <div class="desc inherited"><p>Returns list comprising names of mesh objects associated</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.DispResults.values" class="name">var <span class="ident">values</span></p>
            

            
  
    <div class="desc"><p>2d-array of vector results for multiple loadcases. 
Shape is [nLoadcase,nComponents]</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="mesh.Element" class="name">class <span class="ident">Element</span></p>
      
  
    <div class="desc"><p>Base class used to define elements, i.e. entities connecting nodes 
(points in space)</p>
<p><em>Note: implemented as an abstract class. Objects cannot be instantiated</em></p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Element', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Element" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Element</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class used to define elements, i.e. entities connecting nodes </span>
<span class="sd">    (points in space)</span>
<span class="sd">    </span>
<span class="sd">    _Note: implemented as an abstract class. Objects cannot be instantiated_</span>
<span class="sd">    &quot;&quot;&quot;</span>
        
    <span class="c1"># Class properties</span>
    <span class="n">_ids</span> <span class="o">=</span> <span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># used to assign IDs to objects</span>
    
    <span class="n">_nNodes_expected</span> <span class="o">=</span> <span class="bp">None</span>
    
    <span class="c1"># Class methods</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_mesh</span><span class="p">,</span> <span class="n">connected_nodes</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates new element, in the context of `parent_mesh`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Prevent direct instatiation of this class</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="n">Element</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;&lt;Element&gt; must be subclassed.&quot;</span><span class="p">)</span>
                
        <span class="bp">self</span><span class="o">.</span><span class="n">parent_mesh</span> <span class="o">=</span> <span class="n">parent_mesh</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parent mesh to which element directly relates</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ids</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sequential integer ID, assigned to uniquely identify object</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        User-assigned name, usually of _string_ type</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">connected_nodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of node objects connecting to this element. Keys are node names</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">gauss_points</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of gauss point objects associated with this element</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Connect to parent mesh</span>
        <span class="k">if</span> <span class="n">parent_mesh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent_mesh</span><span class="o">.</span><span class="n">append_objs</span><span class="p">([</span><span class="bp">self</span><span class="p">])</span>

        <span class="c1"># Connect any nodes passed in as list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect_nodes</span><span class="p">(</span><span class="n">connected_nodes</span><span class="p">)</span>
        
    
    <span class="c1"># -----</span>
          
    
    <span class="k">def</span> <span class="nf">connect_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">node_objs</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_node_objs</span><span class="p">(</span><span class="n">node_objs</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">node_obj</span> <span class="ow">in</span> <span class="n">node_objs</span><span class="p">:</span>
            
            <span class="n">check_class</span><span class="p">(</span><span class="n">node_obj</span><span class="p">,</span><span class="n">Node</span><span class="p">)</span>

            <span class="c1"># Append object to connected nodes list</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connected_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_obj</span><span class="p">)</span>
            
            <span class="c1"># Create two-way linked list</span>
            <span class="n">node_obj</span><span class="o">.</span><span class="n">connect_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            
            
    <span class="k">def</span> <span class="nf">_check_node_objs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">node_objs</span><span class="p">):</span>
        
        <span class="n">N</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nNodes_expected</span>
        
        <span class="k">if</span> <span class="n">N</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">node_objs</span><span class="p">)</span><span class="o">!=</span> <span class="n">N</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unexpected number of nodes supplied &quot;</span>
                                 <span class="s2">&quot;to define element!&quot;</span><span class="p">)</span>
                
            
    <span class="k">def</span> <span class="nf">get_connected_node</span><span class="p">(</span><span class="n">node_index</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
        
        <span class="k">return</span> 
    
    
    
    
    
    <span class="k">def</span> <span class="nf">define_gauss_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Defines gauss points to be associated with element</span>
<span class="sd">        </span>
<span class="sd">        _To be overridden by derived class method_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Not implemented for base class! To be overridden&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#mesh.Element">Element</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="mesh.Element.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, parent_mesh, connected_nodes, name=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates new element, in the context of <code>parent_mesh</code></p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Element.__init__', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Element.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_mesh</span><span class="p">,</span> <span class="n">connected_nodes</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates new element, in the context of `parent_mesh`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Prevent direct instatiation of this class</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="n">Element</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;&lt;Element&gt; must be subclassed.&quot;</span><span class="p">)</span>
            
    <span class="bp">self</span><span class="o">.</span><span class="n">parent_mesh</span> <span class="o">=</span> <span class="n">parent_mesh</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parent mesh to which element directly relates</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ids</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sequential integer ID, assigned to uniquely identify object</span>
<span class="sd">    &quot;&quot;&quot;</span>        
    
    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    User-assigned name, usually of _string_ type</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">connected_nodes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List of node objects connecting to this element. Keys are node names</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">gauss_points</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List of gauss point objects associated with this element</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Connect to parent mesh</span>
    <span class="k">if</span> <span class="n">parent_mesh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent_mesh</span><span class="o">.</span><span class="n">append_objs</span><span class="p">([</span><span class="bp">self</span><span class="p">])</span>
    <span class="c1"># Connect any nodes passed in as list</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">connect_nodes</span><span class="p">(</span><span class="n">connected_nodes</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.Element.connect_nodes">
    <p>def <span class="ident">connect_nodes</span>(</p><p>self, node_objs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Element.connect_nodes', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Element.connect_nodes" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">connect_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">node_objs</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">_check_node_objs</span><span class="p">(</span><span class="n">node_objs</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">node_obj</span> <span class="ow">in</span> <span class="n">node_objs</span><span class="p">:</span>
        
        <span class="n">check_class</span><span class="p">(</span><span class="n">node_obj</span><span class="p">,</span><span class="n">Node</span><span class="p">)</span>
        <span class="c1"># Append object to connected nodes list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connected_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_obj</span><span class="p">)</span>
        
        <span class="c1"># Create two-way linked list</span>
        <span class="n">node_obj</span><span class="o">.</span><span class="n">connect_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.Element.define_gauss_points">
    <p>def <span class="ident">define_gauss_points</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Defines gauss points to be associated with element</p>
<p><em>To be overridden by derived class method</em></p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Element.define_gauss_points', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Element.define_gauss_points" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">define_gauss_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Defines gauss points to be associated with element</span>
<span class="sd">    </span>
<span class="sd">    _To be overridden by derived class method_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Not implemented for base class! To be overridden&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.Element.get_connected_node">
    <p>def <span class="ident">get_connected_node</span>(</p><p>node_index)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Element.get_connected_node', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Element.get_connected_node" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_connected_node</span><span class="p">(</span><span class="n">node_index</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
    
    <span class="k">return</span> 
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="mesh.Element.connected_nodes" class="name">var <span class="ident">connected_nodes</span></p>
            

            
  
    <div class="desc"><p>List of node objects connecting to this element. Keys are node names</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.Element.gauss_points" class="name">var <span class="ident">gauss_points</span></p>
            

            
  
    <div class="desc"><p>List of gauss point objects associated with this element</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.Element.id" class="name">var <span class="ident">id</span></p>
            

            
  
    <div class="desc"><p>Sequential integer ID, assigned to uniquely identify object</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.Element.name" class="name">var <span class="ident">name</span></p>
            

            
  
    <div class="desc"><p>User-assigned name, usually of <em>string</em> type</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.Element.parent_mesh" class="name">var <span class="ident">parent_mesh</span></p>
            

            
  
    <div class="desc"><p>Parent mesh to which element directly relates</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="mesh.ForceResults" class="name">class <span class="ident">ForceResults</span></p>
      
  
    <div class="desc"><p>Class used to store force results, with regards to a given [element, node]
location</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.ForceResults', this);">Show source &equiv;</a></p>
  <div id="source-mesh.ForceResults" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ForceResults</span><span class="p">(</span><span class="n">MeshResults</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class used to store force results, with regards to a given [element, node]</span>
<span class="sd">    location</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">nComponents</span> <span class="o">=</span> <span class="mi">6</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element_obj</span><span class="p">,</span> <span class="n">node_obj</span><span class="p">,</span> <span class="n">results_arr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span><span class="n">element_obj</span><span class="p">,</span><span class="n">node_obj</span><span class="p">],</span> <span class="n">results_arr</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#mesh.ForceResults">ForceResults</a></li>
          <li><a href="#mesh.MeshResults">MeshResults</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="mesh.ForceResults.nComponents" class="name">var <span class="ident">nComponents</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="mesh.ForceResults.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, element_obj, node_obj, results_arr=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.ForceResults.__init__', this);">Show source &equiv;</a></p>
  <div id="source-mesh.ForceResults.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element_obj</span><span class="p">,</span> <span class="n">node_obj</span><span class="p">,</span> <span class="n">results_arr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span><span class="n">element_obj</span><span class="p">,</span><span class="n">node_obj</span><span class="p">],</span> <span class="n">results_arr</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.ForceResults.add">
    <p>def <span class="ident">add</span>(</p><p>self, new_results, verbose=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Appends results for new loadcase</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.ForceResults.add', this);">Show source &equiv;</a></p>
  <div id="source-mesh.ForceResults.add" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">new_results</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Appends results for new loadcase</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Appending new results to location {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">new_results</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.ForceResults.clear">
    <p>def <span class="ident">clear</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Clears results held within object</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.ForceResults.clear', this);">Show source &equiv;</a></p>
  <div id="source-mesh.ForceResults.clear" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Clears results held within object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nComponents</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="mesh.ForceResults.name" class="name">var <span class="ident">name</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#mesh.MeshResults">MeshResults</a></code>.<code><a href="#mesh.MeshResults.name">name</a></code>
    </p>

            
  
    <div class="desc inherited"><p>Returns list comprising names of mesh objects associated</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.ForceResults.values" class="name">var <span class="ident">values</span></p>
            

            
  
    <div class="desc"><p>2d-array of vector results for multiple loadcases. 
Shape is [nLoadcase,nComponents]</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="mesh.GaussPoint" class="name">class <span class="ident">GaussPoint</span></p>
      
  
    <div class="desc"><p>Defines gauss point, i.e. point at specific position within an element
but not at its vertices. Gauss points have weights, which are used when 
performing gauss quadrature (numerical integration)</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.GaussPoint', this);">Show source &equiv;</a></p>
  <div id="source-mesh.GaussPoint" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">GaussPoint</span><span class="p">(</span><span class="n">Point</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Defines gauss point, i.e. point at specific position within an element</span>
<span class="sd">    but not at its vertices. Gauss points have weights, which are used when </span>
<span class="sd">    performing gauss quadrature (numerical integration)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Class properties</span>
    <span class="n">_ids</span> <span class="o">=</span> <span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># used to assign IDs to objects</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">loc</span><span class="p">,</span><span class="n">weight</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
               
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span> <span class="n">loc</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Location of gauss point within [0,1] domain along element to which </span>
<span class="sd">        gauss point relates (useful for interpolation of properties / results </span>
<span class="sd">        found at the end of the element)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="n">weight</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Weight associated with gauss point, for use when carrying out </span>
<span class="sd">        integration by gauss quadrature</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#mesh.GaussPoint">GaussPoint</a></li>
          <li><a href="#mesh.Point">Point</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="mesh.GaussPoint.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, loc, weight, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates new point instance</p>
<hr />
<p>Required:</p>
<ul>
<li><code>xyz</code>, list or array of length 3, defines position of node</li>
</ul>
<hr />
<p>Optional:</p>
<ul>
<li><code>name</code>, <em>string</em> name to identify points</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.GaussPoint.__init__', this);">Show source &equiv;</a></p>
  <div id="source-mesh.GaussPoint.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">loc</span><span class="p">,</span><span class="n">weight</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
           
    <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span> <span class="n">loc</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Location of gauss point within [0,1] domain along element to which </span>
<span class="sd">    gauss point relates (useful for interpolation of properties / results </span>
<span class="sd">    found at the end of the element)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="n">weight</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Weight associated with gauss point, for use when carrying out </span>
<span class="sd">    integration by gauss quadrature</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.GaussPoint.get_x">
    <p>def <span class="ident">get_x</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.GaussPoint.get_x', this);">Show source &equiv;</a></p>
  <div id="source-mesh.GaussPoint.get_x" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.GaussPoint.get_xyz">
    <p>def <span class="ident">get_xyz</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.GaussPoint.get_xyz', this);">Show source &equiv;</a></p>
  <div id="source-mesh.GaussPoint.get_xyz" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.GaussPoint.get_y">
    <p>def <span class="ident">get_y</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.GaussPoint.get_y', this);">Show source &equiv;</a></p>
  <div id="source-mesh.GaussPoint.get_y" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.GaussPoint.get_z">
    <p>def <span class="ident">get_z</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.GaussPoint.get_z', this);">Show source &equiv;</a></p>
  <div id="source-mesh.GaussPoint.get_z" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_z</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="mesh.GaussPoint.loc" class="name">var <span class="ident">loc</span></p>
            

            
  
    <div class="desc"><p>Location of gauss point within [0,1] domain along element to which 
gauss point relates (useful for interpolation of properties / results 
found at the end of the element)</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.GaussPoint.weight" class="name">var <span class="ident">weight</span></p>
            

            
  
    <div class="desc"><p>Weight associated with gauss point, for use when carrying out 
integration by gauss quadrature</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.GaussPoint.x" class="name">var <span class="ident">x</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.GaussPoint.xyz" class="name">var <span class="ident">xyz</span></p>
            

            
  
    <div class="desc"><p>Array of shape (3,) defining position of node</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.GaussPoint.y" class="name">var <span class="ident">y</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.GaussPoint.z" class="name">var <span class="ident">z</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="mesh.LineElement" class="name">class <span class="ident">LineElement</span></p>
      
  
    <div class="desc"><p>Class to implement line elements, i.e. element between two nodes in 3d</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.LineElement', this);">Show source &equiv;</a></p>
  <div id="source-mesh.LineElement" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">LineElement</span><span class="p">(</span><span class="n">Element</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to implement line elements, i.e. element between two nodes in 3d</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">_nNodes_expected</span> <span class="o">=</span> <span class="mi">2</span>
            

    <span class="k">def</span> <span class="nf">get_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns list of (3,) arrays defining unit vectors for each element axis</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Calculate x-axis, taking as being direction vector from end1 to end2</span>
        <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_end_positions</span><span class="p">()</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">-</span> <span class="n">r1</span>
        <span class="n">x</span> <span class="o">/=</span> <span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        
        <span class="c1"># Calculate y-axis</span>
        <span class="c1"># y to lie in horizontal plane orthogonal to x</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">vertical_direction</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">norm</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Special case for vertical members</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Element &#39;</span><span class="si">%s</span><span class="s2">&#39; is vertical&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">default_y_direction</span>
            
        <span class="c1"># Calculate z-axis to be orthogonal to x and y</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    
        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span>
        
        
    <span class="k">def</span> <span class="nf">get_end_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns position vectors of each end of elements</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connected_nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_xyz</span><span class="p">()</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connected_nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_xyz</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span>
    
    
    <span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns length of element i.e. distance between end nodes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_end_positions</span><span class="p">()</span>
        <span class="n">r12</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">-</span> <span class="n">r1</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">r12</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
    
    
    <span class="k">def</span> <span class="nf">get_midpoint_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns position vector denoting the midpoint of element</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_end_positions</span><span class="p">()</span>
        <span class="k">return</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">r1</span><span class="o">+</span><span class="n">r2</span><span class="p">)</span>
    
    
    <span class="k">def</span> <span class="nf">define_gauss_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">N_gp</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Defines gauss points to be associated with element</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Required:</span>
<span class="sd">            </span>
<span class="sd">        * `N_gp`, integer, defines number of gauss points to be defined per </span>
<span class="sd">          element. This relates to accuracy of integration.</span>
<span class="sd">          </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Define weights and locations for gauss points based on [-1,1] domain</span>
        <span class="c1"># Refer https://en.wikipedia.org/wiki/Gaussian_quadrature</span>
        
        <span class="k">if</span> <span class="n">N_gp</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            
            <span class="n">locs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">]</span>
        
        <span class="k">elif</span> <span class="n">N_gp</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            
            <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">locs</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">val</span><span class="p">,</span> <span class="o">+</span><span class="n">val</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">val</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]</span>
            
        <span class="k">elif</span> <span class="n">N_gp</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            
            <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">locs</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">val</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">+</span><span class="n">val</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">val</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">5</span><span class="o">/</span><span class="mi">9</span><span class="p">),(</span><span class="mi">8</span><span class="o">/</span><span class="mi">9</span><span class="p">),(</span><span class="mi">5</span><span class="o">/</span><span class="mi">9</span><span class="p">)]</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;N_gp&gt;3 not yet implemented!&quot;</span><span class="p">)</span>
            
        <span class="c1"># Convert to numpy arrays</span>
        <span class="n">locs</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">locs</span><span class="p">)</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Gauss points for element &#39;</span><span class="si">%s</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> 
                  <span class="s2">&quot;Locs: {0}</span><span class="se">\n</span><span class="s2">Weights:{1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">locs</span><span class="p">,</span><span class="n">weights</span><span class="p">))</span>
        
        <span class="c1"># Convert to [0,L] domain</span>
        <span class="n">L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">()</span>
        <span class="n">weights</span> <span class="o">*=</span> <span class="n">L</span><span class="o">/</span><span class="mi">2</span>
        
        <span class="c1"># Define gauss points</span>
        <span class="n">locs</span> <span class="o">=</span> <span class="p">(</span><span class="n">locs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>                     <span class="c1"># convert to [0,1] domain</span>
        <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_end_positions</span><span class="p">()</span>
        <span class="n">r12</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">-</span> <span class="n">r1</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">gauss_points</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">loc</span><span class="p">,</span><span class="n">weight</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">locs</span><span class="p">,</span><span class="n">weights</span><span class="p">):</span>
            
            <span class="c1"># Calculate position of gauss point</span>
            <span class="n">xyz</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">+</span> <span class="n">loc</span> <span class="o">*</span> <span class="n">r12</span>
            
            <span class="c1"># Define new GaussPoint object and append to list</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gauss_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GaussPoint</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span><span class="n">weight</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span><span class="n">xyz</span><span class="o">=</span><span class="n">xyz</span><span class="p">))</span>
            
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gauss_points</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#mesh.LineElement">LineElement</a></li>
          <li><a href="#mesh.Element">Element</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="mesh.LineElement.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, parent_mesh, connected_nodes, name=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#mesh.Element">Element</a></code>.<code><a href="#mesh.Element.__init__">__init__</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Creates new element, in the context of <code>parent_mesh</code></p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.LineElement.__init__', this);">Show source &equiv;</a></p>
  <div id="source-mesh.LineElement.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_mesh</span><span class="p">,</span> <span class="n">connected_nodes</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates new element, in the context of `parent_mesh`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Prevent direct instatiation of this class</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="n">Element</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;&lt;Element&gt; must be subclassed.&quot;</span><span class="p">)</span>
            
    <span class="bp">self</span><span class="o">.</span><span class="n">parent_mesh</span> <span class="o">=</span> <span class="n">parent_mesh</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parent mesh to which element directly relates</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ids</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sequential integer ID, assigned to uniquely identify object</span>
<span class="sd">    &quot;&quot;&quot;</span>        
    
    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    User-assigned name, usually of _string_ type</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">connected_nodes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List of node objects connecting to this element. Keys are node names</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">gauss_points</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List of gauss point objects associated with this element</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Connect to parent mesh</span>
    <span class="k">if</span> <span class="n">parent_mesh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent_mesh</span><span class="o">.</span><span class="n">append_objs</span><span class="p">([</span><span class="bp">self</span><span class="p">])</span>
    <span class="c1"># Connect any nodes passed in as list</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">connect_nodes</span><span class="p">(</span><span class="n">connected_nodes</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.LineElement.connect_nodes">
    <p>def <span class="ident">connect_nodes</span>(</p><p>self, node_objs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.LineElement.connect_nodes', this);">Show source &equiv;</a></p>
  <div id="source-mesh.LineElement.connect_nodes" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">connect_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">node_objs</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">_check_node_objs</span><span class="p">(</span><span class="n">node_objs</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">node_obj</span> <span class="ow">in</span> <span class="n">node_objs</span><span class="p">:</span>
        
        <span class="n">check_class</span><span class="p">(</span><span class="n">node_obj</span><span class="p">,</span><span class="n">Node</span><span class="p">)</span>
        <span class="c1"># Append object to connected nodes list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connected_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_obj</span><span class="p">)</span>
        
        <span class="c1"># Create two-way linked list</span>
        <span class="n">node_obj</span><span class="o">.</span><span class="n">connect_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.LineElement.define_gauss_points">
    <p>def <span class="ident">define_gauss_points</span>(</p><p>self, N_gp=3, verbose=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Defines gauss points to be associated with element</p>
<hr />
<p>Required:</p>
<ul>
<li><code>N_gp</code>, integer, defines number of gauss points to be defined per 
  element. This relates to accuracy of integration.</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.LineElement.define_gauss_points', this);">Show source &equiv;</a></p>
  <div id="source-mesh.LineElement.define_gauss_points" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">define_gauss_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">N_gp</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Defines gauss points to be associated with element</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    Required:</span>
<span class="sd">        </span>
<span class="sd">    * `N_gp`, integer, defines number of gauss points to be defined per </span>
<span class="sd">      element. This relates to accuracy of integration.</span>
<span class="sd">      </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Define weights and locations for gauss points based on [-1,1] domain</span>
    <span class="c1"># Refer https://en.wikipedia.org/wiki/Gaussian_quadrature</span>
    
    <span class="k">if</span> <span class="n">N_gp</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        
        <span class="n">locs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">]</span>
    
    <span class="k">elif</span> <span class="n">N_gp</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        
        <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">locs</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">val</span><span class="p">,</span> <span class="o">+</span><span class="n">val</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">val</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]</span>
        
    <span class="k">elif</span> <span class="n">N_gp</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        
        <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">locs</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">val</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">+</span><span class="n">val</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">val</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">5</span><span class="o">/</span><span class="mi">9</span><span class="p">),(</span><span class="mi">8</span><span class="o">/</span><span class="mi">9</span><span class="p">),(</span><span class="mi">5</span><span class="o">/</span><span class="mi">9</span><span class="p">)]</span>
        
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;N_gp&gt;3 not yet implemented!&quot;</span><span class="p">)</span>
        
    <span class="c1"># Convert to numpy arrays</span>
    <span class="n">locs</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">locs</span><span class="p">)</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Gauss points for element &#39;</span><span class="si">%s</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> 
              <span class="s2">&quot;Locs: {0}</span><span class="se">\n</span><span class="s2">Weights:{1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">locs</span><span class="p">,</span><span class="n">weights</span><span class="p">))</span>
    
    <span class="c1"># Convert to [0,L] domain</span>
    <span class="n">L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">()</span>
    <span class="n">weights</span> <span class="o">*=</span> <span class="n">L</span><span class="o">/</span><span class="mi">2</span>
    
    <span class="c1"># Define gauss points</span>
    <span class="n">locs</span> <span class="o">=</span> <span class="p">(</span><span class="n">locs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>                     <span class="c1"># convert to [0,1] domain</span>
    <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_end_positions</span><span class="p">()</span>
    <span class="n">r12</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">-</span> <span class="n">r1</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">gauss_points</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">loc</span><span class="p">,</span><span class="n">weight</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">locs</span><span class="p">,</span><span class="n">weights</span><span class="p">):</span>
        
        <span class="c1"># Calculate position of gauss point</span>
        <span class="n">xyz</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">+</span> <span class="n">loc</span> <span class="o">*</span> <span class="n">r12</span>
        
        <span class="c1"># Define new GaussPoint object and append to list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gauss_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GaussPoint</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span><span class="n">weight</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span><span class="n">xyz</span><span class="o">=</span><span class="n">xyz</span><span class="p">))</span>
        
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gauss_points</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.LineElement.get_axes">
    <p>def <span class="ident">get_axes</span>(</p><p>self, verbose=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns list of (3,) arrays defining unit vectors for each element axis</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.LineElement.get_axes', this);">Show source &equiv;</a></p>
  <div id="source-mesh.LineElement.get_axes" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns list of (3,) arrays defining unit vectors for each element axis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Calculate x-axis, taking as being direction vector from end1 to end2</span>
    <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_end_positions</span><span class="p">()</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">-</span> <span class="n">r1</span>
    <span class="n">x</span> <span class="o">/=</span> <span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="c1"># Calculate y-axis</span>
    <span class="c1"># y to lie in horizontal plane orthogonal to x</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">vertical_direction</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">norm</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Special case for vertical members</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Element &#39;</span><span class="si">%s</span><span class="s2">&#39; is vertical&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">default_y_direction</span>
        
    <span class="c1"># Calculate z-axis to be orthogonal to x and y</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.LineElement.get_connected_node">
    <p>def <span class="ident">get_connected_node</span>(</p><p>node_index)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.LineElement.get_connected_node', this);">Show source &equiv;</a></p>
  <div id="source-mesh.LineElement.get_connected_node" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_connected_node</span><span class="p">(</span><span class="n">node_index</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
    
    <span class="k">return</span> 
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.LineElement.get_end_positions">
    <p>def <span class="ident">get_end_positions</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns position vectors of each end of elements</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.LineElement.get_end_positions', this);">Show source &equiv;</a></p>
  <div id="source-mesh.LineElement.get_end_positions" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_end_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns position vectors of each end of elements</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connected_nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_xyz</span><span class="p">()</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connected_nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_xyz</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.LineElement.get_midpoint_xyz">
    <p>def <span class="ident">get_midpoint_xyz</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns position vector denoting the midpoint of element</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.LineElement.get_midpoint_xyz', this);">Show source &equiv;</a></p>
  <div id="source-mesh.LineElement.get_midpoint_xyz" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_midpoint_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns position vector denoting the midpoint of element</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_end_positions</span><span class="p">()</span>
    <span class="k">return</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">r1</span><span class="o">+</span><span class="n">r2</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.LineElement.length">
    <p>def <span class="ident">length</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns length of element i.e. distance between end nodes</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.LineElement.length', this);">Show source &equiv;</a></p>
  <div id="source-mesh.LineElement.length" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns length of element i.e. distance between end nodes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_end_positions</span><span class="p">()</span>
    <span class="n">r12</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">-</span> <span class="n">r1</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">r12</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="mesh.Mesh" class="name">class <span class="ident">Mesh</span></p>
      
  
    <div class="desc"><p>Class is used to define a mesh, i.e. nodes inter-connected by elements</p>
<p>Meshes of meshes are also permissible</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Mesh', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Mesh" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Mesh</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class is used to define a mesh, i.e. nodes inter-connected by elements</span>
<span class="sd">    </span>
<span class="sd">    Meshes of meshes are also permissible</span>
<span class="sd">    &quot;&quot;&quot;</span>
        
    <span class="c1"># Class properties</span>
    <span class="n">_ids</span> <span class="o">=</span> <span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># used to assign IDs to objects</span>
    
    <span class="c1"># Class methods</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">mesh_objs</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="p">[],</span>
                 <span class="n">node_objs</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="p">[],</span>
                 <span class="n">element_objs</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialises mesh with sub-meshes, nodes and elements</span>
<span class="sd">        </span>
<span class="sd">        These can be passed in via dicts `mesh_objs`, `node_objs` and </span>
<span class="sd">        `element_objs` or alternatively be appended once object initialised </span>
<span class="sd">        using class methods provided for the purpose</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ids</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sequential integer ID, assigned to uniquely identify object</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Mesh </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        User-assigned name, usually of _string_ type</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Create empty dictionary attributes to contain objects within</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_objs</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="p">:</span> <span class="bp">self</span><span class="p">}</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dict of mesh objects related to this mesh. Will always include `self` </span>
<span class="sd">        but also any sub-meshes defined. Keys are names of each mesh</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">node_objs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dict of node objects directly related to this mesh. Keys are names of </span>
<span class="sd">        each node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">element_objs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dict of element objects directly related to this mesh. Keys are names </span>
<span class="sd">        of each node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Append objects passed-in via lists</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append_objs</span><span class="p">(</span><span class="n">mesh_objs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append_objs</span><span class="p">(</span><span class="n">element_objs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append_objs</span><span class="p">(</span><span class="n">node_objs</span><span class="p">)</span>
        
        
    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">calc_extents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine xyz extents of mesh</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Get list mesh objects to include in extent calculation</span>
        <span class="n">mesh_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connected_meshes</span><span class="p">(</span><span class="n">get_full_tree</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

        <span class="c1"># Loop over all nodes in all meshes</span>
        <span class="n">node_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">mesh_obj</span> <span class="ow">in</span> <span class="n">mesh_list</span><span class="p">:</span>
            
            <span class="n">node_list</span> <span class="o">=</span> <span class="n">mesh_obj</span><span class="o">.</span><span class="n">node_objs</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            
            <span class="k">for</span> <span class="n">node_obj</span> <span class="ow">in</span> <span class="n">node_list</span><span class="p">:</span>
               
                <span class="n">node_count</span> <span class="o">+=</span> <span class="mi">1</span>                
                <span class="n">xyz_vals</span><span class="o">=</span><span class="n">node_obj</span><span class="o">.</span><span class="n">get_xyz</span><span class="p">()</span>
                
                <span class="k">if</span> <span class="n">node_count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">xyz_min</span> <span class="o">=</span> <span class="n">xyz_vals</span>
                    <span class="n">xyz_max</span> <span class="o">=</span> <span class="n">xyz_vals</span>
                
                <span class="n">xyz_min</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">xyz_min</span><span class="p">,</span><span class="n">xyz_vals</span><span class="p">)</span>
                <span class="n">xyz_max</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">xyz_max</span><span class="p">,</span><span class="n">xyz_vals</span><span class="p">)</span>
                  
        <span class="k">if</span> <span class="n">node_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    
            <span class="c1"># Reshape into nested list</span>
            <span class="n">xyz_lim</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">xyz_min</span><span class="p">,</span><span class="n">xyz_max</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">xyz_lim</span>
                    
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Warning: mesh &#39;</span><span class="si">%s</span><span class="s2">&#39; does not have any nodes!</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> 
                  <span class="s2">&quot;Could not evaluate mesh extents&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">None</span>
        
    
    <span class="k">def</span> <span class="nf">append_objs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj_list</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Append objects to mesh</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># create list in case of single object input</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj_list</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">):</span>
            <span class="n">obj_list</span><span class="o">=</span><span class="p">[</span><span class="n">obj_list</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">obj_list</span><span class="p">:</span>
          
            <span class="c1"># Create link to this mesh object, to which object now belongs</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">parent_mesh</span><span class="o">=</span><span class="bp">self</span> 
    
            <span class="c1"># Add new objects to dictionaries according to class</span>
            <span class="n">class_name_list</span> <span class="o">=</span> <span class="n">getmro</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">Mesh</span> <span class="ow">in</span> <span class="n">class_name_list</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mesh_objs</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
                
            <span class="k">elif</span> <span class="n">Element</span> <span class="ow">in</span> <span class="n">class_name_list</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">element_objs</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
                
            <span class="k">elif</span> <span class="n">Node</span> <span class="ow">in</span> <span class="n">class_name_list</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">node_objs</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
            
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unexpected object!</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">+</span> 
                                 <span class="s2">&quot;Class list{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">class_name_list</span><span class="p">))</span>
            
            
    <span class="k">def</span> <span class="nf">define_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">df</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">fname</span><span class="o">=</span><span class="s1">&#39;nodes.csv&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to define nodes from tabulated input</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Pandas Dataframe containing the following columns to be provided:</span>
<span class="sd">        </span>
<span class="sd">        | Node | X   | Y   | Z   | </span>
<span class="sd">        | ...  | ... | ... | ... | </span>
<span class="sd">        </span>
<span class="sd">        or alternatively `fName` defines .csv file containing similar input</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Use pandas to read in data as dataframe</span>
        <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span>
                                 <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                 <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">],</span>
                                 <span class="n">index_col</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                                 <span class="n">converters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Node&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">},</span>
                                 <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="c1"># Loop through rows in dataframe</span>
        <span class="n">node_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            
            <span class="c1"># Define new node object</span>
            <span class="n">new_node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">parent_mesh</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Node&quot;</span><span class="p">],</span>
                            <span class="n">xyz</span><span class="o">=</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]])</span>
            
            <span class="n">node_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_node</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">append_objs</span><span class="p">(</span><span class="n">node_list</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">node_list</span>
    
            
    <span class="k">def</span> <span class="nf">define_line_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">df</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">fname</span><span class="o">=</span><span class="s2">&quot;elements.csv&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to read element connectivity from tabulated input</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Pandas Dataframe containing the following columns to be provided:</span>
<span class="sd">        </span>
<span class="sd">        | Member | EndJ  | EndK  |</span>
<span class="sd">        | ...    | ...   | ...   |</span>
<span class="sd">        </span>
<span class="sd">        or alternatively `fName` defines .csv file containing similar input</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Use pandas to read in data as dataframe</span>
        <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                                 <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            
        <span class="c1"># Loop throuh rows in dataframe</span>
        <span class="n">element_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            
            <span class="c1"># Get node objects for each end</span>
            <span class="n">node1_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_objs</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;EndJ&quot;</span><span class="p">]]</span>
            <span class="n">node2_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_objs</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;EndK&quot;</span><span class="p">]]</span>
            
            <span class="c1"># Define new line element</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="n">LineElement</span><span class="p">(</span><span class="n">parent_mesh</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                              <span class="n">name</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;Member&quot;</span><span class="p">],</span>
                              <span class="n">connected_nodes</span><span class="o">=</span><span class="p">[</span><span class="n">node1_obj</span><span class="p">,</span><span class="n">node2_obj</span><span class="p">])</span>
            
            <span class="n">element_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_obj</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">append_objs</span><span class="p">(</span><span class="n">element_list</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">element_list</span>
    
    
    <span class="k">def</span> <span class="nf">define_gauss_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">N_gp</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loops over all elements in mesh, defining gauss points</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">element_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_objs</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">N_gp</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">N_gp</span><span class="p">)</span><span class="o">!=</span><span class="nb">len</span><span class="p">(</span><span class="n">element_list</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Length of `N_gp` list does not agree &quot;</span> <span class="o">+</span> 
                                 <span class="s2">&quot;with total number of elements&quot;</span><span class="p">)</span>
                
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">N_gp</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`N_gp` to be either `int` or `list`&quot;</span><span class="p">)</span>
                
                        
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">element_obj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">element_list</span><span class="p">):</span>
            
            <span class="c1"># Determine number of gauss points required for this element</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">N_gp</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">n</span> <span class="o">=</span> <span class="n">N_gp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                
            <span class="k">else</span><span class="p">:</span>
                <span class="n">n</span> <span class="o">=</span> <span class="n">N_gp</span>
                
            <span class="c1"># Define gps</span>
            <span class="n">element_obj</span><span class="o">.</span><span class="n">define_gauss_points</span><span class="p">(</span><span class="n">N_gp</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
    
    
    <span class="k">def</span> <span class="nf">get_connected_meshes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">get_full_tree</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns list including all mesh objects associated with mesh object </span>
<span class="sd">        </span>
<span class="sd">        Optional:</span>
<span class="sd">            </span>
<span class="sd">        * `get_full_tree`, _boolean_, if True then full mesh tree will be </span>
<span class="sd">          returned. If False (default) then only meshes which are sub-meshes to </span>
<span class="sd">          _self_ will be returned</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">mesh_obj</span><span class="p">,</span> <span class="n">visited</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">add_parent</span><span class="o">=</span><span class="n">get_full_tree</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Method to implement depth-first search through mesh tree</span>
<span class="sd">            &quot;&quot;&quot;</span>
        
            <span class="k">if</span> <span class="n">visited</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            
            <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">mesh_obj</span><span class="p">)</span>
                
            <span class="c1"># Get adjacency list for current mesh object</span>
            <span class="n">connected_meshes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mesh_obj</span><span class="o">.</span><span class="n">mesh_objs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            
            <span class="k">if</span> <span class="n">add_parent</span><span class="p">:</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="s1">&#39;parent_mesh&#39;</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">mesh_obj</span><span class="p">,</span><span class="n">attr</span><span class="p">):</span>
                    <span class="n">connected_meshes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">mesh_obj</span><span class="p">,</span><span class="n">attr</span><span class="p">))</span>
                
            <span class="c1"># Recursively run function if current mesh object not in visited set</span>
            <span class="k">for</span> <span class="nb">next</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">connected_meshes</span><span class="p">)</span> <span class="o">-</span> <span class="n">visited</span><span class="p">:</span>
                <span class="n">dfs</span><span class="p">(</span><span class="nb">next</span><span class="p">,</span> <span class="n">visited</span><span class="o">=</span><span class="n">visited</span><span class="p">,</span> <span class="n">add_parent</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                
            <span class="k">return</span> <span class="n">visited</span>
    
        <span class="n">mesh_obj_list</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mesh_obj_list</span>


    <span class="k">def</span> <span class="nf">get_gauss_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns all nested list to describe all gauss points associated with </span>
<span class="sd">        mesh via its elements</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gp_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_objs</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">gp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">gauss_points</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gp_list</span>

    
    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">set_axis_limits</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
             <span class="n">set_square_axes</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
             <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots mesh and all sub-meshes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Plotting mesh &#39;</span><span class="si">%s</span><span class="s2">&#39;...&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
        <span class="c1"># Get list of all related meshes</span>
        <span class="n">mesh_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connected_meshes</span><span class="p">(</span><span class="n">get_full_tree</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">mesh_obj</span> <span class="ow">in</span> <span class="n">mesh_list</span><span class="p">:</span>
                
            <span class="n">ax</span> <span class="o">=</span> <span class="n">mesh_obj</span><span class="o">.</span><span class="n">_plot_init</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">mesh_obj</span><span class="o">.</span><span class="n">_plot_update</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">set_axis_limits</span><span class="p">:</span>
            
            <span class="n">axis_limits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_extents</span><span class="p">()</span>
                            
            <span class="k">if</span> <span class="ow">not</span> <span class="n">set_square_axes</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">axis_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">axis_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="n">axis_limits</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                
            <span class="k">else</span><span class="p">:</span>
                
                <span class="c1"># Draw hidden line to ensure proper scaling of axes</span>
                <span class="n">set_equal_aspect_3d</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">axis_limits</span><span class="p">)</span>
                
        
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">ax</span>
    
    
    <span class="k">def</span> <span class="nf">_plot_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">plot_gps</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">plot_axes</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialises mesh plot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
        
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;X (m)&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Y (m)&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s2">&quot;Z (m)&quot;</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span>
        
        <span class="c1"># Define plot artists (n.b. data set in plot_update)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="s1">&#39;elements&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],[],</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="s1">&#39;nodes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],[],</span><span class="s1">&#39;k.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">plot_gps</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="s1">&#39;gauss_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],[],</span><span class="s1">&#39;g.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            
        <span class="k">if</span> <span class="n">plot_axes</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="s1">&#39;x_axes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">([],[],[],</span>
                                                     <span class="p">[],[],[],</span>
                                                     <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                                                     <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="s1">&#39;y_axes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">([],[],[],</span>
                                                     <span class="p">[],[],[],</span>
                                                     <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                                                     <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="s1">&#39;z_axes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">([],[],[],</span>
                                                     <span class="p">[],[],[],</span>
                                                     <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                                                     <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">ax</span>
    
    
    <span class="k">def</span> <span class="nf">_plot_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates mesh plot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Plot all nodes</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_nodes</span><span class="p">():</span>
            
            <span class="n">node_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_objs</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="n">XYZ</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">obj</span><span class="o">.</span><span class="n">xyz</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">node_list</span><span class="p">])</span>
            
            <span class="n">node_artist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="s1">&#39;nodes&#39;</span><span class="p">]</span>
            <span class="n">node_artist</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">XYZ</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">XYZ</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">node_artist</span><span class="o">.</span><span class="n">set_3d_properties</span><span class="p">(</span><span class="n">XYZ</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>
        
        <span class="c1"># Plot all elements</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_elements</span><span class="p">():</span>
            
            <span class="n">element_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_objs</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            
            <span class="n">xyz_end1</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">element_obj</span><span class="o">.</span><span class="n">connected_nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_xyz</span><span class="p">()</span> 
                                 <span class="k">for</span> <span class="n">element_obj</span> <span class="ow">in</span> <span class="n">element_list</span><span class="p">])</span>
            
            <span class="n">xyz_end2</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">element_obj</span><span class="o">.</span><span class="n">connected_nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_xyz</span><span class="p">()</span> 
                                 <span class="k">for</span> <span class="n">element_obj</span> <span class="ow">in</span> <span class="n">element_list</span><span class="p">])</span>
        
            <span class="n">nan</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">element_list</span><span class="p">),),</span><span class="n">npy</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span> <span class="c1"># used to create gaps</span>
            
            <span class="n">X</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">xyz_end1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">xyz_end2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">nan</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
            <span class="n">Y</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">xyz_end1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">xyz_end2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">nan</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
            <span class="n">Z</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">npy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">xyz_end1</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">xyz_end2</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">nan</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        
            <span class="n">elements</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="s1">&#39;elements&#39;</span><span class="p">]</span>
            <span class="n">elements</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
            <span class="n">elements</span><span class="o">.</span><span class="n">set_3d_properties</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
            <span class="n">elements</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        
        <span class="c1"># Plot gauss points</span>
        <span class="n">attr</span> <span class="o">=</span> <span class="s1">&#39;gauss_points&#39;</span>
        <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">:</span>
            
            <span class="n">gp_artist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span>
            
            <span class="n">gp_XYZ</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">gp</span><span class="o">.</span><span class="n">xyz</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">element_list</span>
                                <span class="k">for</span> <span class="n">gp</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">gauss_points</span><span class="p">])</span>
        
            <span class="n">gp_artist</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">gp_XYZ</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">gp_XYZ</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">gp_artist</span><span class="o">.</span><span class="n">set_3d_properties</span><span class="p">(</span><span class="n">gp_XYZ</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>
            
        <span class="c1"># Plot local axes</span>
        <span class="n">attr</span> <span class="o">=</span> <span class="s1">&#39;x_axes&#39;</span>
        <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">:</span>
            
            <span class="n">x_axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="s1">&#39;x_axes&#39;</span><span class="p">]</span>
            <span class="n">y_axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="s1">&#39;y_axes&#39;</span><span class="p">]</span>
            <span class="n">z_axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span><span class="p">[</span><span class="s1">&#39;z_axes&#39;</span><span class="p">]</span>
            
            <span class="n">element_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_objs</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            
            <span class="n">origin</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">e</span><span class="o">.</span><span class="n">get_midpoint_xyz</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">element_list</span><span class="p">])</span>
            
            <span class="n">axes</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">e</span><span class="o">.</span><span class="n">get_axes</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">element_list</span><span class="p">])</span>
            <span class="n">ex</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,:]</span>
            <span class="n">ey</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[:,</span><span class="mi">1</span><span class="p">,:]</span>
            <span class="n">ez</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[:,</span><span class="mi">2</span><span class="p">,:]</span>
            
            <span class="n">sf</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="c1"># scale factor for element axes</span>
            <span class="n">x_axes</span><span class="o">.</span><span class="n">set_segments</span><span class="p">([[</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span><span class="n">sf</span><span class="o">*</span><span class="n">ex</span><span class="p">)])</span>
            <span class="n">y_axes</span><span class="o">.</span><span class="n">set_segments</span><span class="p">([[</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span><span class="n">sf</span><span class="o">*</span><span class="n">ey</span><span class="p">)])</span>
            <span class="n">z_axes</span><span class="o">.</span><span class="n">set_segments</span><span class="p">([[</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span><span class="n">sf</span><span class="o">*</span><span class="n">ez</span><span class="p">)])</span>
        
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_artists</span>


    <span class="k">def</span> <span class="nf">has_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node_objs</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">1</span>
    
    <span class="k">def</span> <span class="nf">has_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element_objs</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">1</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#mesh.Mesh">Mesh</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="mesh.Mesh.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, name=None, mesh_objs=[], node_objs=[], element_objs=[])</p>
    </div>
    

    
  
    <div class="desc"><p>Initialises mesh with sub-meshes, nodes and elements</p>
<p>These can be passed in via dicts <code>mesh_objs</code>, <code>node_objs</code> and 
<code>element_objs</code> or alternatively be appended once object initialised 
using class methods provided for the purpose</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Mesh.__init__', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Mesh.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">mesh_objs</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="p">[],</span>
             <span class="n">node_objs</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="p">[],</span>
             <span class="n">element_objs</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialises mesh with sub-meshes, nodes and elements</span>
<span class="sd">    </span>
<span class="sd">    These can be passed in via dicts `mesh_objs`, `node_objs` and </span>
<span class="sd">    `element_objs` or alternatively be appended once object initialised </span>
<span class="sd">    using class methods provided for the purpose</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ids</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sequential integer ID, assigned to uniquely identify object</span>
<span class="sd">    &quot;&quot;&quot;</span>        
    
    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Mesh </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    User-assigned name, usually of _string_ type</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Create empty dictionary attributes to contain objects within</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mesh_objs</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="p">:</span> <span class="bp">self</span><span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dict of mesh objects related to this mesh. Will always include `self` </span>
<span class="sd">    but also any sub-meshes defined. Keys are names of each mesh</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">node_objs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dict of node objects directly related to this mesh. Keys are names of </span>
<span class="sd">    each node</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">element_objs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dict of element objects directly related to this mesh. Keys are names </span>
<span class="sd">    of each node</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Append objects passed-in via lists</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">append_objs</span><span class="p">(</span><span class="n">mesh_objs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">append_objs</span><span class="p">(</span><span class="n">element_objs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">append_objs</span><span class="p">(</span><span class="n">node_objs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.Mesh.append_objs">
    <p>def <span class="ident">append_objs</span>(</p><p>self, obj_list)</p>
    </div>
    

    
  
    <div class="desc"><p>Append objects to mesh</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Mesh.append_objs', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Mesh.append_objs" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">append_objs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj_list</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Append objects to mesh</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># create list in case of single object input</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj_list</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">):</span>
        <span class="n">obj_list</span><span class="o">=</span><span class="p">[</span><span class="n">obj_list</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">obj_list</span><span class="p">:</span>
      
        <span class="c1"># Create link to this mesh object, to which object now belongs</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">parent_mesh</span><span class="o">=</span><span class="bp">self</span> 

        <span class="c1"># Add new objects to dictionaries according to class</span>
        <span class="n">class_name_list</span> <span class="o">=</span> <span class="n">getmro</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">Mesh</span> <span class="ow">in</span> <span class="n">class_name_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mesh_objs</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
            
        <span class="k">elif</span> <span class="n">Element</span> <span class="ow">in</span> <span class="n">class_name_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">element_objs</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
            
        <span class="k">elif</span> <span class="n">Node</span> <span class="ow">in</span> <span class="n">class_name_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">node_objs</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unexpected object!</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">+</span> 
                             <span class="s2">&quot;Class list{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">class_name_list</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.Mesh.calc_extents">
    <p>def <span class="ident">calc_extents</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Determine xyz extents of mesh</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Mesh.calc_extents', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Mesh.calc_extents" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">calc_extents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determine xyz extents of mesh</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Get list mesh objects to include in extent calculation</span>
    <span class="n">mesh_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connected_meshes</span><span class="p">(</span><span class="n">get_full_tree</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="c1"># Loop over all nodes in all meshes</span>
    <span class="n">node_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">mesh_obj</span> <span class="ow">in</span> <span class="n">mesh_list</span><span class="p">:</span>
        
        <span class="n">node_list</span> <span class="o">=</span> <span class="n">mesh_obj</span><span class="o">.</span><span class="n">node_objs</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        
        <span class="k">for</span> <span class="n">node_obj</span> <span class="ow">in</span> <span class="n">node_list</span><span class="p">:</span>
           
            <span class="n">node_count</span> <span class="o">+=</span> <span class="mi">1</span>                
            <span class="n">xyz_vals</span><span class="o">=</span><span class="n">node_obj</span><span class="o">.</span><span class="n">get_xyz</span><span class="p">()</span>
            
            <span class="k">if</span> <span class="n">node_count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">xyz_min</span> <span class="o">=</span> <span class="n">xyz_vals</span>
                <span class="n">xyz_max</span> <span class="o">=</span> <span class="n">xyz_vals</span>
            
            <span class="n">xyz_min</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">xyz_min</span><span class="p">,</span><span class="n">xyz_vals</span><span class="p">)</span>
            <span class="n">xyz_max</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">xyz_max</span><span class="p">,</span><span class="n">xyz_vals</span><span class="p">)</span>
              
    <span class="k">if</span> <span class="n">node_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                
        <span class="c1"># Reshape into nested list</span>
        <span class="n">xyz_lim</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">xyz_min</span><span class="p">,</span><span class="n">xyz_max</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">xyz_lim</span>
                
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Warning: mesh &#39;</span><span class="si">%s</span><span class="s2">&#39; does not have any nodes!</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> 
              <span class="s2">&quot;Could not evaluate mesh extents&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.Mesh.define_gauss_points">
    <p>def <span class="ident">define_gauss_points</span>(</p><p>self, N_gp=2, verbose=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Loops over all elements in mesh, defining gauss points</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Mesh.define_gauss_points', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Mesh.define_gauss_points" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">define_gauss_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">N_gp</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loops over all elements in mesh, defining gauss points</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">element_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_objs</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">N_gp</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">N_gp</span><span class="p">)</span><span class="o">!=</span><span class="nb">len</span><span class="p">(</span><span class="n">element_list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Length of `N_gp` list does not agree &quot;</span> <span class="o">+</span> 
                             <span class="s2">&quot;with total number of elements&quot;</span><span class="p">)</span>
            
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">N_gp</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`N_gp` to be either `int` or `list`&quot;</span><span class="p">)</span>
            
                    
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">element_obj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">element_list</span><span class="p">):</span>
        
        <span class="c1"># Determine number of gauss points required for this element</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">N_gp</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">N_gp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">N_gp</span>
            
        <span class="c1"># Define gps</span>
        <span class="n">element_obj</span><span class="o">.</span><span class="n">define_gauss_points</span><span class="p">(</span><span class="n">N_gp</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.Mesh.define_line_elements">
    <p>def <span class="ident">define_line_elements</span>(</p><p>self, df=None, fname=&#39;elements.csv&#39;, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Function to read element connectivity from tabulated input</p>
<hr />
<p>Pandas Dataframe containing the following columns to be provided:</p>
<p>| Member | EndJ  | EndK  |
| ...    | ...   | ...   |</p>
<p>or alternatively <code>fName</code> defines .csv file containing similar input</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Mesh.define_line_elements', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Mesh.define_line_elements" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">define_line_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">df</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">fname</span><span class="o">=</span><span class="s2">&quot;elements.csv&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to read element connectivity from tabulated input</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    Pandas Dataframe containing the following columns to be provided:</span>
<span class="sd">    </span>
<span class="sd">    | Member | EndJ  | EndK  |</span>
<span class="sd">    | ...    | ...   | ...   |</span>
<span class="sd">    </span>
<span class="sd">    or alternatively `fName` defines .csv file containing similar input</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Use pandas to read in data as dataframe</span>
    <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                             <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
    <span class="c1"># Loop throuh rows in dataframe</span>
    <span class="n">element_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        
        <span class="c1"># Get node objects for each end</span>
        <span class="n">node1_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_objs</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;EndJ&quot;</span><span class="p">]]</span>
        <span class="n">node2_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_objs</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;EndK&quot;</span><span class="p">]]</span>
        
        <span class="c1"># Define new line element</span>
        <span class="n">new_obj</span> <span class="o">=</span> <span class="n">LineElement</span><span class="p">(</span><span class="n">parent_mesh</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                          <span class="n">name</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;Member&quot;</span><span class="p">],</span>
                          <span class="n">connected_nodes</span><span class="o">=</span><span class="p">[</span><span class="n">node1_obj</span><span class="p">,</span><span class="n">node2_obj</span><span class="p">])</span>
        
        <span class="n">element_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_obj</span><span class="p">)</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">append_objs</span><span class="p">(</span><span class="n">element_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">element_list</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.Mesh.define_nodes">
    <p>def <span class="ident">define_nodes</span>(</p><p>self, df=None, fname=&#39;nodes.csv&#39;, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Function to define nodes from tabulated input</p>
<hr />
<p>Pandas Dataframe containing the following columns to be provided:</p>
<p>| Node | X   | Y   | Z   | 
| ...  | ... | ... | ... | </p>
<p>or alternatively <code>fName</code> defines .csv file containing similar input</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Mesh.define_nodes', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Mesh.define_nodes" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">define_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">df</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">fname</span><span class="o">=</span><span class="s1">&#39;nodes.csv&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to define nodes from tabulated input</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    Pandas Dataframe containing the following columns to be provided:</span>
<span class="sd">    </span>
<span class="sd">    | Node | X   | Y   | Z   | </span>
<span class="sd">    | ...  | ... | ... | ... | </span>
<span class="sd">    </span>
<span class="sd">    or alternatively `fName` defines .csv file containing similar input</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Use pandas to read in data as dataframe</span>
    <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span>
                             <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                             <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">],</span>
                             <span class="n">index_col</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                             <span class="n">converters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Node&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">},</span>
                             <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
    <span class="c1"># Loop through rows in dataframe</span>
    <span class="n">node_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        
        <span class="c1"># Define new node object</span>
        <span class="n">new_node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">parent_mesh</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Node&quot;</span><span class="p">],</span>
                        <span class="n">xyz</span><span class="o">=</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]])</span>
        
        <span class="n">node_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_node</span><span class="p">)</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">append_objs</span><span class="p">(</span><span class="n">node_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">node_list</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.Mesh.get_connected_meshes">
    <p>def <span class="ident">get_connected_meshes</span>(</p><p>self, get_full_tree=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns list including all mesh objects associated with mesh object </p>
<p>Optional:</p>
<ul>
<li><code>get_full_tree</code>, <em>boolean</em>, if True then full mesh tree will be 
  returned. If False (default) then only meshes which are sub-meshes to 
  <em>self</em> will be returned</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Mesh.get_connected_meshes', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Mesh.get_connected_meshes" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_connected_meshes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">get_full_tree</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns list including all mesh objects associated with mesh object </span>
<span class="sd">    </span>
<span class="sd">    Optional:</span>
<span class="sd">        </span>
<span class="sd">    * `get_full_tree`, _boolean_, if True then full mesh tree will be </span>
<span class="sd">      returned. If False (default) then only meshes which are sub-meshes to </span>
<span class="sd">      _self_ will be returned</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">mesh_obj</span><span class="p">,</span> <span class="n">visited</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">add_parent</span><span class="o">=</span><span class="n">get_full_tree</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to implement depth-first search through mesh tree</span>
<span class="sd">        &quot;&quot;&quot;</span>
    
        <span class="k">if</span> <span class="n">visited</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        
        <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">mesh_obj</span><span class="p">)</span>
            
        <span class="c1"># Get adjacency list for current mesh object</span>
        <span class="n">connected_meshes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mesh_obj</span><span class="o">.</span><span class="n">mesh_objs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        
        <span class="k">if</span> <span class="n">add_parent</span><span class="p">:</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="s1">&#39;parent_mesh&#39;</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">mesh_obj</span><span class="p">,</span><span class="n">attr</span><span class="p">):</span>
                <span class="n">connected_meshes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">mesh_obj</span><span class="p">,</span><span class="n">attr</span><span class="p">))</span>
            
        <span class="c1"># Recursively run function if current mesh object not in visited set</span>
        <span class="k">for</span> <span class="nb">next</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">connected_meshes</span><span class="p">)</span> <span class="o">-</span> <span class="n">visited</span><span class="p">:</span>
            <span class="n">dfs</span><span class="p">(</span><span class="nb">next</span><span class="p">,</span> <span class="n">visited</span><span class="o">=</span><span class="n">visited</span><span class="p">,</span> <span class="n">add_parent</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">visited</span>

    <span class="n">mesh_obj_list</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mesh_obj_list</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.Mesh.get_gauss_points">
    <p>def <span class="ident">get_gauss_points</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns all nested list to describe all gauss points associated with 
mesh via its elements</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Mesh.get_gauss_points', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Mesh.get_gauss_points" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_gauss_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns all nested list to describe all gauss points associated with </span>
<span class="sd">    mesh via its elements</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gp_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_objs</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">gp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">gauss_points</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gp_list</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.Mesh.has_elements">
    <p>def <span class="ident">has_elements</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Mesh.has_elements', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Mesh.has_elements" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">has_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element_objs</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">1</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.Mesh.has_nodes">
    <p>def <span class="ident">has_nodes</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Mesh.has_nodes', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Mesh.has_nodes" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">has_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node_objs</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">1</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.Mesh.plot">
    <p>def <span class="ident">plot</span>(</p><p>self, ax=None, set_axis_limits=True, set_square_axes=True, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Plots mesh and all sub-meshes</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Mesh.plot', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Mesh.plot" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
         <span class="n">set_axis_limits</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
         <span class="n">set_square_axes</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
         <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots mesh and all sub-meshes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Plotting mesh &#39;</span><span class="si">%s</span><span class="s2">&#39;...&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    
    <span class="c1"># Get list of all related meshes</span>
    <span class="n">mesh_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connected_meshes</span><span class="p">(</span><span class="n">get_full_tree</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">mesh_obj</span> <span class="ow">in</span> <span class="n">mesh_list</span><span class="p">:</span>
            
        <span class="n">ax</span> <span class="o">=</span> <span class="n">mesh_obj</span><span class="o">.</span><span class="n">_plot_init</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">mesh_obj</span><span class="o">.</span><span class="n">_plot_update</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="n">set_axis_limits</span><span class="p">:</span>
        
        <span class="n">axis_limits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_extents</span><span class="p">()</span>
                        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">set_square_axes</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">axis_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">axis_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="n">axis_limits</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            
        <span class="k">else</span><span class="p">:</span>
            
            <span class="c1"># Draw hidden line to ensure proper scaling of axes</span>
            <span class="n">set_equal_aspect_3d</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">axis_limits</span><span class="p">)</span>
            
    
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">ax</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="mesh.Mesh.element_objs" class="name">var <span class="ident">element_objs</span></p>
            

            
  
    <div class="desc"><p>Dict of element objects directly related to this mesh. Keys are names 
of each node</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.Mesh.id" class="name">var <span class="ident">id</span></p>
            

            
  
    <div class="desc"><p>Sequential integer ID, assigned to uniquely identify object</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.Mesh.mesh_objs" class="name">var <span class="ident">mesh_objs</span></p>
            

            
  
    <div class="desc"><p>Dict of mesh objects related to this mesh. Will always include <code>self</code> 
but also any sub-meshes defined. Keys are names of each mesh</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.Mesh.name" class="name">var <span class="ident">name</span></p>
            

            
  
    <div class="desc"><p>User-assigned name, usually of <em>string</em> type</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.Mesh.node_objs" class="name">var <span class="ident">node_objs</span></p>
            

            
  
    <div class="desc"><p>Dict of node objects directly related to this mesh. Keys are names of 
each node</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="mesh.MeshChain" class="name">class <span class="ident">MeshChain</span></p>
      
  
    <div class="desc"><p>Class to implement a chain mesh, i.e. series of elements forming a chain</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.MeshChain', this);">Show source &equiv;</a></p>
  <div id="source-mesh.MeshChain" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">MeshChain</span><span class="p">(</span><span class="n">Mesh</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to implement a chain mesh, i.e. series of elements forming a chain</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">node_list</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Required:</span>
<span class="sd">            </span>
<span class="sd">        * `node_list`, list of Node objects defining chain</span>
<span class="sd">        </span>
<span class="sd">        Other keyword arguments are passed to `Mesh.__init__()` method</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Define elements linking nodes</span>
        
        <span class="n">nNodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">node_list</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">nNodes</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot define mesh chain from only 1 node!&quot;</span><span class="p">)</span>
           
        <span class="n">element_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nNodes</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            
            <span class="n">node1</span> <span class="o">=</span> <span class="n">node_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">node2</span> <span class="o">=</span> <span class="n">node_list</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            
            <span class="n">element_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LineElement</span><span class="p">(</span><span class="n">parent_mesh</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="c1"># append later</span>
                                            <span class="n">connected_nodes</span><span class="o">=</span><span class="p">[</span><span class="n">node1</span><span class="p">,</span><span class="n">node2</span><span class="p">]))</span>
        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">node_objs</span><span class="o">=</span><span class="n">node_list</span><span class="p">,</span>
                         <span class="n">element_objs</span><span class="o">=</span><span class="n">element_list</span><span class="p">,</span>
                         <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#mesh.MeshChain">MeshChain</a></li>
          <li><a href="#mesh.Mesh">Mesh</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="mesh.MeshChain.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, node_list, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#mesh.Mesh">Mesh</a></code>.<code><a href="#mesh.Mesh.__init__">__init__</a></code>
    </p>

    
  
    <div class="desc"><p>Required:</p>
<ul>
<li><code>node_list</code>, list of Node objects defining chain</li>
</ul>
<p>Other keyword arguments are passed to <code>Mesh.__init__()</code> method</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.MeshChain.__init__', this);">Show source &equiv;</a></p>
  <div id="source-mesh.MeshChain.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">node_list</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Required:</span>
<span class="sd">        </span>
<span class="sd">    * `node_list`, list of Node objects defining chain</span>
<span class="sd">    </span>
<span class="sd">    Other keyword arguments are passed to `Mesh.__init__()` method</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Define elements linking nodes</span>
    
    <span class="n">nNodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">node_list</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="n">nNodes</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot define mesh chain from only 1 node!&quot;</span><span class="p">)</span>
       
    <span class="n">element_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nNodes</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        
        <span class="n">node1</span> <span class="o">=</span> <span class="n">node_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">node2</span> <span class="o">=</span> <span class="n">node_list</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="n">element_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LineElement</span><span class="p">(</span><span class="n">parent_mesh</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="c1"># append later</span>
                                        <span class="n">connected_nodes</span><span class="o">=</span><span class="p">[</span><span class="n">node1</span><span class="p">,</span><span class="n">node2</span><span class="p">]))</span>
    
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">node_objs</span><span class="o">=</span><span class="n">node_list</span><span class="p">,</span>
                     <span class="n">element_objs</span><span class="o">=</span><span class="n">element_list</span><span class="p">,</span>
                     <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.MeshChain.append_objs">
    <p>def <span class="ident">append_objs</span>(</p><p>self, obj_list)</p>
    </div>
    

    
  
    <div class="desc"><p>Append objects to mesh</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.MeshChain.append_objs', this);">Show source &equiv;</a></p>
  <div id="source-mesh.MeshChain.append_objs" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">append_objs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj_list</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Append objects to mesh</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># create list in case of single object input</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj_list</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">):</span>
        <span class="n">obj_list</span><span class="o">=</span><span class="p">[</span><span class="n">obj_list</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">obj_list</span><span class="p">:</span>
      
        <span class="c1"># Create link to this mesh object, to which object now belongs</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">parent_mesh</span><span class="o">=</span><span class="bp">self</span> 

        <span class="c1"># Add new objects to dictionaries according to class</span>
        <span class="n">class_name_list</span> <span class="o">=</span> <span class="n">getmro</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">Mesh</span> <span class="ow">in</span> <span class="n">class_name_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mesh_objs</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
            
        <span class="k">elif</span> <span class="n">Element</span> <span class="ow">in</span> <span class="n">class_name_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">element_objs</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
            
        <span class="k">elif</span> <span class="n">Node</span> <span class="ow">in</span> <span class="n">class_name_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">node_objs</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unexpected object!</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">+</span> 
                             <span class="s2">&quot;Class list{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">class_name_list</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.MeshChain.calc_extents">
    <p>def <span class="ident">calc_extents</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Determine xyz extents of mesh</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.MeshChain.calc_extents', this);">Show source &equiv;</a></p>
  <div id="source-mesh.MeshChain.calc_extents" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">calc_extents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determine xyz extents of mesh</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Get list mesh objects to include in extent calculation</span>
    <span class="n">mesh_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connected_meshes</span><span class="p">(</span><span class="n">get_full_tree</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="c1"># Loop over all nodes in all meshes</span>
    <span class="n">node_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">mesh_obj</span> <span class="ow">in</span> <span class="n">mesh_list</span><span class="p">:</span>
        
        <span class="n">node_list</span> <span class="o">=</span> <span class="n">mesh_obj</span><span class="o">.</span><span class="n">node_objs</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        
        <span class="k">for</span> <span class="n">node_obj</span> <span class="ow">in</span> <span class="n">node_list</span><span class="p">:</span>
           
            <span class="n">node_count</span> <span class="o">+=</span> <span class="mi">1</span>                
            <span class="n">xyz_vals</span><span class="o">=</span><span class="n">node_obj</span><span class="o">.</span><span class="n">get_xyz</span><span class="p">()</span>
            
            <span class="k">if</span> <span class="n">node_count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">xyz_min</span> <span class="o">=</span> <span class="n">xyz_vals</span>
                <span class="n">xyz_max</span> <span class="o">=</span> <span class="n">xyz_vals</span>
            
            <span class="n">xyz_min</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">xyz_min</span><span class="p">,</span><span class="n">xyz_vals</span><span class="p">)</span>
            <span class="n">xyz_max</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">xyz_max</span><span class="p">,</span><span class="n">xyz_vals</span><span class="p">)</span>
              
    <span class="k">if</span> <span class="n">node_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                
        <span class="c1"># Reshape into nested list</span>
        <span class="n">xyz_lim</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">xyz_min</span><span class="p">,</span><span class="n">xyz_max</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">xyz_lim</span>
                
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Warning: mesh &#39;</span><span class="si">%s</span><span class="s2">&#39; does not have any nodes!</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> 
              <span class="s2">&quot;Could not evaluate mesh extents&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.MeshChain.define_gauss_points">
    <p>def <span class="ident">define_gauss_points</span>(</p><p>self, N_gp=2, verbose=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Loops over all elements in mesh, defining gauss points</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.MeshChain.define_gauss_points', this);">Show source &equiv;</a></p>
  <div id="source-mesh.MeshChain.define_gauss_points" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">define_gauss_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">N_gp</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loops over all elements in mesh, defining gauss points</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">element_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_objs</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">N_gp</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">N_gp</span><span class="p">)</span><span class="o">!=</span><span class="nb">len</span><span class="p">(</span><span class="n">element_list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Length of `N_gp` list does not agree &quot;</span> <span class="o">+</span> 
                             <span class="s2">&quot;with total number of elements&quot;</span><span class="p">)</span>
            
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">N_gp</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`N_gp` to be either `int` or `list`&quot;</span><span class="p">)</span>
            
                    
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">element_obj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">element_list</span><span class="p">):</span>
        
        <span class="c1"># Determine number of gauss points required for this element</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">N_gp</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">N_gp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">N_gp</span>
            
        <span class="c1"># Define gps</span>
        <span class="n">element_obj</span><span class="o">.</span><span class="n">define_gauss_points</span><span class="p">(</span><span class="n">N_gp</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.MeshChain.define_line_elements">
    <p>def <span class="ident">define_line_elements</span>(</p><p>self, df=None, fname=&#39;elements.csv&#39;, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Function to read element connectivity from tabulated input</p>
<hr />
<p>Pandas Dataframe containing the following columns to be provided:</p>
<p>| Member | EndJ  | EndK  |
| ...    | ...   | ...   |</p>
<p>or alternatively <code>fName</code> defines .csv file containing similar input</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.MeshChain.define_line_elements', this);">Show source &equiv;</a></p>
  <div id="source-mesh.MeshChain.define_line_elements" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">define_line_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">df</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">fname</span><span class="o">=</span><span class="s2">&quot;elements.csv&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to read element connectivity from tabulated input</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    Pandas Dataframe containing the following columns to be provided:</span>
<span class="sd">    </span>
<span class="sd">    | Member | EndJ  | EndK  |</span>
<span class="sd">    | ...    | ...   | ...   |</span>
<span class="sd">    </span>
<span class="sd">    or alternatively `fName` defines .csv file containing similar input</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Use pandas to read in data as dataframe</span>
    <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                             <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
    <span class="c1"># Loop throuh rows in dataframe</span>
    <span class="n">element_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        
        <span class="c1"># Get node objects for each end</span>
        <span class="n">node1_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_objs</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;EndJ&quot;</span><span class="p">]]</span>
        <span class="n">node2_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_objs</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;EndK&quot;</span><span class="p">]]</span>
        
        <span class="c1"># Define new line element</span>
        <span class="n">new_obj</span> <span class="o">=</span> <span class="n">LineElement</span><span class="p">(</span><span class="n">parent_mesh</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                          <span class="n">name</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;Member&quot;</span><span class="p">],</span>
                          <span class="n">connected_nodes</span><span class="o">=</span><span class="p">[</span><span class="n">node1_obj</span><span class="p">,</span><span class="n">node2_obj</span><span class="p">])</span>
        
        <span class="n">element_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_obj</span><span class="p">)</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">append_objs</span><span class="p">(</span><span class="n">element_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">element_list</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.MeshChain.define_nodes">
    <p>def <span class="ident">define_nodes</span>(</p><p>self, df=None, fname=&#39;nodes.csv&#39;, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Function to define nodes from tabulated input</p>
<hr />
<p>Pandas Dataframe containing the following columns to be provided:</p>
<p>| Node | X   | Y   | Z   | 
| ...  | ... | ... | ... | </p>
<p>or alternatively <code>fName</code> defines .csv file containing similar input</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.MeshChain.define_nodes', this);">Show source &equiv;</a></p>
  <div id="source-mesh.MeshChain.define_nodes" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">define_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">df</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">fname</span><span class="o">=</span><span class="s1">&#39;nodes.csv&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to define nodes from tabulated input</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    Pandas Dataframe containing the following columns to be provided:</span>
<span class="sd">    </span>
<span class="sd">    | Node | X   | Y   | Z   | </span>
<span class="sd">    | ...  | ... | ... | ... | </span>
<span class="sd">    </span>
<span class="sd">    or alternatively `fName` defines .csv file containing similar input</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Use pandas to read in data as dataframe</span>
    <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span>
                             <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                             <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">],</span>
                             <span class="n">index_col</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                             <span class="n">converters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Node&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">},</span>
                             <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
    <span class="c1"># Loop through rows in dataframe</span>
    <span class="n">node_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        
        <span class="c1"># Define new node object</span>
        <span class="n">new_node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">parent_mesh</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Node&quot;</span><span class="p">],</span>
                        <span class="n">xyz</span><span class="o">=</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]])</span>
        
        <span class="n">node_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_node</span><span class="p">)</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">append_objs</span><span class="p">(</span><span class="n">node_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">node_list</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.MeshChain.get_connected_meshes">
    <p>def <span class="ident">get_connected_meshes</span>(</p><p>self, get_full_tree=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns list including all mesh objects associated with mesh object </p>
<p>Optional:</p>
<ul>
<li><code>get_full_tree</code>, <em>boolean</em>, if True then full mesh tree will be 
  returned. If False (default) then only meshes which are sub-meshes to 
  <em>self</em> will be returned</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.MeshChain.get_connected_meshes', this);">Show source &equiv;</a></p>
  <div id="source-mesh.MeshChain.get_connected_meshes" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_connected_meshes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">get_full_tree</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns list including all mesh objects associated with mesh object </span>
<span class="sd">    </span>
<span class="sd">    Optional:</span>
<span class="sd">        </span>
<span class="sd">    * `get_full_tree`, _boolean_, if True then full mesh tree will be </span>
<span class="sd">      returned. If False (default) then only meshes which are sub-meshes to </span>
<span class="sd">      _self_ will be returned</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">mesh_obj</span><span class="p">,</span> <span class="n">visited</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">add_parent</span><span class="o">=</span><span class="n">get_full_tree</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to implement depth-first search through mesh tree</span>
<span class="sd">        &quot;&quot;&quot;</span>
    
        <span class="k">if</span> <span class="n">visited</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        
        <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">mesh_obj</span><span class="p">)</span>
            
        <span class="c1"># Get adjacency list for current mesh object</span>
        <span class="n">connected_meshes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mesh_obj</span><span class="o">.</span><span class="n">mesh_objs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        
        <span class="k">if</span> <span class="n">add_parent</span><span class="p">:</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="s1">&#39;parent_mesh&#39;</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">mesh_obj</span><span class="p">,</span><span class="n">attr</span><span class="p">):</span>
                <span class="n">connected_meshes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">mesh_obj</span><span class="p">,</span><span class="n">attr</span><span class="p">))</span>
            
        <span class="c1"># Recursively run function if current mesh object not in visited set</span>
        <span class="k">for</span> <span class="nb">next</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">connected_meshes</span><span class="p">)</span> <span class="o">-</span> <span class="n">visited</span><span class="p">:</span>
            <span class="n">dfs</span><span class="p">(</span><span class="nb">next</span><span class="p">,</span> <span class="n">visited</span><span class="o">=</span><span class="n">visited</span><span class="p">,</span> <span class="n">add_parent</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">visited</span>

    <span class="n">mesh_obj_list</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mesh_obj_list</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.MeshChain.get_gauss_points">
    <p>def <span class="ident">get_gauss_points</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns all nested list to describe all gauss points associated with 
mesh via its elements</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.MeshChain.get_gauss_points', this);">Show source &equiv;</a></p>
  <div id="source-mesh.MeshChain.get_gauss_points" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_gauss_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns all nested list to describe all gauss points associated with </span>
<span class="sd">    mesh via its elements</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gp_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_objs</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">gp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">gauss_points</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gp_list</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.MeshChain.has_elements">
    <p>def <span class="ident">has_elements</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.MeshChain.has_elements', this);">Show source &equiv;</a></p>
  <div id="source-mesh.MeshChain.has_elements" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">has_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element_objs</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">1</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.MeshChain.has_nodes">
    <p>def <span class="ident">has_nodes</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.MeshChain.has_nodes', this);">Show source &equiv;</a></p>
  <div id="source-mesh.MeshChain.has_nodes" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">has_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node_objs</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">1</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.MeshChain.plot">
    <p>def <span class="ident">plot</span>(</p><p>self, ax=None, set_axis_limits=True, set_square_axes=True, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Plots mesh and all sub-meshes</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.MeshChain.plot', this);">Show source &equiv;</a></p>
  <div id="source-mesh.MeshChain.plot" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
         <span class="n">set_axis_limits</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
         <span class="n">set_square_axes</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
         <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots mesh and all sub-meshes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Plotting mesh &#39;</span><span class="si">%s</span><span class="s2">&#39;...&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    
    <span class="c1"># Get list of all related meshes</span>
    <span class="n">mesh_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connected_meshes</span><span class="p">(</span><span class="n">get_full_tree</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">mesh_obj</span> <span class="ow">in</span> <span class="n">mesh_list</span><span class="p">:</span>
            
        <span class="n">ax</span> <span class="o">=</span> <span class="n">mesh_obj</span><span class="o">.</span><span class="n">_plot_init</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">mesh_obj</span><span class="o">.</span><span class="n">_plot_update</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="n">set_axis_limits</span><span class="p">:</span>
        
        <span class="n">axis_limits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_extents</span><span class="p">()</span>
                        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">set_square_axes</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">axis_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">axis_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="n">axis_limits</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            
        <span class="k">else</span><span class="p">:</span>
            
            <span class="c1"># Draw hidden line to ensure proper scaling of axes</span>
            <span class="n">set_equal_aspect_3d</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">axis_limits</span><span class="p">)</span>
            
    
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">ax</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="mesh.MeshResults" class="name">class <span class="ident">MeshResults</span></p>
      
  
    <div class="desc"><p>Base class used to store results with relation to mesh objects
(e.g. nodes for displacements, member-node locations for forces)</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.MeshResults', this);">Show source &equiv;</a></p>
  <div id="source-mesh.MeshResults" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">MeshResults</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class used to store results with relation to mesh objects</span>
<span class="sd">    (e.g. nodes for displacements, member-node locations for forces)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">nComponents</span> <span class="o">=</span> <span class="bp">None</span>   <span class="c1"># integer defining expected number of components</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_list</span><span class="p">,</span> <span class="n">results_arr</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">obj_list</span> <span class="o">=</span> <span class="n">obj_list</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of mesh objects to which results relate. E.g. displacements </span>
<span class="sd">        relate to nodes (i.e. list length = 1), whereas forces relate to </span>
<span class="sd">        elements and nodes (i.e. list of length = 2)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">results_arr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">results_arr</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;New instance of &#39;</span><span class="si">%s</span><span class="s2">&#39; created&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="n">print_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">print_str</span> <span class="o">+=</span> <span class="s2">&quot;Class:</span><span class="se">\t</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">print_str</span> <span class="o">+=</span> <span class="s2">&quot;Name:</span><span class="se">\t</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">print_str</span> <span class="o">+=</span> <span class="s2">&quot;Shape of values array:</span><span class="se">\n</span><span class="s2">{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">print_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">print_str</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        2d-array of vector results for multiple loadcases. </span>
<span class="sd">        Shape is [nLoadcase,nComponents]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span>
    
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns list comprising names of mesh objects associated</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_list</span><span class="p">]</span>
       
        
    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">new_results</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appends results for new loadcase</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Appending new results to location {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">new_results</span><span class="p">))</span>
        
    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clears results held within object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nComponents</span><span class="p">))</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#mesh.MeshResults">MeshResults</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="mesh.MeshResults.nComponents" class="name">var <span class="ident">nComponents</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="mesh.MeshResults.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, obj_list, results_arr=None, verbose=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.MeshResults.__init__', this);">Show source &equiv;</a></p>
  <div id="source-mesh.MeshResults.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_list</span><span class="p">,</span> <span class="n">results_arr</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">obj_list</span> <span class="o">=</span> <span class="n">obj_list</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List of mesh objects to which results relate. E.g. displacements </span>
<span class="sd">    relate to nodes (i.e. list length = 1), whereas forces relate to </span>
<span class="sd">    elements and nodes (i.e. list of length = 2)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="n">results_arr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">results_arr</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;New instance of &#39;</span><span class="si">%s</span><span class="s2">&#39; created&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.MeshResults.add">
    <p>def <span class="ident">add</span>(</p><p>self, new_results, verbose=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Appends results for new loadcase</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.MeshResults.add', this);">Show source &equiv;</a></p>
  <div id="source-mesh.MeshResults.add" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">new_results</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Appends results for new loadcase</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Appending new results to location {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">new_results</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.MeshResults.clear">
    <p>def <span class="ident">clear</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Clears results held within object</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.MeshResults.clear', this);">Show source &equiv;</a></p>
  <div id="source-mesh.MeshResults.clear" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Clears results held within object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nComponents</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="mesh.MeshResults.name" class="name">var <span class="ident">name</span></p>
            

            
  
    <div class="desc"><p>Returns list comprising names of mesh objects associated</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.MeshResults.obj_list" class="name">var <span class="ident">obj_list</span></p>
            

            
  
    <div class="desc"><p>List of mesh objects to which results relate. E.g. displacements 
relate to nodes (i.e. list length = 1), whereas forces relate to 
elements and nodes (i.e. list of length = 2)</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.MeshResults.values" class="name">var <span class="ident">values</span></p>
            

            
  
    <div class="desc"><p>2d-array of vector results for multiple loadcases. 
Shape is [nLoadcase,nComponents]</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="mesh.Node" class="name">class <span class="ident">Node</span></p>
      
  
    <div class="desc"><p>Class used to define nodes i.e. points in space which define the 
vertices (end points in 1D) of elements and which are thus related via a 
mesh</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Node', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Node" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Node</span><span class="p">(</span><span class="n">Point</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class used to define nodes i.e. points in space which define the </span>
<span class="sd">    vertices (end points in 1D) of elements and which are thus related via a </span>
<span class="sd">    mesh</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Class properties</span>
    <span class="n">_ids</span> <span class="o">=</span> <span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># used to assign IDs to objects</span>
    
    <span class="c1"># Class methods</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_mesh</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">connected_elements</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates new node, in the context of `parent_mesh`</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Required:</span>
<span class="sd">            </span>
<span class="sd">        * `parent_mesh`, instance of _mesh_ class. Defines mesh context in </span>
<span class="sd">          which node is defined</span>
<span class="sd">          </span>
<span class="sd">        * `xyz`, list or array of length 3, defines position of node</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Optional:</span>
<span class="sd">            </span>
<span class="sd">        * `name`, _string_ name to identify nodes</span>
<span class="sd">        </span>
<span class="sd">        * `connected_elements`, list of _element_ objects connected to this </span>
<span class="sd">          node. Will normally be empty, with nodes connected to elements when </span>
<span class="sd">          elements are defined</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
    
        <span class="bp">self</span><span class="o">.</span><span class="n">parent_mesh</span> <span class="o">=</span> <span class="n">parent_mesh</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parent mesh to which element directly relates</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">connected_elements</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dict of element objects connected to this node. Keys are element names</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">lcase_disp</span> <span class="o">=</span> <span class="n">DispResults</span><span class="p">(</span><span class="n">node_obj</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">results_arr</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance of `DispResults` class used as container for </span>
<span class="sd">        displacements as obtained for ordinary loadcases / combinations</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">modal_disp</span> <span class="o">=</span> <span class="n">DispResults</span><span class="p">(</span><span class="n">node_obj</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">results_arr</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance of `DispResults` class used as container for </span>
<span class="sd">        mode displacements as obtained from eigenvalue analysis</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Connect to parent mesh</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent_mesh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent_mesh</span><span class="o">.</span><span class="n">append_objs</span><span class="p">([</span><span class="bp">self</span><span class="p">])</span>
        
        <span class="c1"># Connect any elements passed in via list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect_elements</span><span class="p">(</span><span class="n">connected_elements</span><span class="p">)</span>
        
        
    <span class="k">def</span> <span class="nf">connect_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">element_objs</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to associate element objects with node object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># create list in case of single object input</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">element_objs</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">):</span>
            <span class="n">element_objs</span><span class="o">=</span><span class="p">[</span><span class="n">element_objs</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">element_objs</span><span class="p">:</span>
            
            <span class="n">check_class</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">Element</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connected_elements</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="n">obj</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#mesh.Node">Node</a></li>
          <li><a href="#mesh.Point">Point</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="mesh.Node.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, parent_mesh, xyz, name=None, connected_elements=[])</p>
    </div>
    

    
  
    <div class="desc"><p>Creates new node, in the context of <code>parent_mesh</code></p>
<hr />
<p>Required:</p>
<ul>
<li>
<p><code>parent_mesh</code>, instance of <em>mesh</em> class. Defines mesh context in 
  which node is defined</p>
</li>
<li>
<p><code>xyz</code>, list or array of length 3, defines position of node</p>
</li>
</ul>
<hr />
<p>Optional:</p>
<ul>
<li>
<p><code>name</code>, <em>string</em> name to identify nodes</p>
</li>
<li>
<p><code>connected_elements</code>, list of <em>element</em> objects connected to this 
  node. Will normally be empty, with nodes connected to elements when 
  elements are defined</p>
</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Node.__init__', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Node.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_mesh</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">connected_elements</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates new node, in the context of `parent_mesh`</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    Required:</span>
<span class="sd">        </span>
<span class="sd">    * `parent_mesh`, instance of _mesh_ class. Defines mesh context in </span>
<span class="sd">      which node is defined</span>
<span class="sd">      </span>
<span class="sd">    * `xyz`, list or array of length 3, defines position of node</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    Optional:</span>
<span class="sd">        </span>
<span class="sd">    * `name`, _string_ name to identify nodes</span>
<span class="sd">    </span>
<span class="sd">    * `connected_elements`, list of _element_ objects connected to this </span>
<span class="sd">      node. Will normally be empty, with nodes connected to elements when </span>
<span class="sd">      elements are defined</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">parent_mesh</span> <span class="o">=</span> <span class="n">parent_mesh</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parent mesh to which element directly relates</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">connected_elements</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dict of element objects connected to this node. Keys are element names</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">lcase_disp</span> <span class="o">=</span> <span class="n">DispResults</span><span class="p">(</span><span class="n">node_obj</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">results_arr</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instance of `DispResults` class used as container for </span>
<span class="sd">    displacements as obtained for ordinary loadcases / combinations</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">modal_disp</span> <span class="o">=</span> <span class="n">DispResults</span><span class="p">(</span><span class="n">node_obj</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">results_arr</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instance of `DispResults` class used as container for </span>
<span class="sd">    mode displacements as obtained from eigenvalue analysis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Connect to parent mesh</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent_mesh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent_mesh</span><span class="o">.</span><span class="n">append_objs</span><span class="p">([</span><span class="bp">self</span><span class="p">])</span>
    
    <span class="c1"># Connect any elements passed in via list</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">connect_elements</span><span class="p">(</span><span class="n">connected_elements</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.Node.connect_elements">
    <p>def <span class="ident">connect_elements</span>(</p><p>self, element_objs)</p>
    </div>
    

    
  
    <div class="desc"><p>Method to associate element objects with node object</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Node.connect_elements', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Node.connect_elements" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">connect_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">element_objs</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method to associate element objects with node object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># create list in case of single object input</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">element_objs</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">):</span>
        <span class="n">element_objs</span><span class="o">=</span><span class="p">[</span><span class="n">element_objs</span><span class="p">]</span>
    
    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">element_objs</span><span class="p">:</span>
        
        <span class="n">check_class</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">Element</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connected_elements</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="n">obj</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.Node.get_x">
    <p>def <span class="ident">get_x</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Node.get_x', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Node.get_x" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.Node.get_xyz">
    <p>def <span class="ident">get_xyz</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Node.get_xyz', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Node.get_xyz" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.Node.get_y">
    <p>def <span class="ident">get_y</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Node.get_y', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Node.get_y" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.Node.get_z">
    <p>def <span class="ident">get_z</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Node.get_z', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Node.get_z" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_z</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="mesh.Node.connected_elements" class="name">var <span class="ident">connected_elements</span></p>
            

            
  
    <div class="desc"><p>Dict of element objects connected to this node. Keys are element names</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.Node.lcase_disp" class="name">var <span class="ident">lcase_disp</span></p>
            

            
  
    <div class="desc"><p>Instance of <code>DispResults</code> class used as container for 
displacements as obtained for ordinary loadcases / combinations</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.Node.modal_disp" class="name">var <span class="ident">modal_disp</span></p>
            

            
  
    <div class="desc"><p>Instance of <code>DispResults</code> class used as container for 
mode displacements as obtained from eigenvalue analysis</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.Node.parent_mesh" class="name">var <span class="ident">parent_mesh</span></p>
            

            
  
    <div class="desc"><p>Parent mesh to which element directly relates</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.Node.x" class="name">var <span class="ident">x</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.Node.xyz" class="name">var <span class="ident">xyz</span></p>
            

            
  
    <div class="desc"><p>Array of shape (3,) defining position of node</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.Node.y" class="name">var <span class="ident">y</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.Node.z" class="name">var <span class="ident">z</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="mesh.Point" class="name">class <span class="ident">Point</span></p>
      
  
    <div class="desc"><p>Base class used to define discrete points in space</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Point', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Point" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Point</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class used to define discrete points in space    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Class properties</span>
    <span class="n">_ids</span> <span class="o">=</span> <span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># used to assign IDs to objects</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xyz</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates new point instance</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Required:</span>
<span class="sd">            </span>
<span class="sd">        * `xyz`, list or array of length 3, defines position of node</span>
<span class="sd">        </span>
<span class="sd">        ***</span>
<span class="sd">        Optional:</span>
<span class="sd">            </span>
<span class="sd">        * `name`, _string_ name to identify points</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ids</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sequential integer ID, assigned to uniquely identify object</span>
<span class="sd">        &quot;&quot;&quot;</span>  
        
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        User-assigned name, usually of _string_ type</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span> <span class="o">=</span> <span class="n">xyz</span>
        
    
    <span class="c1"># ------------ATTRIBUTES ---------------</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
    
    <span class="nd">@x.setter</span>
    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        
    <span class="c1"># -----</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">get_y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
    
    <span class="nd">@y.setter</span>
    <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        
    <span class="c1"># -----</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">z</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">get_z</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span>
    
    <span class="nd">@z.setter</span>
    <span class="k">def</span> <span class="nf">z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        
    <span class="c1"># -----</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Array of shape (3,) defining position of node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xyz</span>
    
    <span class="k">def</span> <span class="nf">get_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span>
    
    <span class="nd">@xyz.setter</span>
    <span class="k">def</span> <span class="nf">xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`xyz` unexpected shape!</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> 
                             <span class="s2">&quot;Shape: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xyz</span> <span class="o">=</span> <span class="n">value</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#mesh.Point">Point</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="mesh.Point.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, xyz, name=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates new point instance</p>
<hr />
<p>Required:</p>
<ul>
<li><code>xyz</code>, list or array of length 3, defines position of node</li>
</ul>
<hr />
<p>Optional:</p>
<ul>
<li><code>name</code>, <em>string</em> name to identify points</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Point.__init__', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Point.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xyz</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates new point instance</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    Required:</span>
<span class="sd">        </span>
<span class="sd">    * `xyz`, list or array of length 3, defines position of node</span>
<span class="sd">    </span>
<span class="sd">    ***</span>
<span class="sd">    Optional:</span>
<span class="sd">        </span>
<span class="sd">    * `name`, _string_ name to identify points</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ids</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sequential integer ID, assigned to uniquely identify object</span>
<span class="sd">    &quot;&quot;&quot;</span>  
    
    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    User-assigned name, usually of _string_ type</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span> <span class="o">=</span> <span class="n">xyz</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.Point.get_x">
    <p>def <span class="ident">get_x</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Point.get_x', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Point.get_x" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.Point.get_xyz">
    <p>def <span class="ident">get_xyz</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Point.get_xyz', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Point.get_xyz" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.Point.get_y">
    <p>def <span class="ident">get_y</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Point.get_y', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Point.get_y" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.Point.get_z">
    <p>def <span class="ident">get_z</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.Point.get_z', this);">Show source &equiv;</a></p>
  <div id="source-mesh.Point.get_z" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_z</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="mesh.Point.id" class="name">var <span class="ident">id</span></p>
            

            
  
    <div class="desc"><p>Sequential integer ID, assigned to uniquely identify object</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.Point.name" class="name">var <span class="ident">name</span></p>
            

            
  
    <div class="desc"><p>User-assigned name, usually of <em>string</em> type</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.Point.x" class="name">var <span class="ident">x</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.Point.xyz" class="name">var <span class="ident">xyz</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.Point.y" class="name">var <span class="ident">y</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.Point.z" class="name">var <span class="ident">z</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="mesh.ReactionResults" class="name">class <span class="ident">ReactionResults</span></p>
      
  
    <div class="desc"><p>Class used to store reaction results, with relation to a given node</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.ReactionResults', this);">Show source &equiv;</a></p>
  <div id="source-mesh.ReactionResults" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ReactionResults</span><span class="p">(</span><span class="n">MeshResults</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class used to store reaction results, with relation to a given node</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">nComponents</span> <span class="o">=</span> <span class="mi">6</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_obj</span><span class="p">,</span> <span class="n">results_arr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span><span class="n">node_obj</span><span class="p">],</span> <span class="n">results_arr</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#mesh.ReactionResults">ReactionResults</a></li>
          <li><a href="#mesh.MeshResults">MeshResults</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="mesh.ReactionResults.nComponents" class="name">var <span class="ident">nComponents</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="mesh.ReactionResults.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, node_obj, results_arr=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.ReactionResults.__init__', this);">Show source &equiv;</a></p>
  <div id="source-mesh.ReactionResults.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_obj</span><span class="p">,</span> <span class="n">results_arr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span><span class="n">node_obj</span><span class="p">],</span> <span class="n">results_arr</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.ReactionResults.add">
    <p>def <span class="ident">add</span>(</p><p>self, new_results, verbose=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Appends results for new loadcase</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.ReactionResults.add', this);">Show source &equiv;</a></p>
  <div id="source-mesh.ReactionResults.add" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">new_results</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Appends results for new loadcase</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Appending new results to location {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">new_results</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="mesh.ReactionResults.clear">
    <p>def <span class="ident">clear</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Clears results held within object</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-mesh.ReactionResults.clear', this);">Show source &equiv;</a></p>
  <div id="source-mesh.ReactionResults.clear" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Clears results held within object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">npy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nComponents</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="mesh.ReactionResults.name" class="name">var <span class="ident">name</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#mesh.MeshResults">MeshResults</a></code>.<code><a href="#mesh.MeshResults.name">name</a></code>
    </p>

            
  
    <div class="desc inherited"><p>Returns list comprising names of mesh objects associated</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="mesh.ReactionResults.values" class="name">var <span class="ident">values</span></p>
            

            
  
    <div class="desc"><p>2d-array of vector results for multiple loadcases. 
Shape is [nLoadcase,nComponents]</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>